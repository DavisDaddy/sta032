<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Michael Hannon" />
  <meta name="date" content="2013-08-26" />
  <title>A Brief Introduction to R</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
</head>
<body>
<div id="header">
<h1 class="title">A Brief Introduction to R</h1>
<h2 class="author">Michael Hannon</h2>
<h3 class="date">2013-08-26</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#acknowledgment"><span class="toc-section-number">1</span> Acknowledgment</a></li>
<li><a href="#the-r-website"><span class="toc-section-number">2</span> The R website:</a></li>
<li><a href="#r-and-related-tools-for-sta-032"><span class="toc-section-number">3</span> R and related tools for STA 032</a><ul>
<li><a href="#step-1-install-r"><span class="toc-section-number">3.1</span> Step 1: Install R</a><ul>
<li><a href="#getting-started"><span class="toc-section-number">3.1.1</span> Getting started</a></li>
<li><a href="#windows-versus-mac-linux"><span class="toc-section-number">3.1.2</span> Windows versus Mac, linux</a></li>
<li><a href="#software-on-linux"><span class="toc-section-number">3.1.3</span> Software on linux</a></li>
<li><a href="#software-on-mac"><span class="toc-section-number">3.1.4</span> Software on Mac</a></li>
</ul></li>
<li><a href="#step-2-install-rstudio"><span class="toc-section-number">3.2</span> Step 2: Install RStudio</a></li>
<li><a href="#step-3-install-the-knitr-package"><span class="toc-section-number">3.3</span> Step 3: Install the knitr package</a></li>
<li><a href="#step-4-start-using-r-markdown"><span class="toc-section-number">3.4</span> Step 4: Start using R Markdown</a><ul>
<li><a href="#the-knitting-process"><span class="toc-section-number">3.4.1</span> The “knitting” process</a></li>
<li><a href="#adding-your-own-r-code"><span class="toc-section-number">3.4.2</span> Adding your own R code</a></li>
<li><a href="#some-words-about-code-chunks"><span class="toc-section-number">3.4.3</span> Some words about code chunks</a></li>
<li><a href="#r-markdown-reference"><span class="toc-section-number">3.4.4</span> R Markdown reference</a></li>
<li><a href="#summary"><span class="toc-section-number">3.4.5</span> Summary</a></li>
</ul></li>
</ul></li>
<li><a href="#the-simplest-use-of-r"><span class="toc-section-number">4</span> The simplest use of R</a></li>
<li><a href="#some-background-information-about-r"><span class="toc-section-number">5</span> Some Background Information about R</a><ul>
<li><a href="#r-is-an-interpreted-language"><span class="toc-section-number">5.1</span> R is an <strong>Interpreted Language</strong></a></li>
<li><a href="#r-is-high-level"><span class="toc-section-number">5.2</span> R is <strong>High Level</strong></a></li>
<li><a href="#autoprinting"><span class="toc-section-number">5.3</span> <strong>Autoprinting</strong></a></li>
<li><a href="#syntax"><span class="toc-section-number">5.4</span> <strong>Syntax</strong></a></li>
<li><a href="#more-syntax"><span class="toc-section-number">5.5</span> <strong>More Syntax</strong></a></li>
</ul></li>
<li><a href="#basic-data-types"><span class="toc-section-number">6</span> Basic Data Types</a><ul>
<li><a href="#double-precision"><span class="toc-section-number">6.1</span> Double Precision</a></li>
<li><a href="#integers"><span class="toc-section-number">6.2</span> Integers</a></li>
<li><a href="#strings"><span class="toc-section-number">6.3</span> Strings</a></li>
<li><a href="#logical"><span class="toc-section-number">6.4</span> Logical</a></li>
<li><a href="#missing-and-exceptional-values-na-nan-inf--inf"><span class="toc-section-number">6.5</span> Missing and exceptional values: NA, NaN, Inf, -Inf</a><ul>
<li><a href="#missing-values"><span class="toc-section-number">6.5.1</span> Missing values</a></li>
<li><a href="#infinite-numbers"><span class="toc-section-number">6.5.2</span> Infinite numbers</a></li>
<li><a href="#numbers-that-just-dont-make-no-sense"><span class="toc-section-number">6.5.3</span> Numbers that just don’t make no sense</a></li>
</ul></li>
</ul></li>
<li><a href="#r-is-a-functional-language"><span class="toc-section-number">7</span> R is a Functional Language</a><ul>
<li><a href="#r-language-details-for-geeks--"><span class="toc-section-number">7.1</span> R language details for geeks ;-)</a></li>
</ul></li>
<li><a href="#statementsexpressions"><span class="toc-section-number">8</span> Statements/Expressions</a><ul>
<li><a href="#assignments"><span class="toc-section-number">8.1</span> Assignments</a></li>
<li><a href="#side-effects"><span class="toc-section-number">8.2</span> Side effects</a></li>
<li><a href="#composite-statements"><span class="toc-section-number">8.3</span> Composite Statements</a></li>
<li><a href="#various-forms-of-the-assignment-statement"><span class="toc-section-number">8.4</span> Various forms of the assignment statement</a></li>
<li><a href="#no-type-declarations"><span class="toc-section-number">8.5</span> No type declarations</a></li>
</ul></li>
<li><a href="#getting-help"><span class="toc-section-number">9</span> Getting Help</a><ul>
<li><a href="#rs-built-in-help-function"><span class="toc-section-number">9.1</span> R’s built-in <code>help</code> function</a></li>
<li><a href="#apropos"><span class="toc-section-number">9.2</span> Apropos</a></li>
<li><a href="#vignettes"><span class="toc-section-number">9.3</span> Vignettes</a></li>
</ul></li>
<li><a href="#functions-arguments-and-other-details"><span class="toc-section-number">10</span> Functions: arguments and other details</a><ul>
<li><a href="#function-arguments"><span class="toc-section-number">10.1</span> Function arguments</a></li>
<li><a href="#what-about-the-rest-of-the-function"><span class="toc-section-number">10.2</span> What about the rest of the function?</a></li>
<li><a href="#the-str-function-considered-useful"><span class="toc-section-number">10.3</span> The <code>str</code> function considered useful</a></li>
</ul></li>
<li><a href="#management-of-data-and-functions"><span class="toc-section-number">11</span> Management of Data and Functions</a><ul>
<li><a href="#listing-r-objects-both-data-and-functions"><span class="toc-section-number">11.1</span> Listing R objects, both data and functions</a></li>
<li><a href="#removing-data-and-functions"><span class="toc-section-number">11.2</span> Removing data and functions</a></li>
</ul></li>
<li><a href="#packages-and-the-search-list"><span class="toc-section-number">12</span> Packages and the <code>search</code> list</a><ul>
<li><a href="#general-discussion-of-packages"><span class="toc-section-number">12.1</span> General discussion of packages</a></li>
<li><a href="#r-always-has-some-packages-loaded-available"><span class="toc-section-number">12.2</span> R always has <em>some</em> packages loaded (available)</a><ul>
<li><a href="#packages-loaded-by-default"><span class="toc-section-number">12.2.1</span> Packages loaded by default</a></li>
</ul></li>
<li><a href="#packages-loaded-now"><span class="toc-section-number">12.3</span> Packages loaded <em>now</em></a></li>
<li><a href="#whats-in-a-given-package"><span class="toc-section-number">12.4</span> What’s in a given package?</a></li>
<li><a href="#sorting-this-out-a-bit-more"><span class="toc-section-number">12.5</span> Sorting this out a bit more</a></li>
<li><a href="#what-else-does-library-do"><span class="toc-section-number">12.6</span> What else does <code>library</code> do?</a></li>
<li><a href="#namespace"><span class="toc-section-number">12.7</span> Namespace</a><ul>
<li><a href="#general-remarks"><span class="toc-section-number">12.7.1</span> General remarks</a></li>
<li><a href="#searching-package-namespaces"><span class="toc-section-number">12.7.2</span> Searching package namespaces</a></li>
<li><a href="#dealing-with-namespace-collisions"><span class="toc-section-number">12.7.3</span> Dealing with namespace “collisions”</a></li>
</ul></li>
</ul></li>
<li><a href="#getting-into-and-out-of-r"><span class="toc-section-number">13</span> Getting into and out of R</a><ul>
<li><a href="#starting-r"><span class="toc-section-number">13.1</span> Starting R</a></li>
<li><a href="#leaving-r"><span class="toc-section-number">13.2</span> Leaving R</a></li>
<li><a href="#r-hates-to-say-goodbye"><span class="toc-section-number">13.3</span> R hates to say goodbye</a></li>
<li><a href="#to-save-or-not-to-save"><span class="toc-section-number">13.4</span> To save or not to save</a></li>
</ul></li>
<li><a href="#semantics"><span class="toc-section-number">14</span> Semantics</a></li>
<li><a href="#operator-syntax-and-precedence"><span class="toc-section-number">15</span> Operator syntax and precedence</a></li>
<li><a href="#vectors"><span class="toc-section-number">16</span> Vectors</a><ul>
<li><a href="#coercion"><span class="toc-section-number">16.1</span> Coercion</a></li>
<li><a href="#a-peek-ahead-lists"><span class="toc-section-number">16.2</span> A peek ahead: lists</a></li>
</ul></li>
<li><a href="#indexing-and-subsetting-vectors"><span class="toc-section-number">17</span> Indexing and subsetting vectors</a><ul>
<li><a href="#numeric-indices"><span class="toc-section-number">17.1</span> Numeric indices</a></li>
<li><a href="#exclusions-with-negative-numeric-indices"><span class="toc-section-number">17.2</span> Exclusions with negative numeric indices</a></li>
<li><a href="#logical-selection"><span class="toc-section-number">17.3</span> Logical selection</a></li>
<li><a href="#repeated-indexing"><span class="toc-section-number">17.4</span> Repeated indexing</a></li>
<li><a href="#vector-indexing-and-subsetting-used-for-assignment"><span class="toc-section-number">17.5</span> Vector indexing and subsetting used for assignment</a></li>
</ul></li>
<li><a href="#some-functions-that-create-vectors"><span class="toc-section-number">18</span> Some functions that create vectors</a><ul>
<li><a href="#the-c-function-or-manual-entry"><span class="toc-section-number">18.1</span> The <code>c</code> function (or “manual entry”)</a></li>
<li><a href="#sequences-of-equally-spaced-numbers"><span class="toc-section-number">18.2</span> Sequences of equally spaced numbers</a><ul>
<li><a href="#digression-on-data-type"><span class="toc-section-number">18.2.1</span> Digression on data type</a></li>
</ul></li>
<li><a href="#repetitions"><span class="toc-section-number">18.3</span> Repetitions</a></li>
<li><a href="#miscellaneous-ways-of-generating-vectors"><span class="toc-section-number">18.4</span> Miscellaneous ways of generating vectors</a></li>
</ul></li>
<li><a href="#automatic-vector-extension"><span class="toc-section-number">19</span> Automatic vector extension</a></li>
<li><a href="#named-vector-elements"><span class="toc-section-number">20</span> Named vector elements</a></li>
<li><a href="#vectors-with-named-elements-as-associative-arrays"><span class="toc-section-number">21</span> Vectors with named elements as associative arrays</a></li>
<li><a href="#ranking-sorting-reversing-permuting"><span class="toc-section-number">22</span> Ranking, sorting, reversing, permuting</a><ul>
<li><a href="#basic-sorting"><span class="toc-section-number">22.1</span> Basic sorting</a></li>
<li><a href="#permutations-and-other-uses-of-sample"><span class="toc-section-number">22.2</span> Permutations and other uses of <code>sample</code></a></li>
<li><a href="#the-order-function"><span class="toc-section-number">22.3</span> The <code>order</code> function</a></li>
</ul></li>
<li><a href="#simple-statistics"><span class="toc-section-number">23</span> Simple statistics</a></li>
<li><a href="#cumulative-operations"><span class="toc-section-number">24</span> Cumulative operations</a></li>
<li><a href="#simple-numeric-functionstransformations-vectorization"><span class="toc-section-number">25</span> Simple numeric functions/transformations; vectorization</a></li>
<li><a href="#matrices"><span class="toc-section-number">26</span> Matrices</a><ul>
<li><a href="#creating-a-matrix-by-hand"><span class="toc-section-number">26.1</span> Creating a matrix “by hand”</a></li>
<li><a href="#reading-a-matrix-from-a-file"><span class="toc-section-number">26.2</span> Reading a matrix from a file</a></li>
<li><a href="#is-this-object-a-matrix"><span class="toc-section-number">26.3</span> Is this object a matrix?</a></li>
<li><a href="#a-vector-by-any-other-name-would-be-a-matrix"><span class="toc-section-number">26.4</span> A vector by any other name would … be a matrix?</a></li>
<li><a href="#vector-to-matrix-and-back-again"><span class="toc-section-number">26.5</span> Vector to matrix and back again</a></li>
<li><a href="#names-for-the-rows-and-columns"><span class="toc-section-number">26.6</span> Names for the rows and columns</a></li>
<li><a href="#indexing-and-subsetting-a-matrix-by-rows-and-columns"><span class="toc-section-number">26.7</span> Indexing and subsetting a matrix by rows and columns</a></li>
<li><a href="#a-vector-is-a-vector"><span class="toc-section-number">26.8</span> A vector is a vector</a></li>
<li><a href="#indexingsubsetting-can-be-used-for-assignment"><span class="toc-section-number">26.9</span> Indexing/subsetting can be used for assignment</a></li>
<li><a href="#associative-array-feature-for-matrices"><span class="toc-section-number">26.10</span> Associative-array feature for matrices</a></li>
<li><a href="#column-and-row-binding"><span class="toc-section-number">26.11</span> Column and row binding</a></li>
<li><a href="#coercion-of-matrices-to-vectors"><span class="toc-section-number">26.12</span> Coercion of matrices to vectors</a></li>
<li><a href="#generating-patterned-matrices"><span class="toc-section-number">26.13</span> Generating patterned matrices</a></li>
</ul></li>
<li><a href="#arrays-the-generalization-of-matrices-to-more-than-2-indexes"><span class="toc-section-number">27</span> Arrays: the generalization of matrices to more than 2 indexes</a></li>
<li><a href="#lists"><span class="toc-section-number">28</span> Lists</a><ul>
<li><a href="#access-to-list-items"><span class="toc-section-number">28.1</span> Access to list items</a></li>
<li><a href="#access-to-sublists"><span class="toc-section-number">28.2</span> Access to sublists</a></li>
<li><a href="#sublists-are-still-lists"><span class="toc-section-number">28.3</span> Sublists are still lists</a></li>
</ul></li>
<li><a href="#dataframes"><span class="toc-section-number">29</span> Dataframes</a><ul>
<li><a href="#background"><span class="toc-section-number">29.1</span> Background</a></li>
<li><a href="#making-a-data-frame-by-hand"><span class="toc-section-number">29.2</span> Making a data frame “by hand”</a></li>
<li><a href="#operations-on-dataframes"><span class="toc-section-number">29.3</span> Operations on dataframes</a></li>
<li><a href="#it-sometimes-looks-like-a-matrix-but-it-isnt"><span class="toc-section-number">29.4</span> It sometimes looks like a matrix, but it isn’t</a></li>
<li><a href="#making-a-dataframe-from-other-data-sources"><span class="toc-section-number">29.5</span> Making a dataframe from other data sources</a></li>
</ul></li>
<li><a href="#flow-control-conditionals-and-loops"><span class="toc-section-number">30</span> Flow control: conditionals and loops</a><ul>
<li><a href="#making-decisions-the-if-statement"><span class="toc-section-number">30.1</span> Making decisions: the <code>if</code> statement</a></li>
<li><a href="#something-a-little-different-the-ifelse-function"><span class="toc-section-number">30.2</span> Something a little different: the <code>ifelse</code> function</a></li>
<li><a href="#the-for-loop"><span class="toc-section-number">30.3</span> The <code>for</code> loop</a></li>
<li><a href="#the-while-loop"><span class="toc-section-number">30.4</span> The <code>while</code> loop</a></li>
<li><a href="#the-next-and-break-commands"><span class="toc-section-number">30.5</span> The <code>next</code> and <code>break</code> commands</a></li>
<li><a href="#the-repeat-loop"><span class="toc-section-number">30.6</span> The <code>repeat</code> loop</a></li>
</ul></li>
<li><a href="#writing-functions"><span class="toc-section-number">31</span> Writing functions</a><ul>
<li><a href="#syntax-1"><span class="toc-section-number">31.1</span> Syntax</a></li>
<li><a href="#semantics-1"><span class="toc-section-number">31.2</span> Semantics</a></li>
<li><a href="#more-semantics"><span class="toc-section-number">31.3</span> More semantics</a></li>
<li><a href="#return-values"><span class="toc-section-number">31.4</span> Return values</a></li>
<li><a href="#syntax-and-return-values"><span class="toc-section-number">31.5</span> Syntax <em>and</em> return values</a></li>
<li><a href="#a-realistic-example"><span class="toc-section-number">31.6</span> A realistic example</a></li>
<li><a href="#arguments-to-functions"><span class="toc-section-number">31.7</span> Arguments to functions</a></li>
<li><a href="#functions-returning-complex-data-structures"><span class="toc-section-number">31.8</span> Functions returning complex data structures</a></li>
<li><a href="#function-arguments-passed-by-value"><span class="toc-section-number">31.9</span> Function arguments passed by value</a></li>
<li><a href="#r-uses-lexical-scoping"><span class="toc-section-number">31.10</span> R uses <em>lexical scoping</em></a></li>
<li><a href="#scoping-a-word-of-caution"><span class="toc-section-number">31.11</span> Scoping: a word of caution</a></li>
</ul></li>
<li><a href="#a-better-way-of-looping-the-apply-family"><span class="toc-section-number">32</span> A better way of looping: the “apply” family</a><ul>
<li><a href="#background-1"><span class="toc-section-number">32.1</span> Background</a></li>
<li><a href="#lapply"><span class="toc-section-number">32.2</span> <code>lapply</code></a></li>
<li><a href="#sapply"><span class="toc-section-number">32.3</span> <code>sapply</code></a></li>
<li><a href="#replicate"><span class="toc-section-number">32.4</span> <code>replicate</code></a></li>
<li><a href="#apply"><span class="toc-section-number">32.5</span> <code>apply</code></a></li>
<li><a href="#mapply"><span class="toc-section-number">32.6</span> <code>mapply</code></a></li>
</ul></li>
<li><a href="#do.call-and-its-applications"><span class="toc-section-number">33</span> <code>do.call</code> and its applications</a></li>
<li><a href="#string-manipulation"><span class="toc-section-number">34</span> String manipulation</a></li>
<li><a href="#pseudo-random-numbers"><span class="toc-section-number">35</span> Pseudo-random numbers</a><ul>
<li><a href="#background-and-motivation"><span class="toc-section-number">35.1</span> Background and motivation</a></li>
<li><a href="#generation-of-random-numbers"><span class="toc-section-number">35.2</span> Generation of random numbers</a></li>
<li><a href="#random-numbers-in-r"><span class="toc-section-number">35.3</span> Random numbers in R</a></li>
</ul></li>
<li><a href="#plotting"><span class="toc-section-number">36</span> Plotting</a><ul>
<li><a href="#background-2"><span class="toc-section-number">36.1</span> Background</a></li>
<li><a href="#the-murrell-book"><span class="toc-section-number">36.2</span> The Murrell book</a></li>
<li><a href="#plot-and-related-functions"><span class="toc-section-number">36.3</span> <code>plot</code> and related functions</a></li>
<li><a href="#graphics-parameters.-the-par-function"><span class="toc-section-number">36.4</span> Graphics parameters. The <code>par()</code> function</a><ul>
<li><a href="#colors"><span class="toc-section-number">36.4.1</span> Colors</a></li>
<li><a href="#font"><span class="toc-section-number">36.4.2</span> Font</a></li>
<li><a href="#character-expansion"><span class="toc-section-number">36.4.3</span> Character expansion</a></li>
<li><a href="#plotting-characters-and-lines"><span class="toc-section-number">36.4.4</span> Plotting characters and lines</a></li>
<li><a href="#margins"><span class="toc-section-number">36.4.5</span> Margins</a></li>
<li><a href="#layout"><span class="toc-section-number">36.4.6</span> Layout</a></li>
</ul></li>
<li><a href="#more-decorations"><span class="toc-section-number">36.5</span> More decorations</a></li>
<li><a href="#multiple-plots-on-one-display"><span class="toc-section-number">36.6</span> Multiple plots on one display</a></li>
<li><a href="#multiple-plots-on-multiple-displays"><span class="toc-section-number">36.7</span> Multiple plots on multiple displays</a></li>
<li><a href="#saving-a-plot-to-a-file"><span class="toc-section-number">36.8</span> Saving a plot to a file</a></li>
<li><a href="#plots-for-exploratory-data-analysis"><span class="toc-section-number">36.9</span> Plots for exploratory data analysis</a><ul>
<li><a href="#histogram"><span class="toc-section-number">36.9.1</span> Histogram</a></li>
<li><a href="#box-plot"><span class="toc-section-number">36.9.2</span> Box plot</a></li>
</ul></li>
</ul></li>
<li><a href="#querying-r-objects"><span class="toc-section-number">37</span> Querying R objects</a></li>
<li><a href="#the-working-directory"><span class="toc-section-number">38</span> The working directory</a></li>
<li><a href="#regular-expressions"><span class="toc-section-number">39</span> Regular expressions</a><ul>
<li><a href="#general-discussion"><span class="toc-section-number">39.1</span> General discussion</a></li>
<li><a href="#some-basic-syntax"><span class="toc-section-number">39.2</span> Some basic syntax</a><ul>
<li><a href="#escape-sequences"><span class="toc-section-number">39.2.1</span> Escape sequences</a></li>
</ul></li>
<li><a href="#commonly-used-pattern-matching-functions"><span class="toc-section-number">39.3</span> Commonly-used pattern-matching functions</a><ul>
<li><a href="#grep"><span class="toc-section-number">39.3.1</span> grep</a></li>
<li><a href="#regexpr-and-gregexpr"><span class="toc-section-number">39.3.2</span> regexpr and gregexpr</a></li>
<li><a href="#sub-and-gsub"><span class="toc-section-number">39.3.3</span> sub and gsub</a></li>
<li><a href="#strsplit"><span class="toc-section-number">39.3.4</span> strsplit</a></li>
</ul></li>
<li><a href="#more-complicated-examples"><span class="toc-section-number">39.4</span> More-complicated examples</a></li>
<li><a href="#regular-expressions-with-character-classes"><span class="toc-section-number">39.5</span> Regular expressions with character classes</a><ul>
<li><a href="#predefined-character-classes"><span class="toc-section-number">39.5.1</span> Predefined character classes</a></li>
<li><a href="#repetition-quantifiers"><span class="toc-section-number">39.5.2</span> Repetition quantifiers</a></li>
<li><a href="#reusing-the-matched-text"><span class="toc-section-number">39.5.3</span> Reusing the matched text</a></li>
<li><a href="#logical-or"><span class="toc-section-number">39.5.4</span> Logical OR</a></li>
</ul></li>
</ul></li>
<li><a href="#a-quick-review-control-panels-for-r"><span class="toc-section-number">40</span> A quick review: “control panels” for R</a><ul>
<li><a href="#the-interpreter-the-main-control-panel"><span class="toc-section-number">40.1</span> The interpreter: the main control panel</a><ul>
<li><a href="#the-settings-on-the-interpreter-control-panel"><span class="toc-section-number">40.1.1</span> The settings on the interpreter control panel</a></li>
<li><a href="#reading-out-the-settings-on-the-interpreter-control-panel"><span class="toc-section-number">40.1.2</span> Reading out the settings on the interpreter control panel</a></li>
<li><a href="#changing-the-settings-on-the-interpreter-control-panel"><span class="toc-section-number">40.1.3</span> Changing the settings on the interpreter control panel</a></li>
</ul></li>
<li><a href="#the-options-control-panel"><span class="toc-section-number">40.2</span> The <code>options</code> control panel</a></li>
<li><a href="#the-par-control-panel"><span class="toc-section-number">40.3</span> The <code>par</code> control panel</a></li>
<li><a href="#the-random-number-control-panel"><span class="toc-section-number">40.4</span> The random-number control panel</a></li>
</ul></li>
</ul>
</div>
<h1 id="acknowledgment"><a href="#acknowledgment"><span class="header-section-number">1</span> Acknowledgment</a></h1>
<p>This document was inspired by and partially based on:</p>
<pre><code>http://www-stat.wharton.upenn.edu/~buja/STAT-541/Stat-541-R-intro.R</code></pre>
<h1 id="the-r-website"><a href="#the-r-website"><span class="header-section-number">2</span> The R website:</a></h1>
<pre><code>http://cran.r-project.org</code></pre>
<p>You should browse this web site to learn about R and the associated resources.</p>
<h1 id="r-and-related-tools-for-sta-032"><a href="#r-and-related-tools-for-sta-032"><span class="header-section-number">3</span> R and related tools for STA 032</a></h1>
<p>There are four essential steps required to set up your own computer for the work you need to do in STA 032:</p>
<ol style="list-style-type: decimal">
<li>Install R</li>
<li>Install RStudio</li>
<li>Install the knitr package</li>
<li>Start using R Markdown</li>
</ol>
<h2 id="step-1-install-r"><a href="#step-1-install-r"><span class="header-section-number">3.1</span> Step 1: Install R</a></h2>
<p>Look again at the main R site:</p>
<pre><code>http://www.r-project.org/</code></pre>
<p>It has lots of good information, including pointers to pre-compiled versions of R for various platforms.</p>
<p>One thing to mention is that whenever you install R-related software, you’re asked to choose a CRAN mirror, i.e., a place from which to download the software. There are mirrors at UC Berkeley and at UCLA (sometimes referred to as “CA 1” and “CA 2” or similar), and these are probably the best ones to use at UCD.</p>
<h3 id="getting-started"><a href="#getting-started"><span class="header-section-number">3.1.1</span> Getting started</a></h3>
<p>Once you have R installed, you might want to open the program and type:</p>
<pre><code>help.start()</code></pre>
<p>at the prompt. Then follow the link to:</p>
<pre><code>An Introduction to R</code></pre>
<p>This is really all you need to know to get started using R. The rest of <strong>this</strong> section is mainly for culture and <strong>can be ignored</strong> (proceed to Step 2 below).</p>
<h3 id="windows-versus-mac-linux"><a href="#windows-versus-mac-linux"><span class="header-section-number">3.1.2</span> Windows versus Mac, linux</a></h3>
<p>In the opinion of many people, Windows is really not the best platform for this kind of computing, although it certainly <em>can</em> be done on Windows. If you’re running Windows, you might wish to consider running some form of linux in a virtual machine. VirtualBox is free and is widely used:</p>
<pre><code>https://www.virtualbox.org/</code></pre>
<p>Check with the instructor if you have questions about this.</p>
<h3 id="software-on-linux"><a href="#software-on-linux"><span class="header-section-number">3.1.3</span> Software on linux</a></h3>
<p>If you’re fortunate enough to already be running some form of linux, all you need to do is to tell your package manager that you’d like to have R installed:</p>
<pre><code>sudo apt-get install R    #### Debian family (including Ubuntu)
(see also: http://cran.r-project.org/bin/linux/ubuntu/README )

sudo yum install R    #### Redhat family (including Fedora)</code></pre>
<h3 id="software-on-mac"><a href="#software-on-mac"><span class="header-section-number">3.1.4</span> Software on Mac</a></h3>
<p>If you’re using a Mac, you can get a ready-made version of R from:</p>
<pre><code>http://cran.r-project.org/bin/macosx/</code></pre>
<p>Mac users might also want to have a look at the “Homebrew” package manager for Macintosh:</p>
<pre><code>http://mxcl.github.com/homebrew/</code></pre>
<p>Homebrew is overkill for this particular task, and it requires a bit of fiddling to get it right. If that’s not your thing, then you should stick with the pre-built package from CRAN. But there are other benefits to using Homebrew.</p>
<h2 id="step-2-install-rstudio"><a href="#step-2-install-rstudio"><span class="header-section-number">3.2</span> Step 2: Install RStudio</a></h2>
<p>Open a browser and navigate to:</p>
<pre><code>http://www.rstudio.com/ide/download/</code></pre>
<p>Select:</p>
<pre><code>Download RStudio Desktop</code></pre>
<p>and pick the version that’s appropriate for your system.</p>
<h2 id="step-3-install-the-knitr-package"><a href="#step-3-install-the-knitr-package"><span class="header-section-number">3.3</span> Step 3: Install the knitr package</a></h2>
<p>Strictly speaking, you can do all of the calculations for this class using only R (from Step 1). The use of RStudio (from Step 2) simplifies many of the tasks involved in using R.</p>
<p>The “knitr” package is an add-on package for R (one of 6000+ such packages available at CRAN and other places). See the discussion of packages below for some more details.</p>
<p>The purpose of knitr is to allow you to combine descriptive text and R code in a single document (so-called “literate programming”) and to make it easy to generate publication-quality documents with a click of a button.</p>
<p>You can install knitr (and other packages) from RStudio. Go to the RStudio pane on the lower-right of the screen and select the “Packages” tab. Select:</p>
<pre><code>Install Packages</code></pre>
<p>by clicking on the icon near the upper-left of the pane. Just put:</p>
<pre><code>knitr</code></pre>
<p>in the Packages field of the pop-up window and then select “Install”.</p>
<p>For the record, note that you can install packages directly from R, i.e., whether or not you’re in RStudio. E.g.,</p>
<pre><code>&gt; install.packages(&quot;knitr&quot;)</code></pre>
<p>Regardless of the method you use, you <em>are</em> making use of CRAN, or one of its mirrors. RStudio just constructs the appropriate command and executes it on your behalf.</p>
<h2 id="step-4-start-using-r-markdown"><a href="#step-4-start-using-r-markdown"><span class="header-section-number">3.4</span> Step 4: Start using R Markdown</a></h2>
<p>You’re going to be using the knitr package to “knit” from an R Markdown file to an HTML file. This will produce a nicely formatted document that you will then submit to SmartSite (i.e, for your homeworks, etc.). The knitr package will do all the formatting for you, although it <em>is</em> highly customizable.</p>
<h3 id="the-knitting-process"><a href="#the-knitting-process"><span class="header-section-number">3.4.1</span> The “knitting” process</a></h3>
<p>To knit to HTML you first have to be working in an R Markdown file, usually named with the suffix “Rmd”:</p>
<pre><code>junk.Rmd</code></pre>
<p>To get some practice doing this, do the following:</p>
<pre><code>1. Open RStudio

2. Open a new Rmd file:

    File --&gt; New --&gt; R Markdown</code></pre>
<p>This will open a file in the upper-left pane of the RStudio display that will ALREADY have some example content in it. You can convert that to HTML by selecting the:</p>
<pre><code>Knit HTML</code></pre>
<p>button that appears in the row of icons just above the Rmd file.</p>
<p>You’ll be asked to save the file. Pick any name you like, such as:</p>
<pre><code>junk.Rmd</code></pre>
<p>You should see a window pop up with some bold text, a table of numbers, and a plot. IN ADDITION to this pop-preview, there will be a corresponding file:</p>
<pre><code>junk.html</code></pre>
<p>in you current working directory (or “folder”). That’s the file that you can send to SmartSite or to a colleague. (There will also be an intermediate file, “junk.md”, that you can safely ignore.)</p>
<h3 id="adding-your-own-r-code"><a href="#adding-your-own-r-code"><span class="header-section-number">3.4.2</span> Adding your own R code</a></h3>
<p>This should show you how the process works. Next, put your own R code into an Rmd file if you haven’t done so already.</p>
<p>Note that all of the R code goes into “code chunks” that look like:</p>
<pre><code>    ```{r someLabel}

        x &lt;- 42    #### That is, some R code goes between the backticks
    
    ``` </code></pre>
<h3 id="some-words-about-code-chunks"><a href="#some-words-about-code-chunks"><span class="header-section-number">3.4.3</span> Some words about code chunks</a></h3>
<p>Have a look at the “Chunks” icon at the upper-right of the Rmd pane. Note, by the way, that there are <strong>numerous</strong> options that you can put on <code>{r}</code> line. The template Rmd file shows some options for figures. Have a look at:</p>
<pre><code>http://yihui.name/knitr/options</code></pre>
<p>for a detailed discussion. It’s good practice to always include a label for the code chunk, as with <code>someLabel</code> in the example above. This will make it easier for you to pinpoint mistakes (i.e., just in case you make any).</p>
<h3 id="r-markdown-reference"><a href="#r-markdown-reference"><span class="header-section-number">3.4.4</span> R Markdown reference</a></h3>
<p>All this stuff is discussed very clearly at:</p>
<pre><code>http://www.rstudio.com/ide/docs/authoring/using_markdown</code></pre>
<h3 id="summary"><a href="#summary"><span class="header-section-number">3.4.5</span> Summary</a></h3>
<p>Once you have an R markdown file with at least one code chunk and, preferably, some discussion outside of the code chunk(s), you knit to HTML just as you did with the template file (called <code>junk.Rmd</code> in the example above). Again, this process creates a permanent file (<code>junk.html</code> in the example) in addition to the preview window. Here, “permanent” means that the file continues to exist even after you close the preview window, and you can view the file in your regular browser (Chrome, Firefox, Opera, etc.).</p>
<h1 id="the-simplest-use-of-r"><a href="#the-simplest-use-of-r"><span class="header-section-number">4</span> The simplest use of R</a></h1>
<p>Load the “.Rmd” version of this file into RStudio. Then place your cursor on each of the lines of code in turn inside the following “code chunk” and send each line to the R interpreter by typing:</p>
<pre><code>CTRL-Enter (Windows/linux)
Command-Enter (Macintosh)</code></pre>
<p>at each line. Note: this means to hold down two keys simultaneously, the key marked “Ctrl” on most keyboards and the key marked “Enter” on most keyboards. (Or the key marked “command” and the key marked “enter/return” on Macintosh keyboards.)</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="dv">1</span> +<span class="st"> </span><span class="dv">2</span>
<span class="dv">1</span>:<span class="dv">10</span>
<span class="dv">2</span>^(<span class="dv">1</span>:<span class="dv">20</span>)
<span class="kw">runif</span>(<span class="dv">10</span>)
<span class="kw">rnorm</span>(<span class="dv">10</span>)
<span class="dv">1</span>:<span class="dv">10</span> +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)</code></pre>
<p>Note that some of the above will be explained only later in the course. You should experiment with the code until you have a reasonable understanding of it.</p>
<h1 id="some-background-information-about-r"><a href="#some-background-information-about-r"><span class="header-section-number">5</span> Some Background Information about R</a></h1>
<h2 id="r-is-an-interpreted-language"><a href="#r-is-an-interpreted-language"><span class="header-section-number">5.1</span> R is an <strong>Interpreted Language</strong></a></h2>
<p>This means that users type expressions and see results immediately. For example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
for (i in <span class="dv">1</span>:<span class="dv">10</span>) {
    if (i%%<span class="dv">2</span> ==<span class="st"> </span><span class="dv">0</span>) 
        <span class="kw">print</span>(i)
}</code></pre>
<pre><code>## [1] 2
## [1] 4
## [1] 6
## [1] 8
## [1] 10</code></pre>
<p>This is as opposed to:</p>
<ol style="list-style-type: decimal">
<li>Compiled languages (C, C++, Fortran)</li>
<li>Point-and-click software (SAS JMP)</li>
</ol>
<h2 id="r-is-high-level"><a href="#r-is-high-level"><span class="header-section-number">5.2</span> R is <strong>High Level</strong></a></h2>
<p>It operates on complex data structures such as vectors, matrices, arrays, lists, dataframes, (all to be defined later) as opposed to C and Fortran, for instance, that operate on individual numbers only.</p>
<p>This may seem awkward at first to C and C++ programmers.</p>
<h2 id="autoprinting"><a href="#autoprinting"><span class="header-section-number">5.3</span> <strong>Autoprinting</strong></a></h2>
<p>In an interactive session, whatever is typed gets printed:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="dv">2</span></code></pre>
<pre><code>## [1] 2</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="dv">2</span>)  <span class="co"># same</span></code></pre>
<pre><code>## [1] 2</code></pre>
<p>The <em>print</em> statement is optional here, but it may be required in non-interactive sessions.</p>
<p>Why is there <code>[1]</code> preceding the results? It’s because R considers numbers as vectors of length 1. Compare with a vector of length greater than 1:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="dv">1</span>:<span class="dv">40</span></code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
## [24] 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="dv">1</span>:<span class="dv">40</span>)</code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
## [24] 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40</code></pre>
<h2 id="syntax"><a href="#syntax"><span class="header-section-number">5.4</span> <strong>Syntax</strong></a></h2>
<ol style="list-style-type: decimal">
<li>R uses largely scientific/math notation; base 10.</li>
<li>R has a wealth of functions (examples later).</li>
<li>Comments run from a <code>#</code> to the end of the line; no multiline comments.</li>
<li>Spaces are irrelevant, except inside strings. Put your cursor on each of the following lines and send the lines to R:</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">
    <span class="dv">2+3</span>
    <span class="dv">2</span>  +<span class="st">    </span><span class="dv">3</span>
    <span class="st">&quot;red and blue&quot;</span>
    <span class="st">&quot;   red   and   blue&quot;</span></code></pre>
<h2 id="more-syntax"><a href="#more-syntax"><span class="header-section-number">5.5</span> <strong>More Syntax</strong></a></h2>
<ol style="list-style-type: decimal">
<li>Statements can run over multiple lines. Send the following lines to R:</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="dv">2</span> +<span class="st"> </span><span class="dv">3</span> +
<span class="st">  </span><span class="dv">4</span></code></pre>
<p>But note that there has to be a “hint” to R that this is a multi-line statement. Send the following to R:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span> +<span class="st"> </span><span class="dv">3</span>
+<span class="dv">4</span></code></pre>
<p>Finally, you can put multiple statements onto a single line, separating them by semi-colons:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    <span class="dv">2</span>; <span class="dv">2</span>^<span class="dv">10</span>; <span class="kw">sqrt</span>(<span class="dv">625</span>)</code></pre>
<p>There is typically no advantage to this.</p>
<h1 id="basic-data-types"><a href="#basic-data-types"><span class="header-section-number">6</span> Basic Data Types</a></h1>
<h2 id="double-precision"><a href="#double-precision"><span class="header-section-number">6.1</span> Double Precision</a></h2>
<p>Numeric objects in R are double-precision (usually 64 bits or 8 bytes) by default. There is no single precision, and things that “look” like integers really are not – they’re double-precision, except as indicated below.</p>
<p>Here are some examples of numeric objects in R:</p>
<pre class="sourceCode r"><code class="sourceCode r">
-<span class="dv">2</span>
<span class="fl">1e+05</span>
<span class="fl">0.002</span></code></pre>
<p>All the usual unary and binary operations are allowed on numerical objects, and the usual “math stuff” is defined as well: +, -, *, /, %%, %/%, ^, log, sqrt, sin, acos, …</p>
<p>Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="dv">2</span> +<span class="st"> </span><span class="dv">3</span>  <span class="co"># Add.</span>
<span class="fl">5.3</span> *<span class="st"> </span><span class="fl">1e+10</span>  <span class="co"># Multiply.</span>
<span class="dv">10</span>%%<span class="dv">3</span>  <span class="co"># Modulo.</span>
<span class="kw">exp</span>(<span class="dv">1</span>)  <span class="co"># Exponentiation.</span>
<span class="kw">log</span>(<span class="fl">2.718282</span>)  <span class="co"># Log of the number `e`; `log` is `e`-based.</span>
<span class="kw">log10</span>(<span class="dv">10</span>)  <span class="co"># 10-based log</span>
pi  <span class="co"># That&#39;s the number `greek pi`, 3.14159...</span>
<span class="kw">sin</span>(pi/<span class="dv">2</span>)  <span class="co"># Angles are to be given in radians, not degrees.</span>
<span class="kw">sin</span>(pi)  <span class="co"># Ditto.</span>
<span class="kw">acos</span>(<span class="dv">0</span>)  <span class="co"># This is the inverse of cos, arccos, hence pi/2.</span>
pi/<span class="dv">2</span>  <span class="co"># `pi` is the only hardwired constant: 3.14159...</span></code></pre>
<h2 id="integers"><a href="#integers"><span class="header-section-number">6.2</span> Integers</a></h2>
<p>Numeric objects are double-precision by default, but it’s possible to create truly integer-valued objects in R. Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
uuu &lt;-<span class="st"> </span><span class="dv">7</span>  ## a regular, double-precision numeric
uuu
<span class="kw">str</span>(uuu)

vvv &lt;-<span class="st"> </span><span class="kw">as.integer</span>(uuu)
vvv
<span class="kw">str</span>(vvv)

www &lt;-<span class="st"> </span>7L  ## an integer constant; the `L` is required
www
<span class="kw">str</span>(www)

zzz &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">5</span>  ## some functions produce integers
zzz
<span class="kw">str</span>(zzz)</code></pre>
<p>Here’s a <strong>digression</strong>: we used the term “some functions” in the example above. Where’s the function in that example? Send the following code to R, and you’ll see:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  yyy &lt;-<span class="st"> `</span><span class="dt">:</span><span class="st">`</span>(<span class="dv">1</span>, <span class="dv">5</span>)
  yyy
  <span class="kw">str</span>(yyy)
  </code></pre>
<h2 id="strings"><a href="#strings"><span class="header-section-number">6.3</span> Strings</a></h2>
<p>These are pieces of text, or “words”. They are delimited by single or double quotes, but the <code>print</code> function will show them with double quotes:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="st">&quot;a&quot;</span>
<span class="st">&quot;a&quot;</span>
<span class="st">&quot;abc&quot;</span>
<span class="st">&quot;abc&quot;</span></code></pre>
<p>In C and Python strings are character vectors. Here’s an example from Python, for instance:</p>
<pre><code>    Python 2.7.3 (default, Aug  9 2012, 17:23:57) 
    [GCC 4.7.1 20120720 (Red Hat 4.7.1-5)] on linux2
    Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
    &gt;&gt;&gt; myString = &quot;Now is the time&quot;
    &gt;&gt;&gt; myString[0]
    &#39;N&#39;
    &gt;&gt;&gt; myString[4]
    &#39;i&#39;
    &gt;&gt;&gt; myString[4:6]
    &#39;is&#39;
    </code></pre>
<p>In R strings are basic types; there is no single character type. Characters are just strings of length 1.</p>
<p>There is no indexed access to individual characters and substrings in R; one uses the <code>substring</code> function instead:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">substring</span>(<span class="st">&quot;abcxyz&quot;</span>, <span class="dv">4</span>, <span class="dv">6</span>)</code></pre>
<p>Other basic string manipulations include:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">paste</span>(<span class="st">&quot;my&quot;</span>, <span class="st">&quot;word&quot;</span>)
<span class="kw">nchar</span>(<span class="st">&quot;supercalifragilistikexpialidocious&quot;</span>)</code></pre>
<p>There are two built-in character vectors that contain the lower and upper case letters:</p>
<pre class="sourceCode r"><code class="sourceCode r">
letters
LETTERS</code></pre>
<p>These are often used in examples and are sometimes used with the <code>paste</code> function to create labels, etc.</p>
<h2 id="logical"><a href="#logical"><span class="header-section-number">6.4</span> Logical</a></h2>
<p>These are objects that can take on only two values: <code>TRUE</code> and <code>FALSE</code>.</p>
<p><em>Note</em>: R recognizes <code>T</code> and <code>F</code> as synonyms for <code>TRUE</code> and <code>FALSE</code>. It’s a <em>bad idea</em> to use the short forms. (For one thing, you can <em>redefine</em> <code>T</code> and <code>F</code>. Try sending <code>T &lt;- 42</code> to R, for example.) Take the extra two seconds and type out the whole word. You’ll be glad you did.</p>
<p>Another note: <code>TRUE</code> and <code>FALSE</code> are stored as the numbers <code>1</code> and <code>0</code>, respectively. This makes possible the seemingly dubious practice of doing arithmetic on logical objects.</p>
<p>One way to generate logical values is to use the usual comparison operators:</p>
<p><code>&lt;, &gt;, &lt;=, &gt;=, ==, !=</code></p>
<p>Some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="dv">1</span> &lt;<span class="st"> </span><span class="dv">2</span>
<span class="dv">1</span> &gt;<span class="st"> </span><span class="dv">2</span>
<span class="st">&quot;ab&quot;</span> &lt;=<span class="st"> &quot;abcd&quot;</span>
<span class="st">&quot;ab&quot;</span> &gt;<span class="st"> &quot;ac&quot;</span>
<span class="st">&quot;ab&quot;</span> !=<span class="st"> &quot;AB&quot;</span>
<span class="st">&quot;ab&quot;</span> !=<span class="st"> </span><span class="dv">2</span>
<span class="dv">0</span> ==<span class="st"> </span><span class="ot">FALSE</span>
<span class="dv">1</span> ==<span class="st"> </span><span class="ot">TRUE</span>
<span class="ot">FALSE</span> +<span class="st"> </span><span class="ot">TRUE</span> +<span class="st"> </span><span class="ot">TRUE</span> +<span class="st"> </span><span class="ot">FALSE</span></code></pre>
<h2 id="missing-and-exceptional-values-na-nan-inf--inf"><a href="#missing-and-exceptional-values-na-nan-inf--inf"><span class="header-section-number">6.5</span> Missing and exceptional values: NA, NaN, Inf, -Inf</a></h2>
<h3 id="missing-values"><a href="#missing-values"><span class="header-section-number">6.5.1</span> Missing values</a></h3>
<p>It is sometimes the case that some data are missing. You may ask R to read in a table of experimental results, where, by accident, some of the results have not been recorded;</p>
<pre><code>    Name    Mass[kg]        Accel[m/s]
    Earth   5.98 * 10^24    9.81
    Mercury                 3.59
    Mars    6.42 * 10^23    3.77
    Jupiter 1.90 * 10^27        
</code></pre>
<p>Ooops. Somebody forgot to write down the mass of Mercury and the acceleration of gravity on Jupiter. In such cases, R will go ahead and read the table but will assign a special value, <code>NA</code>, to the missing items. There are ways to deal with the <code>NA</code>’s in subsequent calculations. For instance,</p>
<pre><code>  is.na(x)
</code></pre>
<p>will return <code>TRUE</code> if <code>x</code> has a value of <code>NA</code> and <code>FALSE</code> if it doesn’t.</p>
<h3 id="infinite-numbers"><a href="#infinite-numbers"><span class="header-section-number">6.5.2</span> Infinite numbers</a></h3>
<p>R will also deal gracefully with <code>infinite</code> numbers:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="dv">1</span>/<span class="dv">0</span>
x
<span class="dv">2</span>/x
-<span class="dv">3</span>/<span class="dv">0</span></code></pre>
<h3 id="numbers-that-just-dont-make-no-sense"><a href="#numbers-that-just-dont-make-no-sense"><span class="header-section-number">6.5.3</span> Numbers that just don’t make no sense</a></h3>
<p>But there are times, in mathematics and in R, where calculations lead to results that just don’t make sense in the normal framework. In such cases, R will assign a value of <code>NaN</code> (not a number):</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="dv">0</span>/<span class="dv">0</span>
x</code></pre>
<h1 id="r-is-a-functional-language"><a href="#r-is-a-functional-language"><span class="header-section-number">7</span> R is a Functional Language</a></h1>
<p>R is a functional language in what you might call the colloquial sense: it has built-in functions that return values, and you can define and use your own functions.</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">16</span>)  ## `sqrt` is a built-in function
y &lt;-<span class="st"> </span>x *<span class="st"> </span><span class="dv">42</span>  ## now using the result of the function call
y

zFn &lt;-<span class="st"> </span>function(w) {
    ## write our own function to do the above
    wRt &lt;-<span class="st"> </span><span class="kw">sqrt</span>(w)
    wRt *<span class="st"> </span><span class="dv">42</span>
}

<span class="kw">zFn</span>(<span class="dv">16</span>)</code></pre>
<p><strong>Note</strong>: we’ll discuss below in much greater detail the ways to define and use your own functions in R, but you can use the <code>zFn</code> example above as a template. (Or take a peek ahead if you want the details now.)</p>
<h2 id="r-language-details-for-geeks--"><a href="#r-language-details-for-geeks--"><span class="header-section-number">7.1</span> R language details for geeks ;-)</a></h2>
<p>This paragraph is essentially a digression, but people with an interest in, say, computer science, may have some interest in it. R also has attributes of a functional language in the technical sense. It was derived originally from Lisp. But R is clearly NOT a purely functional language: you can use R to generate plots, PDF files, etc., which are side-effects of function calls. It’s also the case that R incorporates two different paradigms, referred to as <code>S3</code> and <code>S4</code>, for doing object-oriented programming. We won’t be directly concerned with these in this class.</p>
<h1 id="statementsexpressions"><a href="#statementsexpressions"><span class="header-section-number">8</span> Statements/Expressions</a></h1>
<p>There are <strong>two types</strong> of expressions: <em>assignments</em> and <em>side effects</em>.</p>
<h2 id="assignments"><a href="#assignments"><span class="header-section-number">8.1</span> Assignments</a></h2>
<p>These expressions allocate data structures and make variables point to them.</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">3</span>  <span class="co"># Allocate a vector 1,2,3 and make &#39;x&#39; point to it.</span></code></pre>
<h2 id="side-effects"><a href="#side-effects"><span class="header-section-number">8.2</span> Side effects</a></h2>
<p>These are essentially display operations such as printing, plotting, showing help. Unlike assignments, they don’t change the computational state of the R system.</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">3</span>
x
<span class="kw">print</span>(x)
<span class="kw">plot</span>(x)
<span class="kw">help</span>(<span class="st">&quot;+&quot;</span>)  <span class="co"># Show the help page of addition.</span>
<span class="kw">help</span>(sqrt)  <span class="co"># Show the help page of the square root function.</span>
<span class="kw">help</span>(<span class="st">&quot;sqrt&quot;</span>)  <span class="co"># Ditto.</span></code></pre>
<h2 id="composite-statements"><a href="#composite-statements"><span class="header-section-number">8.3</span> Composite Statements</a></h2>
<p>These are multiple statements, considered as one, enclosed in “curly braces”:</p>
<pre class="sourceCode r"><code class="sourceCode r">
{
    <span class="kw">print</span>(<span class="dv">1</span>)
    <span class="kw">plot</span>(<span class="dv">1</span>:<span class="dv">10</span>)
}</code></pre>
<p>We saw an example of this in the function definition above, and it will also be needed in loops (discussed below). The notation is common to all “C-like” languages.</p>
<h2 id="various-forms-of-the-assignment-statement"><a href="#various-forms-of-the-assignment-statement"><span class="header-section-number">8.4</span> Various forms of the assignment statement</a></h2>
<p>Assignments to variables come in four equivalent syntactic forms:</p>
<pre><code>  x &lt;- ...
  x = ...
  ... -&gt; x
  assign(&quot;x&quot;,...)
</code></pre>
<p>Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span> *<span class="st"> </span><span class="dv">3</span>)  <span class="co"># Root of product of 2 and 3</span>
x =<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span> *<span class="st"> </span><span class="dv">3</span>)  <span class="co"># Both can be used: &#39;=&#39; and &#39;&lt;-&#39;</span>
## sqrt(2 * 3) -&gt; x # This can be used, too, if you must...
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1111</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)  <span class="co"># combine 1,3,10... into a vector &#39;y&#39;</span>
z &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">3</span>  <span class="co"># Assign the vector containing 1,2,3 to a &#39;z&#39;.</span>
<span class="kw">assign</span>(<span class="st">&quot;x&quot;</span>, <span class="kw">sqrt</span>(<span class="dv">2</span> *<span class="st"> </span><span class="dv">4</span>))
<span class="kw">print</span>(x)</code></pre>
<h2 id="no-type-declarations"><a href="#no-type-declarations"><span class="header-section-number">8.5</span> No type declarations</a></h2>
<p>Note that variables jump into existence upon assignment. Unlike C and Fortran, there is no need to declare variables. The variables are not “typed”; that is, any variable can point to data of any type, such as vectors, lists, matrices, …</p>
<h1 id="getting-help"><a href="#getting-help"><span class="header-section-number">9</span> Getting Help</a></h1>
<h2 id="rs-built-in-help-function"><a href="#rs-built-in-help-function"><span class="header-section-number">9.1</span> R’s built-in <code>help</code> function</a></h2>
<p>Once you’re in R, help(function) or help(“function”) shows the documentation for “function”.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">help</span>(sqrt)  ## And from the &quot;See Also&quot; section of the output:

  <span class="kw">help</span>(<span class="st">&quot;Arithmetic&quot;</span>)
  <span class="kw">help</span>(<span class="st">&quot;log&quot;</span>)
  <span class="kw">help</span>(<span class="st">&quot;sin&quot;</span>)
  <span class="kw">help</span>(<span class="st">&quot;Special&quot;</span>)

  <span class="kw">help</span>(c)
  <span class="kw">help</span>(<span class="st">&quot;c&quot;</span>)   ## Same as help(c)  
  <span class="kw">help</span>(<span class="st">&quot;*&quot;</span>)   ## help(*) does not work</code></pre>
<p>Note that <code>?topic</code> can be used as a synonym for <code>help(topic)</code>:</p>
<pre><code>
  ?sqrt
  ?c
  ?&quot;*&quot;
</code></pre>
<p>Note also that most help topics in R have working, example code at the end of the help page. Furthermore, the R command:</p>
<pre><code>
   example(help-topic)
</code></pre>
<p>will automatically run <em>all</em> the example code for that topic. Here’s a specific example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">example</span>(log)  ## examples of the use of the logarithm function</code></pre>
<h2 id="apropos"><a href="#apropos"><span class="header-section-number">9.2</span> Apropos</a></h2>
<p>The <code>apropos</code> function in R is used to find functions related to some search term. For instance:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">apropos</span>(<span class="st">&quot;char&quot;</span>)</code></pre>
<p>lists all functions whose names contain the string “char”.</p>
<p>The <code>apropos</code> function is typically used when you remember that the function you need has <em>something</em> to do with <code>locale</code> (for example), but you can’t quite recall the details. Use:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">apropos</span>(<span class="st">&quot;locale&quot;</span>)</code></pre>
<p>to pin it down. You’ll find that there are <strong>lots</strong> (thousands) of functions available in R, so you really need a tool like <code>apropos</code>.</p>
<p>A couple of <em>notes</em>:</p>
<ol style="list-style-type: decimal">
<li><p>As mentioned above, the “See Also” section of help pages is also useful in tracking down the function you need.</p></li>
<li><p>The <code>apropos</code> function accepts regular expressions (to be discussed in more detail later). For instance, the command: apropos(“nchar$”) will show you all the currently available functions that <em>end</em> in “nchar”.</p></li>
</ol>
<h2 id="vignettes"><a href="#vignettes"><span class="header-section-number">9.3</span> Vignettes</a></h2>
<p>There are sometimes extended discussions of packages in R (packages are discussed below). The extended discussions are referred to as “vignettes”.</p>
<p>Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">vignette</span>()  ## lists all vignettes currently available
<span class="kw">library</span>(knitr)  ## load the knitr package into your current R session
<span class="kw">vignette</span>(<span class="st">&quot;knitr-intro&quot;</span>)  ## assuming you&#39;re now using knitr</code></pre>
<h1 id="functions-arguments-and-other-details"><a href="#functions-arguments-and-other-details"><span class="header-section-number">10</span> Functions: arguments and other details</a></h1>
<h2 id="function-arguments"><a href="#function-arguments"><span class="header-section-number">10.1</span> Function arguments</a></h2>
<p>Sometimes even if you know the function you need, you still can’t remember the arguments to the function. One way to display the arguments is to use the <code>str</code> function. For example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">str</span>(rnorm)
<span class="kw">str</span>(runif)</code></pre>
<h2 id="what-about-the-rest-of-the-function"><a href="#what-about-the-rest-of-the-function"><span class="header-section-number">10.2</span> What about the rest of the function?</a></h2>
<p>You can find more information about functions just by typing their names:</p>
<pre class="sourceCode r"><code class="sourceCode r">
rnorm
<span class="kw">print</span>(rnorm)  ## same

runif
<span class="kw">print</span>(runif)  ## same</code></pre>
<p>Note that this is sometimes a dead end, because many functions in R consist of little more than calls to some compiled C code. On the other hand, some functions in R are written using (other) R code, and you <em>can</em> examine those in detail (often not for the faint of heart). Send the command:</p>
<pre class="sourceCode r"><code class="sourceCode r">
ls</code></pre>
<p>to R to see an example of the latter.</p>
<h2 id="the-str-function-considered-useful"><a href="#the-str-function-considered-useful"><span class="header-section-number">10.3</span> The <code>str</code> function considered useful</a></h2>
<p>By the way, the function <code>str</code> is extremely useful for finding out details (the <em>str</em>ucture of) any R object:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">5</span>
x
<span class="kw">str</span>(x)
<span class="kw">str</span>(mtcars)  ## a built-in data set</code></pre>
<h1 id="management-of-data-and-functions"><a href="#management-of-data-and-functions"><span class="header-section-number">11</span> Management of Data and Functions</a></h1>
<h2 id="listing-r-objects-both-data-and-functions"><a href="#listing-r-objects-both-data-and-functions"><span class="header-section-number">11.1</span> Listing R objects, both data and functions</a></h2>
<p>Use either of:</p>
<pre><code>  ls();  objects()
</code></pre>
<p>to list all the data structures and functions that <strong>you</strong> defined in the current session.</p>
<p>Note also that the <code>ls</code> function takes a <code>pattern</code> argument, that allows you to search for partial matches (among other things):</p>
<pre class="sourceCode r"><code class="sourceCode r">
xytz &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">5</span>  ## you define a variable with a `t` in its name
<span class="kw">data</span>(mtcars)  ## you explicitly load a data set with a `t` in its name
<span class="kw">ls</span>(<span class="dt">pattern =</span> <span class="st">&quot;t&quot;</span>)  ## you look for anything with a `t` in its name</code></pre>
<p>(Finally, note also that the <code>pattern</code> argument can be a regular expression, which allows you to search for, say, names <em>ending</em> in <code>t</code>:</p>
<pre><code>pattern=&quot;t$&quot;</code></pre>
<p>or <em>starting</em> with <code>t</code>:</p>
<pre><code>pattern=&quot;^t&quot;</code></pre>
<p>etc., etc. Much more on this later.)</p>
<h2 id="removing-data-and-functions"><a href="#removing-data-and-functions"><span class="header-section-number">11.2</span> Removing data and functions</a></h2>
<p>Send the following code to R to see that R first creates a variable called <code>x</code> and asssigns a value to it, then removes that variable:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
x
<span class="kw">rm</span>(x)
x</code></pre>
<h1 id="packages-and-the-search-list"><a href="#packages-and-the-search-list"><span class="header-section-number">12</span> Packages and the <code>search</code> list</a></h1>
<h2 id="general-discussion-of-packages"><a href="#general-discussion-of-packages"><span class="header-section-number">12.1</span> General discussion of packages</a></h2>
<p>There are literally tens of thousands of functions, data sets, help files, and vignettes available in R. To make this enormous collection of information more manageable, <em>related</em> functions, data, and documents are commonly bundled together in a a thing called a <strong>package</strong>. Imagine taking all the textbooks, class notes, exams, etc., from your last English class and putting them all in a box, marking ENGLISH on the outside of the box, and putting the box on a shelf in your closet. Next year, when one of your friends takes the same English class, you take down the box and hand it to your friend, to help him/her get through the class. A package in R serves roughly the same function.</p>
<h2 id="r-always-has-some-packages-loaded-available"><a href="#r-always-has-some-packages-loaded-available"><span class="header-section-number">12.2</span> R always has <em>some</em> packages loaded (available)</a></h2>
<h3 id="packages-loaded-by-default"><a href="#packages-loaded-by-default"><span class="header-section-number">12.2.1</span> Packages loaded by default</a></h3>
<p>You can see the list of packages that R loads by default (i.e., unless you tell it to do otherwise) by sending the following to R:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">getOption</span>(<span class="st">&quot;defaultPackages&quot;</span>)</code></pre>
<p>(There’s actually another package, the <code>base</code> packages that’s <em>always</em> loaded, so the command above doesn’t list it.)</p>
<h2 id="packages-loaded-now"><a href="#packages-loaded-now"><span class="header-section-number">12.3</span> Packages loaded <em>now</em></a></h2>
<p>To see what packages are currently loaded in <em>your</em> R session, send the following to R:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">search</span>()</code></pre>
<h2 id="whats-in-a-given-package"><a href="#whats-in-a-given-package"><span class="header-section-number">12.4</span> What’s in a given package?</a></h2>
<p>The <code>search</code> command has given you a list of loaded packages. What’s in these packages? You can use the <code>ls</code> command to see the functions that are included in a package. For example, to see all functions that come with the base package of R:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ls</span>(<span class="st">&quot;package:base&quot;</span>)</code></pre>
<h2 id="sorting-this-out-a-bit-more"><a href="#sorting-this-out-a-bit-more"><span class="header-section-number">12.5</span> Sorting this out a bit more</a></h2>
<p>If you’ve run the <code>ls</code> command above, you’ve seen that you get what you might call an embarrassment of riches: hundreds of functions names, but no clue as to what the functions do, except that function names usually give <em>some</em> clue about purpose of the function.</p>
<p>You can get brief description of <em>some</em> of the functions in a package by using the <code>library</code> command:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">library</span>(<span class="dt">help =</span> base)</code></pre>
<h2 id="what-else-does-library-do"><a href="#what-else-does-library-do"><span class="header-section-number">12.6</span> What else does <code>library</code> do?</a></h2>
<p>A more-common use of the <code>library</code> command is to load additional packages into your R session. Send the following code to R and observe the results of the two <code>search</code> commands:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">search</span>()
<span class="kw">library</span>(xtable)
<span class="kw">search</span>()</code></pre>
<h2 id="namespace"><a href="#namespace"><span class="header-section-number">12.7</span> Namespace</a></h2>
<h3 id="general-remarks"><a href="#general-remarks"><span class="header-section-number">12.7.1</span> General remarks</a></h3>
<p>Suppose you have <em>two</em> boxes in your closet, the one marked ENGLISH and one marked GEOLOGY. Your friend is taking both classes this quarter but has declined to borrow your boxes (no room in his/her apartment). He/she asks to see “Midterm 1”. Hmmm. Both of your classes had a “Midterm 1”. Which one to use?</p>
<p>You would disambiguate by asking your friend: do you want “ENGLISH:Midterm 1” or “GEOLOGY:Midterm 1”?</p>
<p>This is the idea of a <code>namespace</code>. Each package has its own set of variables that are distinct from the variables in other packages, <strong>even if the variables have the same name</strong>.</p>
<h3 id="searching-package-namespaces"><a href="#searching-package-namespaces"><span class="header-section-number">12.7.2</span> Searching package namespaces</a></h3>
<p>When you refer to a variable (or function) in R, R goes through, in order, the packages listed by the <code>search</code> command and stops as soon as it finds a match.</p>
<p>This means that a variable of a given name can “mask” a variable of the same name that occurs later in the search. Here’s an example in which a careless programmer uses <code>ls</code> as the name of a function and “masks” the function <code>ls</code> that appears in the <code>base</code> package:</p>
<pre class="sourceCode r"><code class="sourceCode r">
ls &lt;-<span class="st"> </span>function(x) x  #### NOT a good idea!
ls
<span class="kw">ls</span>(<span class="st">&quot;package:base&quot;</span>)  #### compare to the results above</code></pre>
<h3 id="dealing-with-namespace-collisions"><a href="#dealing-with-namespace-collisions"><span class="header-section-number">12.7.3</span> Dealing with namespace “collisions”</a></h3>
<p>How can we deal with this? There are two options:</p>
<ul>
<li>disambiguate using the name of the package (as for ENGLISH, etc., above)</li>
<li>remove our definition of <code>ls</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">
base::<span class="kw">ls</span>(<span class="st">&quot;package:base&quot;</span>)  ## Note the double colon
<span class="kw">rm</span>(ls)  ## removes the first one in the search path (our defn. of `ls`)
ls</code></pre>
<h1 id="getting-into-and-out-of-r"><a href="#getting-into-and-out-of-r"><span class="header-section-number">13</span> Getting into and out of R</a></h1>
<h2 id="starting-r"><a href="#starting-r"><span class="header-section-number">13.1</span> Starting R</a></h2>
<p>When you’re using RStudio, you automatically have an R session running (in the lower-left portion of the screen). You can also start R from a terminal window (i.e., the command line) by typing:</p>
<pre><code>R</code></pre>
<p>The “R machinery” is <em>exactly the same</em> in both cases, but RStudio provides many additional bells and whistles.</p>
<h2 id="leaving-r"><a href="#leaving-r"><span class="header-section-number">13.2</span> Leaving R</a></h2>
<p>If you type:</p>
<pre><code>q()</code></pre>
<p>at the R prompt (“&gt;”) in any version of R, you will terminate the R session. You can do the same in RStudio by clicking on the window-close icon (usually an <code>x</code> located in one of the top corners of the screen).</p>
<h2 id="r-hates-to-say-goodbye"><a href="#r-hates-to-say-goodbye"><span class="header-section-number">13.3</span> R hates to say goodbye</a></h2>
<p>When you terminate an R session, R will ask you if you want to save the workspace. If you <em>do</em> save the workspace, R will create a file in your current working directory (“folder”) called:</p>
<pre><code>.RData</code></pre>
<p>that contains all the variables, functions, etc., that you currently have defined in your R session. Here’s a simple example from a command-line session of R:</p>
<pre><code>
$ R

R version 3.0.1 (2013-05-16) -- &quot;Good Sport&quot;
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)
.
.
.

&gt; x  ## Nothing up my sleeve
Error: object &#39;x&#39; not found
No suitable frames for recover()
&gt; x &lt;- 42  ## x is now defined
&gt; x
[1] 42
&gt; q()  ## I&#39;m outta here, but I don&#39;t want to lose my work!
Save workspace image? [y/n/c]: y
.
.
.
$ R    ## start R again

R version 3.0.1 (2013-05-16) -- &quot;Good Sport&quot;
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

.
.
.

[Previously saved workspace restored]

&gt; x  ## poof! x is here again!
[1] 42
&gt; 
</code></pre>
<h2 id="to-save-or-not-to-save"><a href="#to-save-or-not-to-save"><span class="header-section-number">13.4</span> To save or not to save</a></h2>
<p>In cases where you’re just doing some kind of exploratory work, you probably do <strong>not</strong> want to save your session. If you do save, when you start your next R session you’ll “inherit” all the mistakes, blind alleys, etc., that you went through in your previous session.</p>
<p>But suppose, for instance, that you’ve finally figured out how to do the STA 032 homework, and you’ve been doing serious, useful R calculations for about two hours now. On your laptop. Wait. Are you running out of battery? No problem: just plug in your A/C adapter and you’re good to … <strong>Oh no!</strong> It’s back at the apartment! This might be a good time to exit R and save your work.</p>
<h1 id="semantics"><a href="#semantics"><span class="header-section-number">14</span> Semantics</a></h1>
<p>Every assignment in R creates a <em>copy</em> of the assigned object. The assignment is done “by value”, not “by reference” as in some other languages.</p>
<p>The following code chunk demonstrates this feature.</p>
<pre class="sourceCode r"><code class="sourceCode r">
a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)  <span class="co">#</span>
a
b &lt;-<span class="st"> </span>a  <span class="co"># &#39;b&#39; gets its own copy.</span>
b  <span class="co"># We couldn&#39;t tell from this, though.</span>
a[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">2</span>  <span class="co"># Assign the value 2 to the first element of &#39;a&#39;.</span>
<span class="co"># This yields a test of whether &#39;a&#39; and &#39;b&#39; point to the same object.  If</span>
<span class="co"># they did, then &#39;b&#39; would also have 2 in the first position.</span>
a  <span class="co"># We know this.</span>
b  <span class="co"># Aha!  &#39;b&#39; was not changed by &#39;a[1] &lt;- 2&#39;.</span>
<span class="co"># Therefore, &#39;b&#39; has its own copy.</span></code></pre>
<h1 id="operator-syntax-and-precedence"><a href="#operator-syntax-and-precedence"><span class="header-section-number">15</span> Operator syntax and precedence</a></h1>
<p>R has all the usual mathematical (and other) operators (<code>+</code>, <code>-</code>, <code>*</code>, etc.) and many not-so-usual operators. We’ll be introducing these as we need them, but you can find a summary on the “Syntax” help page:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  ?Syntax</code></pre>
<h1 id="vectors"><a href="#vectors"><span class="header-section-number">16</span> Vectors</a></h1>
<p>The fundamental data type in R is the <strong>vector</strong>. It is an ordered collection of items, all of the <strong>same</strong> data type (numeric, logical, integer, etc.).</p>
<p>We’ve already seen examples of vectors. The following code chunk shows a few more.</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="fl">4.5</span>)  <span class="co"># Collect three numeric values in a vector.</span>
<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;ab&quot;</span>)  <span class="co"># Collect two strings in a vector.</span>
<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)  <span class="co"># Collect three logical values in a vector.</span>
<span class="kw">c</span>(<span class="fl">2.1</span>, <span class="ot">TRUE</span>)  <span class="co"># Not an error.  Coercion of TRUE to 1.</span>
<span class="kw">c</span>(<span class="dv">2</span>, <span class="st">&quot;a&quot;</span>, <span class="ot">TRUE</span>)  <span class="co"># Not an error.  Coercion of 2 and TRUE to strings.</span></code></pre>
<h2 id="coercion"><a href="#coercion"><span class="header-section-number">16.1</span> Coercion</a></h2>
<p>Note in this example, as in many places in R, if you enter the “wrong” type of argument, R assumes you <em>meant</em> to do that and will try to convert data types as necessary to make things work out (“work out” in this case meaning “have all items of the same data type”). This conversion among data types is usually referred to as <code>coercion</code> in R.</p>
<p>If the items are not of the same type, they are coerced as follows:</p>
<pre><code>  string &lt;-- numeric &lt;-- logical
</code></pre>
<h2 id="a-peek-ahead-lists"><a href="#a-peek-ahead-lists"><span class="header-section-number">16.2</span> A peek ahead: lists</a></h2>
<p>Note that if you have a situation in which you <em>need</em> to have disparate data types in a single data structure, you can use a generalized form of vector, called a <strong>list</strong>. These are discussed below.</p>
<p>You might be wondering why we bother at all to use vectors when lists are obviously “better”. There are good reasons, and they are discussed below.</p>
<h1 id="indexing-and-subsetting-vectors"><a href="#indexing-and-subsetting-vectors"><span class="header-section-number">17</span> Indexing and subsetting vectors</a></h1>
<p>R has a very powerful set of tools for getting at the elements of a vector (and other data structures):</p>
<ul>
<li>selection/mapping with positive integer indices</li>
<li>de-selection with negative integer indices</li>
<li>selection with logical indices</li>
<li>selection by name when vector entries are named (“associative array”)</li>
</ul>
<h2 id="numeric-indices"><a href="#numeric-indices"><span class="header-section-number">17.1</span> Numeric indices</a></h2>
<p>Note that vectors in R are ONE-based (unlike C, but like Fortran), meaning simply that you refer to the initial value of the vector with index <code>1</code>, and <em>not</em> index <code>0</code>. (You might argue that this is the “natural” way of counting: you call the first element “element 1”. But there are advantages to using the “unnatural” way, starting at 0.)</p>
<p>Here are some examples of indexing and subsetting a vector:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)
  a[<span class="dv">1</span>]; a[<span class="dv">2</span>]; a[<span class="dv">3</span>]

  a[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]    ## using a vector to subset another vector
  b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>); ## the subset-specifier can be a variable
  a[b]

  a[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)]  ## this one is interesting</code></pre>
<p>In the last example we’re telling R: give me the first element of <code>a</code>, then the second element, then the first element again, then the second element again, etc., and R happily obliges.</p>
<h2 id="exclusions-with-negative-numeric-indices"><a href="#exclusions-with-negative-numeric-indices"><span class="header-section-number">17.2</span> Exclusions with negative numeric indices</a></h2>
<p>Giving R a negative index to a vector tells R to <em>exclude</em> that element (as distinct from Python, for instance, where a negative index <em>selects</em> a particular element).</p>
<pre class="sourceCode r"><code class="sourceCode r">
a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)
b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)
a[-<span class="dv">1</span>]
a[<span class="kw">c</span>(-<span class="dv">1</span>, -<span class="dv">3</span>)]
a[-<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]  ## ditto
b &lt;-<span class="st"> </span><span class="kw">c</span>(-<span class="dv">1</span>, -<span class="dv">3</span>)
a[b]  ## same as above
a[<span class="kw">c</span>(-<span class="dv">1</span>, -<span class="dv">2</span>, -<span class="dv">3</span>)]  ## Nothing left.</code></pre>
<h2 id="logical-selection"><a href="#logical-selection"><span class="header-section-number">17.3</span> Logical selection</a></h2>
<p>If you index a vector in R with a collection of TRUE/FALSE values, R will return just the elements of the vector whose positions match the positions of the TRUE values in the index. As you’ll see, this is a powerful tool. Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)
b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)

a[<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)]
b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)
a[b]  <span class="co"># same as above</span>
a &gt;<span class="st"> </span><span class="dv">2</span>
a[a &gt;<span class="st"> </span><span class="dv">2</span>]  <span class="co"># !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
b &lt;-<span class="st"> </span>(a &gt;<span class="st"> </span><span class="dv">2</span>)
a[b]  <span class="co"># same as above</span></code></pre>
<p>Just to emphasize, in the last four lines of the code chunk above we were able to pick out all elements of the vector <code>a</code> that were greater than 2. Using logical operations (AND, OR, NOT) we can make very complex selection rules. More on this later.</p>
<p>A word of <em>caution</em>: the vector of TRUE/FALSE values must be of the same length as the vector you’re indexing. If it is <em>not</em>, R (again) assumes you intended that, and it “fixes” the problem by cyclically “recycling” the TRUE/FALSE values (if there aren’t enough) or truncating them (if there are too many). Some examples will help:</p>
<pre class="sourceCode r"><code class="sourceCode r">
a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)
b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)

a[<span class="ot">FALSE</span>]  ## c(FALSE,FALSE,FALSE)  &#39;FALSE&#39; is repeated 3 times
a[<span class="ot">TRUE</span>]  ## c(TRUE,TRUE,TRUE)

a[<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)]  ## too short: recycle to c(TRUE,FALSE,TRUE)
a[<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)]  <span class="co"># too long: truncate</span>

(<span class="dv">1</span>:<span class="dv">12</span>)[<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)]  <span class="co"># recycle (and leave out every third item)</span></code></pre>
<h2 id="repeated-indexing"><a href="#repeated-indexing"><span class="header-section-number">17.4</span> Repeated indexing</a></h2>
<p>Vectors can be indexed repeatedly. Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)
  b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)

  a[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)][<span class="dv">2</span>]  <span class="co"># Select item two of a[c(1,3)], i.e. item 3 of &#39;a&#39;.</span>
                <span class="co"># (Looks like a matrix element in C, but isn&#39;t!!)</span>
  (a[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])[<span class="dv">2</span>]   <span class="co"># This is what the previous expression really means.  </span>

  a[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)]</code></pre>
<h2 id="vector-indexing-and-subsetting-used-for-assignment"><a href="#vector-indexing-and-subsetting-used-for-assignment"><span class="header-section-number">17.5</span> Vector indexing and subsetting used for assignment</a></h2>
<p>Vector indexing and subsetting can be used for assignment. Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)
b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)

a[<span class="dv">1</span>:<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>)
a  <span class="co"># Print &#39;a&#39; to see the effect of the assignment.</span>
a[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">200</span>)
a
a[-<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>)
a
a[<span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10000</span>, <span class="dv">20000</span>)
a
a[<span class="dv">2</span>:<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
a
b &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
b[<span class="dv">3</span>:<span class="dv">6</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>)
b
b[<span class="dv">7</span>:<span class="dv">9</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>)  <span class="co"># works, but generates a warning</span></code></pre>
<p>In the last example, the segment of <code>b</code> that is to replaced has length <code>3</code>, but the thing that’s being put into <code>b</code> has length <code>2</code>. R warns you of this, but goes ahead and does the replacement using recycling:</p>
<pre><code>
   c(1000, 2000, 1000)  ## the replacement pattern extended by one element
</code></pre>
<h1 id="some-functions-that-create-vectors"><a href="#some-functions-that-create-vectors"><span class="header-section-number">18</span> Some functions that create vectors</a></h1>
<p>We’ve already seen numerous examples of creating a vector using the <code>c</code> function. Here are some other ways to create vectors.</p>
<h2 id="the-c-function-or-manual-entry"><a href="#the-c-function-or-manual-entry"><span class="header-section-number">18.1</span> The <code>c</code> function (or “manual entry”)</a></h2>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</code></pre>
<h2 id="sequences-of-equally-spaced-numbers"><a href="#sequences-of-equally-spaced-numbers"><span class="header-section-number">18.2</span> Sequences of equally spaced numbers</a></h2>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="dv">3</span>:<span class="dv">10</span>
<span class="dv">10</span>:<span class="dv">3</span>
<span class="kw">seq</span>(<span class="dv">3</span>, <span class="dv">10</span>)  <span class="co"># where to start, where to stop</span>
<span class="kw">seq</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>/<span class="dv">3</span>)  <span class="co"># third argument &#39;by&#39; = step size</span>
<span class="kw">seq</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dt">len =</span> <span class="dv">8</span>)  <span class="co"># where to start, where to stop, how many?</span>
<span class="kw">seq</span>(letters)  <span class="co"># List of indexes into &#39;letters&#39;</span></code></pre>
<h3 id="digression-on-data-type"><a href="#digression-on-data-type"><span class="header-section-number">18.2.1</span> Digression on data type</a></h3>
<p>Note that two of the sequences above are “numeric”, i.e., double-precision floating-point. The rest are integers. One of the numeric sequences is obvious. But the other one “looks” like a bunch of integers. Can you tell which it is? (Hint: the <code>str</code> function) This is sometimes important, as you <strong>cannot reliably test two floating-point numbers for equality</strong>.</p>
<h2 id="repetitions"><a href="#repetitions"><span class="header-section-number">18.3</span> Repetitions</a></h2>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">10</span>)
<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">5</span>)
<span class="co"># Here is something more complex that &#39;rep&#39; can also do:</span>
<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))
<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">3</span>))
<span class="co"># Logical values:</span>
<span class="kw">rep</span>(<span class="ot">TRUE</span>, <span class="dv">5</span>)
((<span class="dv">1</span>:<span class="dv">10</span>) &gt;<span class="st"> </span><span class="dv">5</span>)
(<span class="dv">1</span>:<span class="dv">10</span>)[(<span class="dv">1</span>:<span class="dv">10</span>) &gt;<span class="st"> </span><span class="dv">5</span>]</code></pre>
<p>Again, note the varying data types in the above.</p>
<h2 id="miscellaneous-ways-of-generating-vectors"><a href="#miscellaneous-ways-of-generating-vectors"><span class="header-section-number">18.4</span> Miscellaneous ways of generating vectors</a></h2>
<p>There are many other functions in R that you can use to create vectors. Here is a potpourri of some of those functions. We’ll discuss these functions in context later in the course.</p>
<pre class="sourceCode r"><code class="sourceCode r">
    <span class="co">#   Random numbers:</span>
  x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">5</span>) <span class="co"># Five uniform random numbers in [0,1]</span>
  x
  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">5</span>) <span class="co"># Five standard normal random numbers</span>
  y

    <span class="co">#   Random permutations:</span>
  x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">10</span>) <span class="co"># Random permutation of the numbers 1,2,...,10.</span>
  x

    <span class="co">#   Read a vector from file:</span>
  x &lt;-<span class="st"> </span><span class="kw">scan</span>(<span class="st">&quot;some.file&quot;</span>)  ## need to have &quot;some.file&quot; for this to work!</code></pre>
<h1 id="automatic-vector-extension"><a href="#automatic-vector-extension"><span class="header-section-number">19</span> Automatic vector extension</a></h1>
<p>You may be used to seeing in other languages errors generated when you try to index beyond the limits of an array. Here’s an example from Python:</p>
<pre><code>
  $ python
  Python 2.7.3 (default, Aug  9 2012, 17:23:57) 
  [GCC 4.7.1 20120720 (Red Hat 4.7.1-5)] on linux2
  Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
  &gt;&gt;&gt; x = [1, 3, 5]
  &gt;&gt;&gt; x
  [1, 3, 5]
  &gt;&gt;&gt; x[1]
  3
  &gt;&gt;&gt; x[4]
  Traceback (most recent call last):
    File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
  IndexError: list index out of range
  &gt;&gt;&gt; 
</code></pre>
<p>This kind of thing does <strong>not</strong> happen in R. If you <em>reference</em> an element of a vector that is beyond the limits of the vector, you don’t get an error message: you get back an <code>NA</code> (meaning “I’m not complaining, but you asked me for something that’s not there”.)</p>
<p>On the other hand, if you <em>assign</em> something to a previously non-existing element of a vector, R will happily extend the vector, stick in at the end the value you assigned, and fill in the intermediate slots with <code>NA</code>.</p>
<p>Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">5</span>)  <span class="co"># x has length 5.</span>
  x[<span class="dv">6</span>]           <span class="co"># NA, not an error message.</span>
  x[<span class="dv">10</span>] &lt;-<span class="st"> </span><span class="fl">9.99</span>  <span class="co"># Not an error!  Element 10 now exists.</span>
  x              <span class="co"># So do elements 6,7,8,9, filled in with NA.</span>
  <span class="kw">length</span>(x)      <span class="co"># Assignment can extend the length.</span>
  <span class="co">#     However, negative indexes (used for exclusion) can be out of bounds:</span>
  x[-<span class="dv">11</span>]           <span class="co"># Out of bounds, but OK: &quot;exclude item 11&quot; = nothing to do</span>
  x[-<span class="dv">9</span>]            <span class="co"># Ok, due to fill-in after assigning element 10.</span></code></pre>
<p><em>Note</em>: Automatic vector extension makes vectors very different from <em>matrices</em> and <em>arrays</em> (discussed below), for which automatic extension does <strong>not</strong> exist.</p>
<h1 id="named-vector-elements"><a href="#named-vector-elements"><span class="header-section-number">20</span> Named vector elements</a></h1>
<p>It is possible to <em>name</em> the elements of a vector, either as part of the definition of a vector, or after the fact:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">first =</span> <span class="dv">1</span>, <span class="dt">second =</span> <span class="dv">3</span>, <span class="dt">third =</span> <span class="dv">5</span>, <span class="dt">fourth =</span> <span class="dv">7</span>)
x

x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)
<span class="kw">names</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;first&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;third&quot;</span>, <span class="st">&quot;fourth&quot;</span>)
x
<span class="kw">names</span>(x)</code></pre>
<p>Why is this useful? It makes things clearer, but, also important, the names can be used for indexing and subsetting:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">first =</span> <span class="dv">1</span>, <span class="dt">second =</span> <span class="dv">3</span>, <span class="dt">third =</span> <span class="dv">5</span>, <span class="dt">fourth =</span> <span class="dv">7</span>)
x[<span class="st">&quot;second&quot;</span>]
x[<span class="kw">c</span>(<span class="st">&quot;second&quot;</span>, <span class="st">&quot;fourth&quot;</span>)]
nm &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;second&quot;</span>, <span class="st">&quot;third&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;third&quot;</span>)
x[nm]

## Named assignment/extension is possible:
x[<span class="kw">c</span>(<span class="st">&quot;fifth&quot;</span>, <span class="st">&quot;fourth&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">11</span>)
x
## Note: &#39;fourth&#39; existed and is re-assigned; &#39;fifth&#39; did not exist and is
## an extension of &#39;x&#39;.

## If names are not unique, the first matching name is selected:
<span class="kw">c</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">a =</span> <span class="dv">3</span>)
<span class="kw">c</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">a =</span> <span class="dv">3</span>)[<span class="st">&quot;a&quot;</span>]</code></pre>
<p>Some functions in R will automatically assign names to the values they return. Here’s one important example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">sample</span>(letters, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
<span class="kw">table</span>(x)</code></pre>
<p>We’ll discuss both <code>sample</code> and <code>table</code> in much more detail later, but the example above is just “randomly” grabbing 1000 lower-case letters and keeping track (via the <code>table</code> function) of the number of <code>a</code>’s, the number of <code>b</code>’s, etc.</p>
<h1 id="vectors-with-named-elements-as-associative-arrays"><a href="#vectors-with-named-elements-as-associative-arrays"><span class="header-section-number">21</span> Vectors with named elements as associative arrays</a></h1>
<p>Vectors with named elements in R can be used to create a limited form of “associative arrays”:</p>
<pre><code>http://en.wikipedia.org/wiki/Associative_array</code></pre>
<p>(These are referred to as <em>dictionaries</em> in Python and as <em>maps</em> in C++., for instance.)</p>
<p>The idea is that an object (a vector in this case) can be indexed by <em>keys</em> that are not necessarily numeric.</p>
<p>Here’s an example that illustrates the idea. Suppose you’d like to look up the salaries of employees by specifying just the <em>name</em> of the employee. You can create a named vector in R that lets you do this:</p>
<pre class="sourceCode r"><code class="sourceCode r">
salaries &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">John =</span> <span class="dv">35000</span>, <span class="dt">Brenda =</span> <span class="fl">1e+05</span>, <span class="dt">Jim =</span> <span class="dv">12000</span>)
salaries

salaries[<span class="st">&quot;Brenda&quot;</span>]</code></pre>
<p>There is one small “gotcha” in this: you <em>can</em> use numbers as the keys, but they will be converted (coerced) to strings in the process.</p>
<pre class="sourceCode r"><code class="sourceCode r">
salaries &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">35000</span>, <span class="fl">1e+05</span>, <span class="dv">12000</span>)
<span class="kw">names</span>(salaries) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>)
<span class="kw">names</span>(salaries)  ## these are strings now

salaries[<span class="st">&quot;2&quot;</span>]  ## beware that these two are not the same
salaries[<span class="dv">2</span>]</code></pre>
<h1 id="ranking-sorting-reversing-permuting"><a href="#ranking-sorting-reversing-permuting"><span class="header-section-number">22</span> Ranking, sorting, reversing, permuting</a></h1>
<h2 id="basic-sorting"><a href="#basic-sorting"><span class="header-section-number">22.1</span> Basic sorting</a></h2>
<p>As in most languages, sorting is important in R. Here are some functions that are used in the context of sorting.</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>:<span class="dv">1</span>, <span class="dv">5</span>:<span class="dv">10</span>)  ## unsorted vector
x
<span class="kw">rank</span>(x)  ## what posn. would each item have if sorted?  Note the tie.
<span class="kw">rank</span>(x, <span class="dt">ties.method =</span> <span class="st">&quot;first&quot;</span>)  ## another way to deal with ties
<span class="kw">sort</span>(x)  ## default is to sort in increasing order
<span class="kw">rev</span>(x)  ## reverse the order of the entries in x</code></pre>
<h2 id="permutations-and-other-uses-of-sample"><a href="#permutations-and-other-uses-of-sample"><span class="header-section-number">22.2</span> Permutations and other uses of <code>sample</code></a></h2>
<p>Something like the opposite of sorting, a “permutation” is a (potentially) scrambled listing of the elements of a vector. Permutations are important in probability, and it’s somewhat surprising the R has no built-in <code>permutation</code> function. The rationale may be that the built-in function <code>sample</code> will produce a permutation.</p>
<p>The <code>sample</code> function is one of the more-important functions that we’ll encounter in this course. We’ve seen an example of it above. Here are some more examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>:<span class="dv">1</span>, <span class="dv">5</span>:<span class="dv">10</span>)  ## unsorted vector
<span class="kw">sample</span>(x)  ## random permutation of &#39;x&#39;
<span class="kw">sample</span>(x, <span class="dt">size =</span> <span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)  ## random sample of size 100 from x
<span class="kw">sample</span>(x, <span class="dt">size =</span> <span class="dv">100</span>)  ## generates error.  Why?</code></pre>
<h2 id="the-order-function"><a href="#the-order-function"><span class="header-section-number">22.3</span> The <code>order</code> function</a></h2>
<p>From the R help page:</p>
<pre><code>  `order` returns a permutation which rearranges its first argument into
  ascending or descending order, breaking ties by further arguments.
</code></pre>
<p>Here is the canonical example for the <code>order</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>:<span class="dv">1</span>, <span class="dv">5</span>:<span class="dv">10</span>)  ## unsorted vector
<span class="kw">order</span>(x)
<span class="kw">sort</span>(x)
x[<span class="kw">order</span>(x)]  <span class="co"># Same!</span></code></pre>
<p>Hmmm. Well, <em>that</em> was underwhelming. Why bother with <code>order</code> at all, if it’s no more than a lengthier version of <code>sort</code>? The answer is that <code>order</code> can be used to sort more-complicated objects, such as matrices and data frames, which are both discussed below. See also the example below on parallel sorting, which is essentially the same idea.</p>
<p>R can sort non-numeric data, such as strings, for example.</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">sample</span>(letters)  ## some permutation of `a`, ..., `z`
x
<span class="kw">sort</span>(<span class="kw">sample</span>(letters))  ## undoes the permutation</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)  ## 10 random numbers from the interval [0, 1]
y &lt;-<span class="st"> </span>-x -<span class="st"> </span><span class="dv">100</span>  <span class="co"># `y` is just another vector of the same length as `x`.</span>
x  <span class="co"># Unordered parallel vectors</span>
y
ordx &lt;-<span class="st"> </span><span class="kw">order</span>(x)
x[ordx]  ## sort both `x` and `y` in ascending order of `x`
y[ordx]</code></pre>
<h1 id="simple-statistics"><a href="#simple-statistics"><span class="header-section-number">23</span> Simple statistics</a></h1>
<p>R has many functions for doing statistics (duh!). Here are some of the common ones:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">5</span>)  ## generate some numbers for the things below
<span class="kw">length</span>(x)
<span class="kw">sum</span>(x)
<span class="kw">mean</span>(x)
<span class="kw">var</span>(x)
<span class="kw">sqrt</span>(<span class="kw">var</span>(x))
<span class="kw">min</span>(x)
<span class="kw">max</span>(x)
<span class="kw">range</span>(x)
<span class="kw">median</span>(x)</code></pre>
<p>We’ll discuss these in context later in the course.</p>
<h1 id="cumulative-operations"><a href="#cumulative-operations"><span class="header-section-number">24</span> Cumulative operations</a></h1>
<p>R has some useful functions for computing cumulative values, e.g., a running sum of a series of numbers. Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
x
<span class="kw">cumsum</span>(x)
<span class="kw">cumprod</span>(x)
x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span> *<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, -<span class="dv">1</span>)
x
<span class="kw">cummax</span>(x)
<span class="kw">cummin</span>(x)</code></pre>
<h1 id="simple-numeric-functionstransformations-vectorization"><a href="#simple-numeric-functionstransformations-vectorization"><span class="header-section-number">25</span> Simple numeric functions/transformations; vectorization</a></h1>
<p>R has built-in functions for doing all of the usual mathematical operations (square root, cosine, etc., etc.). An unusual feature of the R implementation of these functions is that most of them (and many other functions in R) are automatically “vectorized”: if you give one of these functions an argument that is a vector containing, say, seven items, you’ll get back an answer containing seven items. Here are some concrete examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">20</span>, <span class="dt">min =</span> -<span class="dv">10</span>, <span class="dt">max =</span> +<span class="dv">10</span>)
x
<span class="kw">round</span>(x)
<span class="kw">round</span>(x, <span class="dt">digits =</span> <span class="dv">2</span>)
##
<span class="kw">round</span>(<span class="fl">1.5</span>)
<span class="kw">round</span>(<span class="fl">2.5</span>)
##
<span class="kw">trunc</span>(x)
<span class="kw">ceiling</span>(x)
<span class="kw">abs</span>(x)
##
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">36</span>)
<span class="kw">sqrt</span>(y)
<span class="kw">sqrt</span>(x)  ## works but NaN&#39;s produced for negative values in &#39;x&#39;
z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span> +<span class="st"> </span>(<span class="dv">0</span>+4i), <span class="dv">6</span> +<span class="st"> </span>(<span class="dv">0</span>+8i))  ## but R DOES handle complex numbers
<span class="kw">sqrt</span>(z)
##
<span class="kw">log</span>(x^<span class="dv">2</span>)
<span class="kw">exp</span>(<span class="dv">1</span>)
<span class="kw">exp</span>(x/<span class="dv">100</span>)
<span class="kw">cos</span>(pi)
<span class="kw">cos</span>(pi *<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>))  ## vectorized
##
<span class="kw">acos</span>(<span class="fl">0.5</span>)  ## trig functions use radians, not degrees
pi/<span class="dv">3</span></code></pre>
<h1 id="matrices"><a href="#matrices"><span class="header-section-number">26</span> Matrices</a></h1>
<p>Matrices have many uses in theoretical and applied statistics. See, for instance:</p>
<pre><code>http://en.wikipedia.org/wiki/Matrix_(mathematics)</code></pre>
<p>for a quick overview.</p>
<p>In R, matrices are implemented as <em>vectors</em>, but with additional “meta-information” that indicates that the vectors should be viewed as “rectangular” objects, with rows and columns.</p>
<p>Note that in a matrix, as with any vector, all of the elements must be of the <strong>same</strong> data type (all numeric or all logical or all strings, etc.). (Below we’ll discuss a generalization that removes this restriction.)</p>
<p>The elements of a matrix fill in column by column (so-called <strong>column-major order</strong>), as in Fortran, but unlike C and C++ (that use row-major order). On the other hand, there <em>are</em> ways to tell R that you want to fill in row by row.</p>
<p>Note also that you can change the <em>shape</em> of a given vector or matrix, i.e., make it “fatter” or “thinner”, “shorter” or “taller”, by supplying new values for the number of rows and columns. This will <em>not</em> change the order of the elements within the matrix.</p>
<h2 id="creating-a-matrix-by-hand"><a href="#creating-a-matrix-by-hand"><span class="header-section-number">26.1</span> Creating a matrix “by hand”</a></h2>
<p>Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
aDozen &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">12</span>  ## a vector of integer objects
<span class="kw">matrix</span>(aDozen, <span class="dt">ncol =</span> <span class="dv">4</span>)  ## reshape into a matrix with 4 columns
<span class="kw">matrix</span>(aDozen, <span class="dt">nrow =</span> <span class="dv">3</span>)  ## Same; ncol is inferred; using column major

<span class="kw">matrix</span>(aDozen, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)  ## Force the use of row-major
<span class="kw">matrix</span>(aDozen, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)  ## Same

<span class="kw">matrix</span>(<span class="dv">0</span>:<span class="dv">1</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)  ## supplied two values, asked for 8???
<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)  ## same kind of thing

<span class="kw">matrix</span>(letters, <span class="dt">ncol =</span> <span class="dv">2</span>)  ## elements are now strings
<span class="kw">matrix</span>(<span class="kw">paste</span>(<span class="st">&quot;UCD&quot;</span>, letters), <span class="dt">ncol =</span> <span class="dv">2</span>)  ## same but paste in a prefix</code></pre>
<h2 id="reading-a-matrix-from-a-file"><a href="#reading-a-matrix-from-a-file"><span class="header-section-number">26.2</span> Reading a matrix from a file</a></h2>
<p>You can read data into a matrix from a text file. You’d typically need to tell R to insert the data by row, and you might need to tell R to skip the first line of the file, if that line is just a header (and not data).</p>
<pre><code>
  myMat &lt;- matrix(scan(&quot;laser.dat&quot;,  ## need to have file &quot;laser.dat&quot; first!
                        skip=1),     ## skip the header line
                        ncol=4,      ## rows determined by length of file
                        byrow=TRUE)
  myMat
</code></pre>
<p>Later we’ll see a more convenient way to read tabular data (<code>read.table()</code> and related functions).</p>
<h2 id="is-this-object-a-matrix"><a href="#is-this-object-a-matrix"><span class="header-section-number">26.3</span> Is this object a matrix?</a></h2>
<p>Sometimes we encounter objects in R that look like matrices but aren’t. Doing matrix-like operations on them would result in an error. But you can check first:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">is.matrix</span>(<span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dv">3</span>))
<span class="kw">is.matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>)
x &lt;-<span class="st"> </span><span class="dv">2</span>
<span class="kw">is.matrix</span>(x)
x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
<span class="kw">is.matrix</span>(x)
x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">5</span>)
<span class="kw">is.matrix</span>(x)
<span class="kw">is.matrix</span>(<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">5</span>))  <span class="co"># tautology</span></code></pre>
<h2 id="a-vector-by-any-other-name-would-be-a-matrix"><a href="#a-vector-by-any-other-name-would-be-a-matrix"><span class="header-section-number">26.4</span> A vector by any other name would … be a matrix?</a></h2>
<p>As we discussed above, a matrix is just a vector with an additional attribute: the <code>dimension</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">
myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">as.numeric</span>(<span class="dv">1</span>:<span class="dv">12</span>), <span class="dt">nrow =</span> <span class="dv">3</span>)  ## force to double precision
<span class="kw">dim</span>(myMat)  ## Vector of length 12 with the two dimensions.
<span class="kw">dim</span>(myMat)[<span class="dv">1</span>]  ## view each dimension separately
<span class="kw">dim</span>(myMat)[<span class="dv">2</span>]
<span class="kw">attributes</span>(myMat)  ## another way to see the dimensions
<span class="kw">nrow</span>(myMat)  ## yet another way
<span class="kw">ncol</span>(myMat)</code></pre>
<h2 id="vector-to-matrix-and-back-again"><a href="#vector-to-matrix-and-back-again"><span class="header-section-number">26.5</span> Vector to matrix and back again</a></h2>
<p>A vector can be turned into a matrix by assigning the dimension attribute. And a matrix can be turned back into a vector by removing that attribute.</p>
<pre class="sourceCode r"><code class="sourceCode r">
myMat &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">12</span>  <span class="co"># Just a vector (despite the name!)</span>
myMat
<span class="kw">dim</span>(myMat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)  <span class="co"># NOW it&#39;s a matrix.</span>
myMat
<span class="kw">is.matrix</span>(myMat)  <span class="co"># Let&#39;s check (it&#39;s TRUE)</span>
<span class="kw">dim</span>(myMat) &lt;-<span class="st"> </span><span class="ot">NULL</span>
myMat
<span class="kw">is.matrix</span>(myMat)  <span class="co"># Check it again (it&#39;s FALSE)</span></code></pre>
<h2 id="names-for-the-rows-and-columns"><a href="#names-for-the-rows-and-columns"><span class="header-section-number">26.6</span> Names for the rows and columns</a></h2>
<p>By default, R refers to the elements of a matrix numerically, i.e., <code>myMat[2, 3]</code>. But it’s sometimes convenient to have more-descriptive identifiers, such as “Height” and “Weight” for the columns and “Name” for the rows. Here’s an example where we’re simply using the alphabet for the identifiers.</p>
<pre class="sourceCode r"><code class="sourceCode r">
myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)  ## ncol has to be 4
myMat

<span class="kw">colnames</span>(myMat) &lt;-<span class="st"> </span>letters[<span class="dv">1</span>:<span class="dv">4</span>]
<span class="kw">rownames</span>(myMat) &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span>:<span class="dv">3</span>]
myMat

<span class="kw">colnames</span>(myMat)
<span class="kw">rownames</span>(myMat)</code></pre>
<h2 id="indexing-and-subsetting-a-matrix-by-rows-and-columns"><a href="#indexing-and-subsetting-a-matrix-by-rows-and-columns"><span class="header-section-number">26.7</span> Indexing and subsetting a matrix by rows and columns</a></h2>
<p>It’s possible to subset a matrix. This is best explained by examples. Note that this is generally <em>not</em> the same as similar-looking operations in C.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">ncol=</span><span class="dv">4</span>)
  myMat
  myMat[<span class="dv">1</span>, <span class="dv">4</span>]             <span class="co"># Element in row 1, column 4.</span>
  myMat[<span class="dv">1</span>:<span class="dv">3</span>, ]            <span class="co"># First 3 rows.</span>
  myMat[ ,<span class="dv">3</span>:<span class="dv">4</span>]            <span class="co"># Last 2 columns.</span>
  myMat[<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">3</span>:<span class="dv">4</span>]         <span class="co"># Submatrix of size 3x2 (unlike Python!)</span>
  myMat[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>), ]  <span class="co"># Repeat rows 1 and 2.</span>
  myMat[ ,<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)]  <span class="co"># Repeat columns 1 and 2.</span>
  myMat[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>),
        <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)]    <span class="co"># Repeat left-upper 2x2 matrix 4 times.</span>
  myMat[-<span class="dv">1</span>, ]             <span class="co"># Select all but the first row.</span>
  myMat[ , -<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)]      <span class="co"># Select all but columns 2 and 4.</span>
  ##
  <span class="kw">colnames</span>(myMat) &lt;-<span class="st"> </span>letters[<span class="dv">1</span>:<span class="dv">4</span>]
  <span class="kw">rownames</span>(myMat) &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span>:<span class="dv">3</span>]
  ##
  myMat[<span class="st">&quot;A&quot;</span>, ]            <span class="co"># Works only if col/rownames have been assigned.</span>
  myMat[<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>), ]
  myMat[<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;a&quot;</span>]
  <span class="kw">str</span>(myMat[<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;a&quot;</span>])
  myMat[<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;a&quot;</span>, drop=<span class="ot">FALSE</span>]  <span class="co"># do NOT reduce the dim of the result</span>
  <span class="kw">str</span>(myMat[<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="st">&quot;a&quot;</span>, <span class="dt">drop=</span><span class="ot">FALSE</span>])</code></pre>
<h2 id="a-vector-is-a-vector"><a href="#a-vector-is-a-vector"><span class="header-section-number">26.8</span> A vector is a vector</a></h2>
<p>As in the example above, selecting an individual row or column of a matrix will generate a vector that doesn’t “know” it was once a row or column of a matrix. R has no concept of column vectors or row vectors.</p>
<p>But you can force the issue by turning such vectors into Nx1 or 1xN matrices, or you can use the <code>drop</code> argument (as above).</p>
<pre class="sourceCode r"><code class="sourceCode r">
myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)
myMat[, <span class="dv">1</span>]
<span class="kw">is.matrix</span>(myMat[, <span class="dv">1</span>])
<span class="kw">is.matrix</span>(myMat[<span class="dv">1</span>, ])

x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
<span class="kw">dim</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">1</span>)
x
<span class="kw">dim</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)
x

<span class="kw">is.matrix</span>(myMat[, <span class="dv">1</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>])</code></pre>
<h2 id="indexingsubsetting-can-be-used-for-assignment"><a href="#indexingsubsetting-can-be-used-for-assignment"><span class="header-section-number">26.9</span> Indexing/subsetting can be used for assignment</a></h2>
<pre class="sourceCode r"><code class="sourceCode r">
myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)
myMat

myMat[<span class="dv">1</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span>  ## row 1, column 2
myMat

myMat[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="dv">11</span>:<span class="dv">14</span>  ## row 1, all columns
myMat

myMat[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span>  ## all rows, column 1
myMat

myMat[<span class="dv">1</span>, <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">10</span>)  ## row 1, last 2 cols
myMat</code></pre>
<h2 id="associative-array-feature-for-matrices"><a href="#associative-array-feature-for-matrices"><span class="header-section-number">26.10</span> Associative-array feature for matrices</a></h2>
<p>If you have set up the appropriate names for the rows and/or columns of a matrix, you can use the names for indexing and subsetting.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">ncol=</span><span class="dv">4</span>)
  myMat

  <span class="kw">rownames</span>(myMat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>)       <span class="co"># like &#39;names(vec)&#39;</span>
  <span class="kw">colnames</span>(myMat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>)
  myMat

  myMat[<span class="st">&quot;x&quot;</span>, <span class="st">&quot;d&quot;</span>]           <span class="co"># single item (vector of length 1)</span>
  myMat[<span class="st">&quot;x&quot;</span>, ]              <span class="co"># vector (the &quot;x-th&quot; row)</span>
  myMat[ , <span class="st">&quot;c&quot;</span>]             <span class="co"># vector (the &quot;c-th column)</span>
  myMat[<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;z&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;a&quot;</span>)]  <span class="co"># submatrix (different from Python!)</span>
  myMat[<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),
        <span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>)]   <span class="co"># col-row rearrangement</span></code></pre>
<h2 id="column-and-row-binding"><a href="#column-and-row-binding"><span class="header-section-number">26.11</span> Column and row binding</a></h2>
<p>R has functions that let you aggregate a collection of vectors into a matrix: <code>rbind</code> and <code>cbind</code>. Some simple examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>)  <span class="co"># Play data.</span>
<span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">5</span>, x, x, <span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">5</span>))  <span class="co"># Column binding.</span>
<span class="kw">rbind</span>(<span class="dv">1</span>:<span class="dv">5</span>, x)  <span class="co"># Row binding.</span></code></pre>
<p>As we discussed above, vectors are <strong>not</strong> thought of as columns or rows on their own: they take on these roles inside the “cbind” and “rbind” functions.</p>
<p>Both functions accept an arbitrary number of conforming arguments. Conforming for <code>cbind()</code> means the arguments have equal numbers of rows; for `rbind()’ it means equal numbers of columns. If vector arguments are not conforming, R extends them cyclically or clips them but may give you a warning if the length of the longest argument is not an even multiple of the lengths of the shorter arguments.</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">0</span>)  <span class="co"># second arg has size 1; 3 is an even multiple of 1</span>
<span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">6</span>, <span class="dv">1</span>:<span class="dv">3</span>)  <span class="co"># size 6 is an even multiple of size 3</span>
<span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">2</span>)  <span class="co"># size 3 is not an even multiple of size 2 ==&gt; warning!</span>
myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">11</span>:<span class="dv">14</span>, <span class="dv">2</span>)
myMat
<span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">3</span>, myMat)  <span class="co"># clipping: the matrix arg dictates nrow</span></code></pre>
<p>Generally speaking, it’s a good idea to be explicit and not rely on recycling (cyclic extension) except for the simplest cases such as repeating constants.</p>
<p>Above we’ve seen examples of binding vectors to vectors, and one example of binding a vector to a matrix. You can also bind whole matrices:</p>
<pre class="sourceCode r"><code class="sourceCode r">
myMat1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">11</span>:<span class="dv">13</span>, <span class="dv">21</span>:<span class="dv">23</span>)  <span class="co"># 3x3</span>
myMat1
myMat2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1001</span>:<span class="dv">1003</span>, <span class="dv">2001</span>:<span class="dv">2003</span>)  <span class="co"># 3x2</span>
myMat2
<span class="kw">cbind</span>(myMat1, myMat2)  <span class="co"># 3x5</span></code></pre>
<h2 id="coercion-of-matrices-to-vectors"><a href="#coercion-of-matrices-to-vectors"><span class="header-section-number">26.12</span> Coercion of matrices to vectors</a></h2>
<p>A matrix can always be treated as a vector. The following displays the first five elements of a matrix and does not generate an error message:</p>
<pre class="sourceCode r"><code class="sourceCode r">
myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)
myMat
myMat[<span class="dv">1</span>:<span class="dv">5</span>]</code></pre>
<p>Recall that R stores data in matrices in column-major order.</p>
<h2 id="generating-patterned-matrices"><a href="#generating-patterned-matrices"><span class="header-section-number">26.13</span> Generating patterned matrices</a></h2>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">diag</span>(<span class="dv">5</span>)  ## unit matrix is assumed if row/col not specified
  <span class="kw">diag</span>(<span class="dv">5</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)  ## row/col changes behavior!
  <span class="kw">outer</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">4</span>)  ## products of all combinations of 1st arg and 2nd arg
  <span class="kw">outer</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">FUN=</span>paste)  ## but function doesn&#39;t HAVE to be &quot;multiply&quot;
  x &lt;-<span class="st"> </span><span class="kw">outer</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">4</span>)
  x
  <span class="kw">row</span>(x)  ## a matrix giving just the row numbers of x
  <span class="kw">col</span>(x)  ## a matrix giving just the column numbers of x
  ## why do we care?  we can isolate elements of a matrix with these fns.
  <span class="kw">row</span>(x) &gt;<span class="st"> </span><span class="kw">col</span>(x)  ## isolate sub-diagonal elements
  diagx &lt;-<span class="st"> </span>x[<span class="kw">row</span>(x) ==<span class="st"> </span><span class="kw">col</span>(x)]  ## extract the diagonal elements
  diagx
        </code></pre>
<h1 id="arrays-the-generalization-of-matrices-to-more-than-2-indexes"><a href="#arrays-the-generalization-of-matrices-to-more-than-2-indexes"><span class="header-section-number">27</span> Arrays: the generalization of matrices to more than 2 indexes</a></h1>
<p>Suppose we’re interested in studying rainfall totals for California cities over a period of years. We find a source for the data we want, and it has a table similar to the following for <strong>every</strong> year for the past <code>50</code> years. (Table is abbreviated for simplicity.)</p>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="left">Jan</th>
<th align="left">Feb</th>
<th align="left">Mar</th>
<th align="left">Apr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">eureka</td>
<td align="left">6.50</td>
<td align="left">5.83</td>
<td align="left">5.30</td>
<td align="left">3.32</td>
</tr>
<tr class="even">
<td align="left">sacramento</td>
<td align="left">3.97</td>
<td align="left">3.82</td>
<td align="left">3.02</td>
<td align="left">3.30</td>
</tr>
<tr class="odd">
<td align="left">salinas</td>
<td align="left">3.09</td>
<td align="left">3.08</td>
<td align="left">2.74</td>
<td align="left">1.03</td>
</tr>
<tr class="even">
<td align="left">bakersfield</td>
<td align="left">1.16</td>
<td align="left">1.28</td>
<td align="left">1.21</td>
<td align="left">0.52</td>
</tr>
<tr class="odd">
<td align="left">irvine</td>
<td align="left">2.82</td>
<td align="left">3.50</td>
<td align="left">2.14</td>
<td align="left">0.87</td>
</tr>
<tr class="even">
<td align="left">san_diego</td>
<td align="left">1.98</td>
<td align="left">2.35</td>
<td align="left">1.81</td>
<td align="left">0.78</td>
</tr>
</tbody>
</table>
<p>We recognize that the numbers in one of these tables could be treated as a matrix in R, so we have some hope of analyzing the data. But how do we deal with the fact that we’ve got <em>50</em> such matrices? We can imagine that we have a stack of such matrices, one behind the other. Do we have to duplicate our code fifty times? Nope.</p>
<p>This stack of matrices illustrates the idea behind the <code>array</code> construct in R. An <code>array</code> is like a matrix, but with more dimensions (not limited to just three dimensions, by the way). We could put our matrices into an array and index through the rows, columns, and “planes” systematically, without having to duplicate code.</p>
<p>Here’s a simple example of defining and indexing an array:</p>
<pre class="sourceCode r"><code class="sourceCode r">
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span>:<span class="dv">24</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))  ## 2 rows, 3 columns, 4 planes
a
a[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>]  ## row 1, column 2, plane 1
a[, <span class="dv">2</span>:<span class="dv">3</span>, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]  ## all rows, columns 2 &amp; 3, planes 1 and 4</code></pre>
<h1 id="lists"><a href="#lists"><span class="header-section-number">28</span> Lists</a></h1>
<p>Recall that vectors and matrices can contain only <strong>one</strong> basic data type: all numeric <em>or</em> all logical <em>or</em> all string, etc.</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)  ## all logical
<span class="kw">matrix</span>(<span class="kw">paste</span>(LETTERS, letters)[<span class="dv">1</span>:<span class="dv">25</span>], <span class="dt">nrow =</span> <span class="dv">5</span>)  ## all strings
z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="st">&quot;99&quot;</span>)  ## mix of numeric and string -- not what you expect!
z  ## ALL strings now</code></pre>
<p>It <em>is</em> possible to do calculations with this constraint. <strong>All</strong> of our code and data are stored as binary numbers inside the computer, for example, so we <em>could</em> just code everything numerically.</p>
<p>The obvious downside to doing that is that it’s hard to look at code and remember what the numbers mean (did that <code>17</code> refer to <em>Indiana</em> or <em>Iowa</em>?), and it’s very easy (for most people) to make mistakes without some kind of a hint as to the meaning of the numbers.</p>
<p>Lists are data structures without the restriction to one type of data. Lists are sequences of anything. They can contain: basic data types, vectors, matrices, arrays, lists (recursion), … . In particular, they can contain arbitrarily nested lists of lists.</p>
<p>Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  z &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="st">&quot;99&quot;</span>)  ## mix of numeric and string --  OK now.
  z

  <span class="co"># the kitchen sink</span>

  <span class="kw">list</span>(<span class="dv">1</span>,
       <span class="st">&quot;1&quot;</span>,
       <span class="ot">TRUE</span>, <span class="ot">FALSE</span>,
       <span class="fl">1E100</span>,
       <span class="ot">NA</span>, -<span class="ot">Inf</span>, <span class="ot">NULL</span>,
       <span class="dv">1</span>:<span class="dv">5</span>,
       letters[<span class="dv">2</span>:<span class="dv">5</span>],
       <span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">&quot;a&quot;</span>)
       )


  <span class="co"># Balanced binary tree:</span>
  <span class="kw">list</span>(
        <span class="kw">list</span>(<span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">2</span>),<span class="kw">list</span>(<span class="dv">3</span>, <span class="dv">4</span>)),
        <span class="kw">list</span>(<span class="kw">list</span>(<span class="dv">5</span>, <span class="dv">6</span>),<span class="kw">list</span>(<span class="dv">7</span>, <span class="dv">8</span>))
      )  

  <span class="co"># a list containing a matrix; also, elements are given names</span>
  myList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">vec=</span><span class="dv">1</span>:<span class="dv">3</span>,
                 <span class="dt">mat=</span><span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">3</span>:<span class="dv">4</span>),
                 <span class="dt">flags=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),
                 <span class="dt">lst=</span><span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">1</span>:<span class="dv">4</span>)
                )
  myList

  <span class="co"># Component names are optional.  They can be glued on by force:</span>
  x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>, <span class="st">&quot;a&quot;</span>, <span class="ot">TRUE</span>, <span class="ot">NULL</span>)
  <span class="kw">names</span>(x) &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span>:<span class="dv">4</span>]
  x</code></pre>
<p>Note the relative complexity in the output when lists are printed. The flexibility comes at a price. Here’s a very simple example showing a list with and without names:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">list</span>(<span class="dv">1</span>, <span class="ot">TRUE</span>)
<span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="ot">TRUE</span>)</code></pre>
<h2 id="access-to-list-items"><a href="#access-to-list-items"><span class="header-section-number">28.1</span> Access to list items</a></h2>
<p>Access to <em>list items</em> is by index with “[[…]]”, or by “$name” if names exist:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">vec=</span><span class="dv">1</span>:<span class="dv">3</span>,
                 <span class="dt">mat=</span><span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">3</span>:<span class="dv">4</span>),
                 <span class="dt">flags=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),
                 <span class="dt">lst=</span><span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">1</span>:<span class="dv">4</span>)
                )
  myList[[<span class="dv">2</span>]]
  myList$mat
  myList[[<span class="st">&quot;mat&quot;</span>]]</code></pre>
<p>Note that the standard indexing, “[…]”, <em>does</em> “work”, but it may not give what you want:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">vec=</span><span class="dv">1</span>:<span class="dv">3</span>,
                 <span class="dt">mat=</span><span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">3</span>:<span class="dv">4</span>),
                 <span class="dt">flags=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),
                 <span class="dt">lst=</span><span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">1</span>:<span class="dv">4</span>)
                )
  myList[<span class="dv">1</span>]
  myList[<span class="st">&quot;mat&quot;</span>]

  <span class="kw">str</span>(myList[<span class="st">&quot;vec&quot;</span>])
  <span class="kw">str</span>(myList[[<span class="st">&quot;vec&quot;</span>]])</code></pre>
<p>You might think of the “[…]” as returning a “box of stuff”. The double bracket, “[[…]]” tells R to “look inside the box”. In the example above you can see that <code>myList[&quot;vec&quot;]</code> is still a list, while <code>myList[[&quot;vec&quot;]]</code> is the contents of that list.</p>
<h2 id="access-to-sublists"><a href="#access-to-sublists"><span class="header-section-number">28.2</span> Access to sublists</a></h2>
<p>A list is really a generalized form of vector, and, as such, the indexing techniques used for vectors can also be applied to lists, keeping in mind the distinction between “box” and “stuff in the box” mentioned above. Here are some more examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">vec=</span><span class="dv">1</span>:<span class="dv">3</span>,
                 <span class="dt">mat=</span><span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">3</span>:<span class="dv">4</span>),
                 <span class="dt">flags=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),
                 <span class="dt">lst=</span><span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">1</span>:<span class="dv">4</span>)
                )

  myList[<span class="dv">2</span>:<span class="dv">3</span>]                           <span class="co"># Sublist of length 2.</span>
  myList[<span class="dv">2</span>]                             <span class="co"># Sublist of length 1.</span>
  myList[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>)]     <span class="co"># Out-of-order and expansion.</span>
  myList[<span class="kw">c</span>(<span class="st">&quot;lst&quot;</span>, <span class="st">&quot;mat&quot;</span>, <span class="st">&quot;vec&quot;</span>, <span class="st">&quot;mat&quot;</span>)] <span class="co"># Named access.</span>
  myList[<span class="st">&quot;vec&quot;</span>]                         <span class="co"># Sublist of length 1.</span>
  myList[[<span class="st">&quot;vec&quot;</span>]]                       <span class="co"># Vector!!!</span>
  myList[<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)]   <span class="co"># Logical selection</span></code></pre>
<h2 id="sublists-are-still-lists"><a href="#sublists-are-still-lists"><span class="header-section-number">28.3</span> Sublists are still lists</a></h2>
<p>If you use indexing to pick off a sublist from a list, you still have to use the list indexing described above to drill down to the contents of the sublist. Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">vec=</span><span class="dv">1</span>:<span class="dv">3</span>,
                 <span class="dt">mat=</span><span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">3</span>:<span class="dv">4</span>),
                 <span class="dt">flags=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),
                 <span class="dt">lst=</span><span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">1</span>:<span class="dv">4</span>)
                )
  myList[<span class="dv">2</span>:<span class="dv">3</span>]        ## sublist with two items: $mat, $flags
  myList[<span class="dv">2</span>:<span class="dv">3</span>][[<span class="dv">1</span>]]   ## the content of the first item in the sublist
  myList[<span class="dv">2</span>:<span class="dv">3</span>]$mat    ## ditto
  myList[<span class="dv">2</span>]          ## a list of length 1: $mat
  myList[<span class="dv">2</span>][[<span class="dv">1</span>]]     ## the contents of the $mat element
  myList[<span class="dv">2</span>]$mat      ## ditto</code></pre>
<h1 id="dataframes"><a href="#dataframes"><span class="header-section-number">29</span> Dataframes</a></h1>
<h2 id="background"><a href="#background"><span class="header-section-number">29.1</span> Background</a></h2>
<p>In statistics we often encounter studies that include sets of data in the form of rectangular tables, with each row of the table representing a set of observations for one person or thing (the “case”) and each column representing a set of measured or observed values for the variables in the study.</p>
<p>Here’s a snippet of such a table that illustrates the idea:</p>
<pre><code>
    Observation    Sex    BMI            Age    DGEstimate    DGDifference
          1       Female  underweight     78        44             -34    
          2       Male    normal          44        32             -12    
          3       Male    overweight      72        32             -40    
          4       Male    overweight      59        44             -15    
          5       Male    normal          60        32             -28    
          6       Male    underweight     34        25              -9    
         13       Female  overweight      52        44              -8    
         14       Male    normal          67        44             -23    
         16       Male    normal          68        50             -18    
         17       Female  overweight      35        12             -23    
</code></pre>
<p>Note some of the features of the table:</p>
<ul>
<li>There is a <em>header</em> line, identifying the variables. This is optional but useful.</li>
<li>The variables for a given observation (row) are of different data types: integer, string, numeric (could also be logical).</li>
</ul>
<p>As we discussed previously, all of this information <strong>could</strong> be encoded numerically. For instance we might have:</p>
<ul>
<li>Sex
<ul>
<li>Male –&gt; 0</li>
<li>Female –&gt; 1</li>
</ul></li>
<li>BMI
<ul>
<li>underweight –&gt; 0</li>
<li>normal –&gt; 1</li>
<li>overweight –&gt; 2</li>
</ul></li>
</ul>
<p>Then our table would look like:</p>
<pre><code>
    Observation  Sex  BMI   Age    DGEstimate    DGDifference
          1       1    0     78        44             -34    
          2       0    1     44        32             -12    
          3       0    2     72        32             -40    
    .
    .
    .
</code></pre>
<p>This is a very <code>1960's</code> approach and would almost certainly lead to errors in entering and interpreting the data.</p>
<p>Thus, we seem to have a dilemma: use an all-numeric approach, in which case our data could be encoded in a matrix, or use the appropriate combination of numeric and non-numeric data for clarity, in which case we could analyze it using – what???</p>
<p>The answer is to use a <em>dataframe</em>, which is an R structure that <em>looks</em> something like a matrix, but with the flexibility to have different data types in different columns. The columns are actually stored as lists.</p>
<h2 id="making-a-data-frame-by-hand"><a href="#making-a-data-frame-by-hand"><span class="header-section-number">29.2</span> Making a data frame “by hand”</a></h2>
<p>The function “data.frame()” can bundle conforming vectors, matrices, other dataframes into a single dataframe:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myFrame &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">someNumbers=</span><span class="dv">1</span>:<span class="dv">3</span>,
                        <span class="dt">someCharacters=</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),
                        <span class="dt">someLogicals=</span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>))

  myFrame</code></pre>
<p>Here are a couple of auxiliary functions for dataframes:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myFrame &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">someNumbers=</span><span class="dv">1</span>:<span class="dv">3</span>,
                        <span class="dt">someCharacters=</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),
                        <span class="dt">someLogicals=</span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>))

  <span class="kw">is.data.frame</span>(myFrame)               <span class="co"># Checking type.</span>
  someMatrix &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">11</span>:<span class="dv">14</span>)
  someDF &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(someMatrix)  <span class="co"># Coercing a matrix to a dataframe.</span>

  someMatrix
  <span class="kw">str</span>(someMatrix)
  someDF
  <span class="kw">str</span>(someDF)</code></pre>
<h2 id="operations-on-dataframes"><a href="#operations-on-dataframes"><span class="header-section-number">29.3</span> Operations on dataframes</a></h2>
<p>Many of the operations we’ve discussed above for matrices carry over to dataframes:</p>
<pre class="sourceCode r"><code class="sourceCode r">

  newFrame &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">someNumbers=</span><span class="dv">1</span>:<span class="dv">3</span>,
                        <span class="dt">someCharacters=</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),
                        <span class="dt">someLogicals=</span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>),
                        <span class="dt">someMoreNumbers=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>)
                       )

  <span class="kw">dim</span>(newFrame)
  <span class="kw">nrow</span>(newFrame)
  <span class="kw">ncol</span>(newFrame)
  <span class="kw">rownames</span>(newFrame)
  <span class="kw">colnames</span>(newFrame)
  <span class="kw">length</span>(newFrame)   <span class="co"># NOT equal to the number of rows!</span>
  newFrame[ , <span class="dv">3</span>]     <span class="co"># Col 3 coerced to vector.</span>
  newFrame[<span class="dv">2</span>, ]      <span class="co"># Sub-dataframe with row 2, NOT coerced to vector!</span>
  <span class="kw">str</span>(newFrame[<span class="dv">2</span>, ])
  newFrame[ , <span class="dv">2</span>:<span class="dv">3</span>]   <span class="co"># Sub-dataframe consisting of cols 2 and 3.</span>
  newFrame[<span class="dv">2</span>:<span class="dv">3</span>, ]    <span class="co"># Sub-dataframe consisting of rows 2 and 3.</span></code></pre>
<p>Why is <code>newFrame[2, ]</code> not coerced to a vector? Because the items in the different columns in row <code>2</code> might in general not all be of the same data type (and in fact in this case they are <em>not</em> of the same data type).</p>
<h2 id="it-sometimes-looks-like-a-matrix-but-it-isnt"><a href="#it-sometimes-looks-like-a-matrix-but-it-isnt"><span class="header-section-number">29.4</span> It sometimes looks like a matrix, but it isn’t</a></h2>
<p>We haven’t discussed matrix multiplication yet, and we likely won’t use it in this course, but it <em>is</em> possible to do linear-algebra-style matrix multiplication in R:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  aMat &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, -<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, -<span class="dv">1</span>))
  aMat
  bMat &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">0</span>, -<span class="dv">2</span>, <span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">3</span>, -<span class="dv">1</span>, <span class="dv">4</span>)) ## could also have used rbind
  bMat

  aMat %*%<span class="st"> </span>bMat

  aFrame &lt;-<span class="st"> </span><span class="kw">data.frame</span>(aMat)  ## coerce aMat to a dataframe
  aFrame           ## LOOKS like aMat, but...
  aFrame %*%<span class="st"> </span>bMat  ## generates an error: a data frame is not a matrix</code></pre>
<h2 id="making-a-dataframe-from-other-data-sources"><a href="#making-a-dataframe-from-other-data-sources"><span class="header-section-number">29.5</span> Making a dataframe from other data sources</a></h2>
<p>The function <code>read.table()</code> will read a table from a text file into a dataframe. Here’s a simple example. First, here are the contents of a file, <code>atable.dat</code> as seen by the file system outside of R:</p>
<pre><code>  $ cat atable.dat ## &quot;cat&quot; is used to display the contents of a file
    Id Age  Weight Height  Gender Smoker
    3  18    150     65    Female  FALSE
    1  21    160     68     Male   TRUE
    4  45    180     65     Male   FALSE
    5  54    205     69     Male   FALSE

</code></pre>
<p>Now we read the contents of that file into R. It winds up looking pretty much the same:</p>
<pre class="sourceCode r"><code class="sourceCode r">
myTable &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;atable.dat&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
myTable</code></pre>
<p>We had to use <code>header=TRUE</code> so that R wouldn’t consider the strings “Id”, “Age”, etc., as part of the data.</p>
<p>There are <em>many</em> optional arguments to <code>read.table()</code>, and there are also a number of related functions, the most common of which is <code>read.csv</code> for reading a table (typically) exported from a spreadsheet. See the help page for <code>read.table</code> for details. Here’s an excerpt:</p>
<pre><code>
  read.table(file, header = FALSE, sep = &quot;&quot;, quote = &quot;\&quot;&#39;&quot;, dec = &quot;.&quot;,
             row.names, col.names, as.is = FALSE, na.strings = &quot;NA&quot;,
             colClasses = NA, nrows = -1,
             skip = 0, check.names = TRUE, fill = !blank.lines.skip,
             strip.white = FALSE, blank.lines.skip = TRUE,
             comment.char = &quot;#&quot;)
</code></pre>
<p>Note that the first argument to <code>read.table()</code>, the <em>file</em> argument, can actually be any of the things that are called <em>connections</em> in R, the most-common example of which is a URL. (I.e., you can read data directly from the web.) Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myNewTable &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://lib.stat.cmu.edu/jcgs/tu&quot;</span>,
                           <span class="dt">skip=</span><span class="dv">4</span>,
                           <span class="dt">header=</span><span class="ot">TRUE</span>)
  <span class="kw">head</span>(myNewTable)  ## show just the first few rows of the dataframe
  <span class="kw">str</span>(myNewTable)</code></pre>
<h1 id="flow-control-conditionals-and-loops"><a href="#flow-control-conditionals-and-loops"><span class="header-section-number">30</span> Flow control: conditionals and loops</a></h1>
<p>R has the kinds of conditional and looping statements that you would expect to find in a “C-like” language, along with some you might not expect. R also has a family of functions (the “apply” family – see below) that (a) are in most cases better to use for looping than the “C-like” constructs and (b) are similar in spirit to the “transform” function, for instance, in the C++ standard library.</p>
<p><strong>Note</strong>: you don’t have to know anything about C or C++ to understand and use these features of R.</p>
<h2 id="making-decisions-the-if-statement"><a href="#making-decisions-the-if-statement"><span class="header-section-number">30.1</span> Making decisions: the <code>if</code> statement</a></h2>
<p>You use the <code>if</code> statement as follows:</p>
<pre><code>
  if (condition is true)
     do something
</code></pre>
<p>In the pseudo-code above, the “do something” part can be either a single statement or a compound statement (multiple single statements enclosed in curly braces <code>{...}</code>).</p>
<p>The form of the statement above implicitly says that if the <code>condition</code> is <em>not</em> true, then never mind – just continue what you were doing. Don’t interrupt the flow of the program.</p>
<p>It’s typically the case that you check to see if <code>condition</code> is true, and if it’s <em>not</em>, you still do want to interrupt the flow of the program and do something <em>else</em>. R provides the <code>else</code> clause for this purpose.</p>
<p>Some examples may clarify:</p>
<pre class="sourceCode r"><code class="sourceCode r">
mVec &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">12</span>  <span class="co"># play data</span>

if (<span class="kw">length</span>(mVec) &gt;<span class="st"> </span><span class="dv">15</span>) <span class="kw">print</span>(<span class="st">&quot;mVec is longer than 15&quot;</span>)  ## nothing printed

if (<span class="kw">length</span>(mVec) &gt;<span class="st"> </span><span class="dv">10</span>) {
    <span class="kw">print</span>(<span class="st">&quot;mVec is longer than 10&quot;</span>)
    mVec2 &lt;-<span class="st"> </span>mVec *<span class="st"> </span><span class="dv">2</span>  ## just doing some other stuff inside the {...}
    <span class="kw">print</span>(mVec2)
} else {
    <span class="kw">print</span>(<span class="st">&quot;length of mVec &lt;= 10&quot;</span>)
    mVec4 &lt;-<span class="st"> </span>mVec *<span class="st"> </span><span class="dv">4</span>  ## again, just to show other stuff can be done
    <span class="kw">print</span>(mVec4)
}</code></pre>
<p>A couple of comments:</p>
<ol style="list-style-type: decimal">
<li><p>The use of the <code>print</code> function is optional in interactive use. It never <em>hurts</em> to use it, but it’s <em>required</em> for non-interactive use (running in “batch” mode, for instance).</p></li>
<li><p>There is some latitude in the placement of the curly braces. It is to some degree just a matter of the style you prefer. But if you don’t put the <code>{</code> on the same line as the <code>else</code>, R will sometimes get “confused”. So:</p></li>
</ol>
<pre><code>
  } else {   ## good
  ...
  }

  } else  ## bad
  { ...
  }
</code></pre>
<h2 id="something-a-little-different-the-ifelse-function"><a href="#something-a-little-different-the-ifelse-function"><span class="header-section-number">30.2</span> Something a little different: the <code>ifelse</code> function</a></h2>
<p>We’ve been talking about <code>if</code> and <code>else</code> clauses in R. These are flow-control constructs. R also has <em>function</em> called <code>ifelse()</code> that is really a combination of looping and conditional statements rolled into one.</p>
<p>And like many other functions in R, <code>ifelse()</code> is <em>vectorized</em>, meaning it can operate on all elements of a vector “at once” (at least from the perspective of the programmer – the code may or may not run all at the same time on the actual hardware).</p>
<p>Here’s are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ifelse</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="kw">c</span>(-<span class="dv">1</span>, -<span class="dv">2</span>, -<span class="dv">3</span>))  <span class="co"># c(1, -2, 3)</span>

multipliers &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">4</span>)/<span class="dv">2</span>
pies &lt;-<span class="st"> </span>pi *<span class="st"> </span>multipliers
pies
<span class="kw">sin</span>(pies)
<span class="kw">ifelse</span>(<span class="kw">sin</span>(pies) &gt;=<span class="st"> </span><span class="dv">0</span>, <span class="kw">rep</span>(<span class="st">&quot;positive&quot;</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="st">&quot;negative&quot;</span>, <span class="dv">4</span>))</code></pre>
<p>The <code>ifelse()</code> function processes the three arguments in parallel. If an element in the <em>first</em> argument is <code>TRUE</code> (or is some expression that <em>evaluates</em> to <code>TRUE</code>) the result returned from the function will be the corresponding item in the <em>second</em> argument. If an element of the <em>first</em> argument evaluates to <code>FALSE</code>, the result returned will be the corresponding item in the <em>third</em> argument.</p>
<p>What happens if the second and third arguments to <code>ifelse()</code> are not “conforming”, i.e., don’t have the same number of elements as the first argument? R will “recycle” the elements (extend them cyclically) until there <em>are</em> enough of them:</p>
<pre class="sourceCode r"><code class="sourceCode r">
## simulate some coin tosses
tosses &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)  ## much more on this later in the course
tosses
<span class="kw">ifelse</span>(tosses &gt;<span class="st"> </span><span class="fl">0.5</span>, <span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>)  ## recycle to 10 Heads, 10 Tails</code></pre>
<h2 id="the-for-loop"><a href="#the-for-loop"><span class="header-section-number">30.3</span> The <code>for</code> loop</a></h2>
<p>The <code>for</code> loop executes a statement, usually a compound (<code>{...}</code>) statement, once for every item in a given vector. It has the general form:</p>
<pre><code>
  for (dummyName in someExpression) someOtherExpression
</code></pre>
<p>The <code>dummyName</code> is assigned, in turn, each of the values in <code>someExpression</code>, and <code>dummyName</code> can then be used in calculations in <code>someOtherExpression</code>. Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  for (nextNum in <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)) {
      nextProduct &lt;-<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>nextNum
      <span class="kw">print</span>(nextProduct)
  }</code></pre>
<p>Note that the braces are optional if there is only one statement in the loop, but it’s probably a good idea to use them in all cases.</p>
<p>Note also the following warning from the Introduction to R manual on the R Project web site (</p>
<p>http://cran.r-project.org/doc/manuals/R-intro.html#Repetitive-execution</p>
<p>)</p>
<p><strong>Warning</strong>: for() loops are used in R code much less often than in compiled languages. Code that takes a “whole object” view is likely to be both clearer and faster in R.</p>
<p>This is discussed in more detail below.</p>
<h2 id="the-while-loop"><a href="#the-while-loop"><span class="header-section-number">30.4</span> The <code>while</code> loop</a></h2>
<p>The <code>while</code> loop is a first cousin to the <code>for</code> loop (and one can be formulated in terms of the other). The general syntax is:</p>
<pre><code>
  while (someExpressionEvaluatesToTRUE) someOtherExpression
</code></pre>
<p>Here’s an example in which we pick a random number between 0 and 1 and stop when the number is sufficiently large:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  howMany &lt;-<span class="st"> </span><span class="dv">0</span>  ## count how many samples it takes
  while(<span class="kw">runif</span>(<span class="dv">1</span>) &lt;<span class="st"> </span><span class="fl">0.95</span>) {
      <span class="kw">print</span>(<span class="st">&quot;Not yet...&quot;</span>)
      howMany &lt;-<span class="st"> </span>howMany +<span class="st"> </span><span class="dv">1</span>
  }

  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;It took&quot;</span>, howMany, <span class="st">&quot;samples.&quot;</span>))</code></pre>
<p><em>Note</em>: the <code>paste</code> function in the example above does just what the name implies: it “pastes” together a bunch of strings, converting the arguments to strings in the process as necessary (e.g., converting the <code>howMany</code> numeric to a string in the above). Using <code>paste</code> is a simple way to format your output.</p>
<h2 id="the-next-and-break-commands"><a href="#the-next-and-break-commands"><span class="header-section-number">30.5</span> The <code>next</code> and <code>break</code> commands</a></h2>
<p>If you <em>do</em> find that you have to use explicit loops (<code>for</code> or <code>while</code>) in R, you may also find that you need to alter the program flow, based on some computed condition. R has a number of constructs to do this, the most common of which are <code>next</code> and <code>break</code>.</p>
<p>The <code>next</code> command tells R to proceed with the next step in the iteration, if there is one. Here’s an example in which we want to print out only the odd numbers in a sequence:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  for (aNum in <span class="dv">1</span>:<span class="dv">20</span>) {
      if ((aNum %%<span class="st"> </span><span class="dv">2</span>) ==<span class="st"> </span><span class="dv">0</span>) next
      <span class="kw">print</span>(aNum)
  }</code></pre>
<p>Of course we could have done the same thing in numerous other ways, but this illustrates the idea: if the number is even, just go on to the next number in the <code>aNum</code> vector.</p>
<h2 id="the-repeat-loop"><a href="#the-repeat-loop"><span class="header-section-number">30.6</span> The <code>repeat</code> loop</a></h2>
<p>The <code>repeat</code> loop will just go on forever unless it contains some code to break out of the loop. Here’s a toy example, just to illustrate the concept:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  nextNum &lt;-<span class="st"> </span><span class="dv">0</span>
  repeat { 
    nextNum &lt;-<span class="st"> </span>nextNum +<span class="st"> </span><span class="dv">1</span>
    <span class="kw">print</span>(nextNum)
    if(nextNum &gt;<span class="st"> </span><span class="dv">20</span>) break() 
  }</code></pre>
<p>A more-realistic example might be to implement an interactive dialog with a user of your program, asking for input from the user, checking the input for validity, and breaking out of the loop only when the input is valid. Here’s some pseudo-code:</p>
<pre><code>
  repeat {
    Ask user for some input
    if (input is valid) break()  ## if it is NOT, just keep bugging the user!
  }
  go on to process the now-valid input
</code></pre>
<p>As usual, this kind of loop could be implemented in various other ways.</p>
<h1 id="writing-functions"><a href="#writing-functions"><span class="header-section-number">31</span> Writing functions</a></h1>
<p>We’ve already had one <em>ad hoc</em> example of defining and using your own function in R (the <code>zFn</code> example above). Now we want to explore the topic systematically.</p>
<h2 id="syntax-1"><a href="#syntax-1"><span class="header-section-number">31.1</span> Syntax</a></h2>
<p>Here’s a simple example showing the <em>syntax</em> (“grammar”) of some functions:</p>
<pre class="sourceCode r"><code class="sourceCode r">
myFn1 &lt;-<span class="st"> </span>function(x) {
    <span class="kw">plot</span>(x)
}
myFn2 &lt;-<span class="st"> </span>function(x) {
    <span class="dv">2</span> *<span class="st"> </span>x
}</code></pre>
<p>That is, you define a function by using the <code>function</code> keyword, followed by <em>mandatory</em> parentheses <code>(  )</code>, optionally containing the parameter or parameters to be sent to the function when it is later executed. Next comes the <code>body</code> of the function: a statement or statements in which you tell the function what you want it to do. Finally, you assign your function definition to a variable (<code>myFn1</code>, <code>myFn2</code>).</p>
<p><strong>Notes</strong></p>
<ul>
<li><p>The “Fn” part of the variable name has no particular meaning to R. We’re using it here just to help <em>us</em> remember that the thing is a function and not, say, a vector or a list. “elephant” or “socrates” or “Lord.Vader” would all be perfectly acceptable (to R) function names.</p></li>
<li><p>In our examples we routinely include a single argument <code>x</code> in our function definitions: <code>function(x)</code>. This is just to simplify the examples. Your functions can have as many arguments as you like:</p>
<ul>
<li>myFn &lt;- function() { } ## zero arguments; parens STILL required</li>
<li>myFn &lt;- function(zebra) { } ## one argument (named “zebra” here)</li>
<li>myFN &lt;- function(dorothy, toto) ## two arguments</li>
<li>myFn &lt;- function(alpha, beta, gamma) ## three arguments</li>
<li>myFn &lt;- function(math, physics, …) ## 2 + an unspecified number</li>
</ul></li>
</ul>
<h2 id="semantics-1"><a href="#semantics-1"><span class="header-section-number">31.2</span> Semantics</a></h2>
<p>Here are some words about <em>semantics</em>, that is, the <em>meaning</em> of function statements (as opposed to <em>syntax</em>, the <em>structure</em> of function statements).</p>
<p>Note that <code>myFn1</code> <em>does</em> return a value (see below), but its real mission in life is to create a so-called “side effect”, namely (in this case), a picture (plot) of the stuff you give it when you call the function. On the other hand, <code>myFn2</code> has no side effects, and it does return a <em>meaningful</em> value:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myFn1 &lt;-<span class="st"> </span>function(x) {
      <span class="kw">plot</span>(x)
  }
  myFn2 &lt;-<span class="st"> </span>function(x) {
      <span class="dv">2</span>*x
  }

  <span class="kw">myFn1</span>(<span class="dv">1</span>:<span class="dv">10</span>)  <span class="co"># plots 1, 2, ..., 10</span>
  <span class="kw">myFn2</span>(<span class="dv">1</span>:<span class="dv">10</span>)  <span class="co"># returns the vector containing 2, 4, ..., 20</span></code></pre>
<h2 id="more-semantics"><a href="#more-semantics"><span class="header-section-number">31.3</span> More semantics</a></h2>
<p>A little more about semantics: functions are <em>first class citizens</em>, that is, they can be assigned, printed, passed as arguments, etc. Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myFn1 &lt;-<span class="st"> </span>function(x) {
      <span class="kw">plot</span>(x)
  }
  myFn2 &lt;-<span class="st"> </span>function(x) {
      <span class="dv">2</span>*x
  }

  myFn2            <span class="co"># Print the function.</span>
  <span class="kw">print</span>(myFn2)     <span class="co"># Same.</span>
  myFunx &lt;-<span class="st"> </span>myFn2;
  <span class="kw">myFunx</span>(<span class="dv">1</span>:<span class="dv">5</span>)  <span class="co"># Application:   len &lt;- length;  len(1:10)</span>
  (function(x) {
    <span class="dv">2</span>*x
  })(<span class="dv">1</span>:<span class="dv">10</span>)   <span class="co"># define and call the function &quot;simultaneously&quot;</span>
  printFn &lt;-<span class="st"> </span>function(f) <span class="kw">print</span>(f)
  <span class="kw">printFn</span>(<span class="dv">1</span>:<span class="dv">5</span>) <span class="co"># &quot;ordinary&quot; (integer) argument</span>
  <span class="kw">printFn</span>(printFn)  <span class="co"># a *function* argument to a function.  (prints itself!)</span></code></pre>
<h2 id="return-values"><a href="#return-values"><span class="header-section-number">31.4</span> Return values</a></h2>
<p>A function returns a value. Sometimes that’s interesting, sometimes not:</p>
<pre class="sourceCode r"><code class="sourceCode r">
myFn1 &lt;-<span class="st"> </span>function(x) {
    <span class="kw">plot</span>(x)
}
myFn2 &lt;-<span class="st"> </span>function(x) {
    <span class="dv">2</span> *<span class="st"> </span>x
}

x &lt;-<span class="st"> </span><span class="kw">myFn2</span>(<span class="dv">1</span>:<span class="dv">10</span>)  ## myFn2 returns a value we probably want to keep
x
x &lt;-<span class="st"> </span><span class="kw">myFn1</span>(<span class="dv">1</span>:<span class="dv">10</span>)  ## myFn1 returns a NULL, but it DOES plot (side effect).
x</code></pre>
<h2 id="syntax-and-return-values"><a href="#syntax-and-return-values"><span class="header-section-number">31.5</span> Syntax <em>and</em> return values</a></h2>
<p>And now here are a few more words about syntax. All of the following are equivalent ways of writing <code>myFn2()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">
    myFn2 &lt;-<span class="st"> </span>function(x) {
        <span class="dv">2</span>*x
    }   <span class="co"># The original.</span>

    myFn2 &lt;-<span class="st"> </span>function(x) <span class="dv">2</span>*x       <span class="co"># Single-statement bodies don&#39;t need braces.</span>

    myFn2 &lt;-<span class="st"> </span>function(x) {
        <span class="kw">return</span>(<span class="dv">2</span>*x)
    }   <span class="co"># Make the return explicit.</span>

    myFn2 &lt;-<span class="st"> </span>function(x) {
        y &lt;-<span class="st"> </span><span class="dv">2</span>*x
        y
    }  <span class="co"># Value of last statement is returned.</span>

    myFn2 &lt;-<span class="st"> </span>function(x) {
        y &lt;-<span class="st"> </span><span class="dv">2</span>*x
        <span class="kw">return</span>(y)
    }  </code></pre>
<p>It’s worth emphasizing that the value of the <em>last</em> statement in a function will <em>automatically</em> be returned. In most cases R programmers will omit the explicit <code>return</code> statement, but using <code>return</code> can sometimes help to clarify.</p>
<h2 id="a-realistic-example"><a href="#a-realistic-example"><span class="header-section-number">31.6</span> A realistic example</a></h2>
<p>Here’s an example of defining and using a function with multiple arguments and multi-statement bodies:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myFn3 &lt;-<span class="st"> </span>function(x, y) {
      <span class="kw">pdf</span>(<span class="dt">file=</span><span class="st">&quot;test.pdf&quot;</span>, <span class="dt">width=</span><span class="dv">5</span>, <span class="dt">height=</span><span class="dv">5</span>)  ## make a plot in a PDF file
      <span class="kw">par</span>(<span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">1.8</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))  ## set some graphics params
      <span class="kw">plot</span>(x, y, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.5</span>)
      <span class="kw">dev.off</span>()  ## close the newly-created PDF file
  }
  <span class="kw">myFn3</span>(<span class="dv">1</span>:<span class="dv">100</span>, <span class="kw">rnorm</span>(<span class="dv">100</span>))  ## send some data to be plotted</code></pre>
<p>The details of the above example are not important at this point, but you can see:</p>
<ul>
<li>The function has multiple (two) arguments</li>
<li>The function has multiple statements in the body of the function (technically just a single compound statement)</li>
<li>If you run the code, you should get a file “test.pdf” with a picture in it</li>
</ul>
<h2 id="arguments-to-functions"><a href="#arguments-to-functions"><span class="header-section-number">31.7</span> Arguments to functions</a></h2>
<p>Ordinarily, for functions with multiple arguments, the formal arguments (the ones in the <em>definition</em> of the function) get assigned the actual arguments (the ones in the <em>calling</em> of the function) in order. But if a function is called with <em>named</em> arguments, the arguments can appear in any order. (There is no great advantage to this for functions with short argument lists, but it can be useful in more-complicated cases, especially in conjunction with default values for arguments – see below.) Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myArgsFn &lt;-<span class="st"> </span>function(x, y) {
      <span class="kw">par</span>(<span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">1.8</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))  ## set some graphics params
      <span class="kw">plot</span>(x, y, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.5</span>)
  }

  <span class="kw">myArgsFn</span>(<span class="dv">1</span>:<span class="dv">10</span>, (<span class="dv">1</span>:<span class="dv">10</span>)^<span class="dv">2</span>) ## x gets 1:10, y gets (1:10)^2 

  <span class="kw">myArgsFn</span>(<span class="dt">y=</span>(<span class="dv">1</span>:<span class="dv">5</span>)^<span class="dv">3</span>, <span class="dt">x=</span><span class="dv">1</span>:<span class="dv">5</span>) ## x gets 1:5, y gets (1:5)^3 </code></pre>
<p>It’s possible to define <em>default</em> values for arguments when you define a function. That is, if a given argument has a default value in the definition of a function, and you <em>omit</em> that argument when you call the function, the argument takes on the default value for the duration of the function.</p>
<p>Note that doing this makes it imperative that you name the arguments that you <em>do</em> include when you call the function. Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myFn4 &lt;-<span class="st"> </span>function(<span class="dt">y=</span><span class="kw">rnorm</span>(<span class="dv">20</span>),
                    <span class="dt">x=</span><span class="dv">1</span>:<span class="kw">length</span>(y),
                    <span class="dt">cex=</span><span class="fl">0.5</span>,
                    <span class="dt">pch=</span><span class="dv">16</span>,
                    <span class="dt">w=</span><span class="dv">5</span>,
                    <span class="dt">h=</span><span class="dv">5</span>,
                    <span class="dt">new=</span><span class="ot">TRUE</span>) {

    if(new) <span class="kw">pdf</span>(<span class="dt">file=</span><span class="st">&quot;newtest.pdf&quot;</span>, <span class="dt">width=</span>w, <span class="dt">height=</span>h)
    <span class="kw">par</span>(<span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">1.8</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))
    <span class="kw">plot</span>(x, y, <span class="dt">pch=</span>pch, <span class="dt">cex=</span>cex)  ## &quot;cex&quot; in &quot;plot&quot; gets value of input &quot;cex&quot;
    if(new) <span class="kw">dev.off</span>()
  }                     
  <span class="kw">myFn4</span>()   <span class="co"># All arguments defaulted.  PDF file created.</span>
  <span class="kw">myFn4</span>(<span class="dv">1</span>:<span class="dv">25</span>, <span class="kw">rnorm</span>(<span class="dv">25</span>))  <span class="co"># 1st and 2nd argument passed by order.</span>
  <span class="kw">myFn4</span>(<span class="dv">1</span>:<span class="dv">25</span>, <span class="kw">rnorm</span>(<span class="dv">25</span>), <span class="dt">new=</span><span class="ot">FALSE</span>)  <span class="co"># Last argument is 7th by order, so needs name.</span>
  <span class="kw">myFn4</span>(<span class="dv">1</span>:<span class="dv">25</span>, <span class="kw">rnorm</span>(<span class="dv">25</span>), <span class="dt">new=</span><span class="ot">FALSE</span>, <span class="dt">cex=</span><span class="fl">0.2</span>) <span class="co"># cex is out-of-order</span>
  <span class="kw">myFn4</span>(<span class="dv">1</span>:<span class="dv">25</span>, <span class="kw">rnorm</span>(<span class="dv">25</span>), <span class="dt">new=</span><span class="ot">FALSE</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">pch=</span><span class="dv">3</span>)
  <span class="kw">myFn4</span>(<span class="dt">x=</span><span class="dv">1</span>:<span class="dv">25</span>, <span class="dt">y=</span><span class="kw">rnorm</span>(<span class="dv">25</span>), <span class="dt">pch=</span><span class="dv">2</span>, <span class="dt">w=</span><span class="dv">10</span>, <span class="dt">h=</span><span class="dv">2</span>) <span class="co"># x= and y= not needed but more readable</span>
  <span class="kw">myFn4</span>(<span class="dt">cex=</span><span class="fl">0.2</span>)
  </code></pre>
<p>Notes:</p>
<ul>
<li>The details of the plotting, etc., are unimportant at this point. Just focus on the handling of the arguments.</li>
<li>Note that “downstream” arguments can make use of the “upstream” arguments. In the example above, the default value of <code>x</code> depends on the “upstream” argument <code>y</code>.</li>
<li>In the <code>plot</code> statement in the function definition, the first <code>cex</code> is a parameter to be passed to the <code>plot</code> function. The second <code>cex</code> is the current value of the input argument <code>cex</code>.</li>
</ul>
<h2 id="functions-returning-complex-data-structures"><a href="#functions-returning-complex-data-structures"><span class="header-section-number">31.8</span> Functions returning complex data structures</a></h2>
<p>“Complex” in this context means “something other than a single number (or single logical, etc.)”, not anything to do with complex numbers (<code>a + b*i</code>). The point is that if R always returns the last thing evaluated in a function, how do you make it return more than one thing?</p>
<p>The answer is to pack your return values into a <code>list</code> and return the <code>list</code>. In the special case that all the items being returned are of the same type, you can pack them into a vector (“c(x, y, z)”, rather than “list(x, y, z)”).</p>
<p>Here’s a simple example. Note that we assign names to the returned list items, so that they explicitly appear in the result of the function call.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  convToPolar &lt;-<span class="st"> </span>function(x, y) {
      r     &lt;-<span class="st"> </span><span class="kw">sqrt</span>(x^<span class="dv">2</span> +<span class="st"> </span>y^<span class="dv">2</span>)
      theta &lt;-<span class="st"> </span><span class="kw">atan2</span>(y, x)
      <span class="kw">list</span>(<span class="dt">r=</span>r, <span class="dt">theta=</span>theta)  ## &quot;name r = computed value of r&quot;, etc.
  }

  <span class="kw">convToPolar</span>(<span class="dv">1</span>, <span class="dv">1</span>)  ## expect to get root(2), 45 degrees (pi / 4)
  pi /<span class="dv">4</span></code></pre>
<h2 id="function-arguments-passed-by-value"><a href="#function-arguments-passed-by-value"><span class="header-section-number">31.9</span> Function arguments passed by value</a></h2>
<p>In R, arguments are passed to functions “by value”, <em>not</em> “by reference” or “by name”. This means that all arguments get <em>copied</em> into a function, so that any calculations done on those arguments inside the function does <em>not</em> affect the original variables. Here’s an example.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  alpha &lt;-<span class="st"> </span><span class="dv">1</span>
  omega &lt;-<span class="st"> </span><span class="dv">26</span>

  myFn5 &lt;-<span class="st"> </span>function(x, y) {
    z1 &lt;-<span class="st"> </span>x *<span class="st"> </span>y
    omega &lt;-<span class="st"> </span><span class="kw">sqrt</span>(z1)  ## this value gets returned; this omega then discarded
  }

  <span class="kw">print</span>(<span class="kw">myFn5</span>(<span class="dv">2</span>, <span class="dv">32</span>))
  <span class="kw">print</span>(omega)  ## this omega still has the original value</code></pre>
<p>Here’s another example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
myFn5 &lt;-<span class="st"> </span>function(x) {
    x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">Inf</span>  ## vector is copied to the function; 1st element modified
    x  ## return the now-modified vector
}

x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">3</span>
x
<span class="kw">myFn5</span>(x)
x  ## no change in this x</code></pre>
<p>Notes:</p>
<ul>
<li>There <em>are</em> ways to simulate call by reference, using an <code>environment</code>, for example, but we won’t be dealing with these.</li>
<li>R tries to be “smart” about copying arguments and won’t copy things unless they’re <em>modified</em> inside the function.</li>
</ul>
<h2 id="r-uses-lexical-scoping"><a href="#r-uses-lexical-scoping"><span class="header-section-number">31.10</span> R uses <em>lexical scoping</em></a></h2>
<p>This topic is somewhat technical for a statistics course, but <em>somebody</em> is going to ask about it. Feel free to skip to the next section.</p>
<p>We saw above that variables in R have some kind of restriction on the places where they can be “seen”. The <code>x</code> inside a function may not be the same as the <code>x</code> outside that function, for instance.</p>
<p>The variable names used in a function in R fall into one of three categories, as illustrated by the following (taken from the R documentation):</p>
<pre class="sourceCode r"><code class="sourceCode r">
  foo &lt;-<span class="st"> </span>function(x) {
      y &lt;-<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>x ## &quot;y&quot; is a LOCAL variable, defined only inside the function
      <span class="kw">print</span>(x)   ## &quot;x&quot; is a FORMAL parameter (argument) from the arg list
      <span class="kw">print</span>(y)   ## &quot;y&quot; is assigned inside foo, so still a local variable
      <span class="kw">print</span>(z)   ## &quot;z&quot; is a FREE variable -- definition is nowhere in sight!
  }</code></pre>
<p>When R finds a <em>free</em> variable (<code>z</code> in the example) it tries to find a value to assign to it. With <em>lexical scoping</em> (also known as <em>static scoping</em>), R will look in the enclosing piece of code, i.e., the place or <em>environment</em> where the function was <strong>created</strong>. If R fails to find the variable there, it will continue to keep looking in enclosing environments until it either finds a value or reaches the top of the food chain, the so-called <em>global environment</em>.</p>
<p>Take a look at the following two examples.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  z &lt;-<span class="st"> </span><span class="dv">42</span>
  foo &lt;-<span class="st"> </span>function (x) {
      y &lt;-<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>x
      y +<span class="st"> </span>z
  }

  z &lt;-<span class="st"> </span><span class="dv">314</span>
  <span class="kw">foo</span>(<span class="dv">7</span>)  ## result: 328.  Why not 56?</code></pre>
<p>If you run the code in the example above, you should get a result of <code>328</code>. But why? This is lexical (static) scoping, and the value of the free variable, <code>z</code>, at the time the function <code>foo()</code> was defined was <code>42</code>. The result suggests that R is doing <em>dynamic</em> scoping: the value used for <code>z</code> was the value assigned to <code>z</code> most recently. But that’s just a coincidence.</p>
<p>What happened was that R looked for a value of <code>z</code> inside the function <code>foo()</code> and didn’t find it. R then looked in the enclosing environment, which is essentially a “box” with variables inside. In this case the enclosing environment was the top-level environment, and, indeed, inside that “box” was a variable named <code>z</code>, and it had a value <code>314</code>.</p>
<p>The impact of lexical scoping is more evident in the following example. In this example we’ve got a function, <code>new.Fn</code>, that is used to produce <em>other</em> functions.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  nnn &lt;-<span class="st"> </span><span class="dv">5</span>
  new.Fn &lt;-<span class="st"> </span>function(nnn) {
    fn1 &lt;-<span class="st"> </span>function(x) {
      x^nnn
    }
    fn1  ## return value is a function!
  }

  someFn &lt;-<span class="st"> </span><span class="kw">new.Fn</span>(<span class="dv">2</span>)
  moreFn &lt;-<span class="st"> </span><span class="kw">new.Fn</span>(<span class="dv">3</span>)

  <span class="kw">print</span>(someFn)
  <span class="kw">print</span>(moreFn)

  nnn &lt;-<span class="st"> </span><span class="dv">10</span>

  <span class="kw">someFn</span>(<span class="dv">4</span>)
  <span class="kw">moreFn</span>(<span class="dv">2</span>)</code></pre>
<p>If you run the code in the example above, you’ll see that:</p>
<ol style="list-style-type: decimal">
<li>The two newly-created functions appear to be identical, <em>except</em> for their environments.</li>
<li>Changing the value of <code>nnn</code> at various places in the code has <em>no effect</em> on the behavior of <code>someFn</code> or <code>moreFn</code>, even though both functions print out as: <code>x^nnn</code>.</li>
</ol>
<p>The relevant value of <code>nnn</code> is the one that existed at the time the functions were constructed. When <code>someFn</code> was created, for instance, a value of <code>2</code> was passed to <code>new.Fn</code>, and <em>that</em> was the value of <code>nnn</code> <em>at the time <code>someFn</code> was created</em>.</p>
<p>Hence, <code>someFn</code> is <em>always</em> going to raise its argument to the power of <code>2</code>, regardless of the value that <code>nnn</code> might have in some other environment.</p>
<h2 id="scoping-a-word-of-caution"><a href="#scoping-a-word-of-caution"><span class="header-section-number">31.11</span> Scoping: a word of caution</a></h2>
<p>It’s a little dangerous to depend on R to go off looking for your variables and using whatever it turns up. A better idea is to pass to your functions <em>all</em> the variables they’re going to use. That way you at least know where the values came from.</p>
<p>There are sometimes reasons <em>not</em> to pass all the variables to your functions, but it’s probably a good idea to start by passing in everything and then back off of that ideal only to the extent necessary (for performance or other reasons).</p>
<h1 id="a-better-way-of-looping-the-apply-family"><a href="#a-better-way-of-looping-the-apply-family"><span class="header-section-number">32</span> A better way of looping: the “apply” family</a></h1>
<h2 id="background-1"><a href="#background-1"><span class="header-section-number">32.1</span> Background</a></h2>
<p>What is “apply” in this sense? It means to “apply” a function to a set of arguments. Sort of a loop without a loop. Have a look at:</p>
<pre><code>http://en.wikipedia.org/wiki/Apply</code></pre>
<p>for much more than you currently need to know about apply-style functions.</p>
<p>Why do we care about apply-style functions? Quoting from:</p>
<p>http://nsaunders.wordpress.com/2010/08/20/a-brief-introduction-to-apply-in-r/</p>
<pre><code>At any R Q&amp;A site, you’ll frequently see an exchange like this one:

    Q: How can I use a loop to [...insert task here...] ?
    A: Don’t. Use one of the apply functions. </code></pre>
<p>Besides the dialog, the site mentioned above has a nice summary of many of the apply-style functions available in R. Type:</p>
<pre><code>
  apropos(&quot;apply&quot;)
</code></pre>
<p>at the R prompt to see a brief listing of such functions.</p>
<p>We’ll be most concerned with <code>lapply</code>, <code>sapply</code>, and <code>replicate</code> (which doesn’t have the word “apply” in its name but is still an apply-style function). We may also make some use of <code>apply</code> and <code>mapply</code>.</p>
<h2 id="lapply"><a href="#lapply"><span class="header-section-number">32.2</span> <code>lapply</code></a></h2>
<p>Here’s an excerpt from the R help page for <code>lapply</code>:</p>
<pre><code>
  Description:
  
       `lapply` returns a list of the same length as `X`, each element of
       which is the result of applying `FUN` to the corresponding element
       of `X`.
  
  Usage:
  
       lapply(X, FUN, ...)
</code></pre>
<p>Notes:</p>
<ul>
<li><code>lapply</code> <em>always</em> returns a list</li>
<li><code>X</code> does <em>not</em> have to be a list. It’s basically just an object that has individual elements that R can identify.</li>
<li>the <code>...</code> indicates that the function, FUN, might require some <em>additional</em> arguments, besides the one that’s “fed” to it by <code>lapply</code></li>
</ul>
<p>Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myVec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>)  ## iterating over a numeric vector
  someSquares &lt;-<span class="st"> </span><span class="kw">lapply</span>(myVec, function(someNum) {
                                 someNum^<span class="dv">2</span>
                                }
                       )
  someSquares
  <span class="kw">unlist</span>(someSquares)  ## don&#39;t always need or want a list

  myList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">42</span>, <span class="ot">FALSE</span>, <span class="st">&quot;groundhog&quot;</span>)  ## iterating over a list
  <span class="kw">lapply</span>(myList, function(nextItem) {
                   if (<span class="kw">is.numeric</span>(nextItem)) {
                     nextItem *<span class="st"> </span><span class="dv">3</span>
                   } else {
                     nextItem
                   }
                 }
        )

  myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">5</span>)), <span class="dt">nrow=</span><span class="dv">2</span>)  ## iterate over a matrix
  myMat

  <span class="kw">lapply</span>(myMat, function(xij) {
                  xij^<span class="dv">3</span>
                }
        )

  myVec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)  ## the &quot;log&quot; function has an optional 2nd arg
  myVecLog.e &lt;-<span class="st"> </span><span class="kw">lapply</span>(myVec, log) ## default is base &quot;e&quot;
  <span class="kw">unlist</span>(myVecLog.e)

  myVecLog<span class="fl">.10</span> &lt;-<span class="st"> </span><span class="kw">lapply</span>(myVec, log, <span class="dt">base=</span><span class="dv">10</span>)  ## here&#39;s the &quot;...&quot; thing
  <span class="kw">unlist</span>(myVecLog<span class="fl">.10</span>)</code></pre>
<h2 id="sapply"><a href="#sapply"><span class="header-section-number">32.3</span> <code>sapply</code></a></h2>
<p>Here’s an excerpt from the R help page for <code>sapply</code>:</p>
<pre><code>
  Description:
  
       `sapply` is a user-friendly version and wrapper of `lapply` by
       default returning a vector, matrix or, if `simplify = &quot;array&quot;`, an
       array if appropriate, by applying `simplify2array()`.  `sapply(x,
       f, simplify = FALSE, USE.NAMES = FALSE)` is the same as `lapply(x,
       f)`.
  
  Usage:
  
       sapply(X, FUN, ..., simplify = TRUE, USE.NAMES = TRUE)
</code></pre>
<p>Stripped of some of the jargon, this means that <code>sapply</code> is a “simplifying” version of <code>lapply</code>. For instance, recall from the examples for <code>lapply</code> that we repeatedly used the <code>unlist()</code> function in cases where we knew that all elements returned by <code>lapply</code> were of the same type. In those cases, we had numeric vector in, list out. Then unlist. There must be a simpler way. That’s where <code>sapply</code> comes in.</p>
<p>Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myVec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>)  ## iterating over a numeric vector
  someSquares &lt;-<span class="st"> </span><span class="kw">sapply</span>(myVec, function(someNum) {
                                 someNum^<span class="dv">2</span>
                                }
                       )
  someSquares</code></pre>
<p>Numbers in, numbers out – no need to <code>unlist</code>.</p>
<p><strong>Caution</strong>: be careful of getting into the habit of using <code>sapply</code> for all types of iterations. Here’s an example using a slightly more-complex object: a list of matrices. Run through the following code, and you’ll see that <code>sapply</code> <em>guesses</em> what you want and simplifies to a form you probably <em>don’t</em> want, while <code>lapply</code> does the thing you probably <em>do</em> want.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  mat1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">5</span>)), <span class="dt">nrow=</span><span class="dv">2</span>)
  mat1
  mat2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">40</span>), <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">50</span>)), <span class="dt">nrow=</span><span class="dv">2</span>)
  mat2

  someMats &lt;-<span class="st"> </span><span class="kw">list</span>(mat1, mat2)
  someMats
  <span class="kw">sapply</span>(someMats, function(inMat) {
                     <span class="dv">2</span> *<span class="st"> </span>inMat
                   }
        )

  <span class="kw">lapply</span>(someMats, function(inMat) {
                     <span class="dv">2</span> *<span class="st"> </span>inMat
                   }
        )</code></pre>
<p>Of course, it <em>is</em> possible to use <code>sapply</code> safely in the more-complicated cases. In the example above, just adding <code>simplify=FALSE</code> after the function definition would make <code>sapply</code> work the same as <code>lapply</code>. But as a rule of thumb, it’s better to use <code>sapply</code> only in simple cases (numeric in, numeric out, for instance).</p>
<h2 id="replicate"><a href="#replicate"><span class="header-section-number">32.4</span> <code>replicate</code></a></h2>
<p>Here’s an excerpt from the R help page for <code>replicate</code>:</p>
<pre><code>  Description:
  
       `replicate` is a wrapper for the common use of `sapply` for
       repeated evaluation of an expression (which will usually involve
       random number generation).
  
  Usage:
  
       replicate(n, expr, simplify = &quot;array&quot;)
</code></pre>
<p>OK, so now we have a wrapper (<code>replicate</code>) on top of a wrapper (<code>sapply</code>). Where will this all end? As the help page indicates, there <em>is</em> a use for this shorthand, in the appropriate context, and we’ll see a fair amount of <code>replicate</code> in this course.</p>
<p>It’s hard to give a meaningful example without some more background. Here’s a toy example in which we generate three sets of ten random numbers from a normal/Gaussian/“bell-shaped” distribution. (Much more on this later in the course.)</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myResults &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">3</span>, <span class="kw">rnorm</span>(<span class="dv">10</span>))
  myResults</code></pre>
<p>In the context of this course you would typically write your own function that involved some degree of randomness (whatever that means) and evaluate that function repeatedly as a sort of numerical experiment to see what you can say about the randomness. In pseudo-code:</p>
<pre><code>
  myFunction &lt;- function(x, y, z) {
                  do some random-number calculations with x, y, and z
                }
  myResults &lt;- replicate(10^6, myFunction(a, b, c))
</code></pre>
<h2 id="apply"><a href="#apply"><span class="header-section-number">32.5</span> <code>apply</code></a></h2>
<p>Here’s an excerpt from the R help page for <code>apply</code>:</p>
<pre><code>
  Description:
  
       Returns a vector or array or list of values obtained by applying a
       function to margins of an array or matrix.
  
  Usage:
  
       apply(X, MARGIN, FUN, ...)
</code></pre>
<p>This should look familiar by now, <em>except</em> for the “MARGIN” business. <code>apply</code> is built for working with matrices (or their higher-dimensional equivalents), and the MARGIN argument tells <code>apply</code> that you want to apply the function FUN to either the <em>rows</em> of the object (MARGIN = 1), or the <em>columns</em> of the object (MARGIN = 2), and so on for higher dimensions.</p>
<p>Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">24</span>, <span class="dt">nrow=</span><span class="dv">3</span>)
  myMat

  <span class="kw">apply</span>(myMat, <span class="dv">1</span>, sum)  ## calculate the sum of each row
  <span class="kw">apply</span>(myMat, <span class="dv">2</span>, prod) ## calculate the product of each column

  ## look in BOTH dimensions to find odd-numbered values
  thatsOdd &lt;-<span class="st"> </span><span class="kw">apply</span>(myMat, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), function(x) x %%<span class="st"> </span><span class="dv">2</span>)
  thatsOdd</code></pre>
<h2 id="mapply"><a href="#mapply"><span class="header-section-number">32.6</span> <code>mapply</code></a></h2>
<p>Here’s an excerpt from the R help page for <code>mapply</code>:</p>
<pre><code>
  Description:
  
       ‘mapply’ is a multivariate version of ‘sapply’.  ‘mapply’ applies
       ‘FUN’ to the first elements of each ...  argument, the second
       elements, the third elements, and so on.  Arguments are recycled
       if necessary.
  
  Usage:
  
       mapply(FUN, ..., MoreArgs = NULL, SIMPLIFY = TRUE,
              USE.NAMES = TRUE)
</code></pre>
<p>Hmmm. This all looks more or less familiar, but why does FUN now come at the <em>beginning</em> of the argument list, instead of second, where it belongs? The answer is that there is no way for <code>mapply</code> to “know” how many arguments you’re going to give it. That’s where the <code>...</code> comes in: you stick in there all the vectors (or whatever) you want to operate on.</p>
<p>Here’s a simple example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">mapply</span>(paste, letters[<span class="dv">1</span>:<span class="dv">4</span>], LETTERS[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">MoreArgs=</span><span class="kw">list</span>(<span class="dt">sep=</span><span class="st">&quot;//&quot;</span>))</code></pre>
<p>Given that the <code>paste</code> function is vectorized to begin with, using <code>mapply</code> in this context doesn’t really “buy” us anything, but the example illustrates the idea: grab the first item from <code>letters</code> and the first item from <code>LETTERS</code>, and the first item from <code>1:4</code>, then feed all those to the function named in the first argument (<code>paste</code>); then do the same for the second items, the third items, etc.</p>
<h1 id="do.call-and-its-applications"><a href="#do.call-and-its-applications"><span class="header-section-number">33</span> <code>do.call</code> and its applications</a></h1>
<p>The use of the function <code>do.call</code> is a somewhat specialized topic, but we use the function extensively in this course, so it merits discussion here.</p>
<p>From the help page for <code>do.call</code>:</p>
<pre><code>
  Description:
  
       ‘do.call’ constructs and executes a function call from a name or a
       function and a list of arguments to be passed to it.
  
  Usage:
  
       do.call(what, args, quote = FALSE, envir = parent.frame())
</code></pre>
<p>If you think this sounds suspiciously similar to just calling a function, you’re correct. Here’s an example that demonstrates the equivalence:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  myPowerFn &lt;-<span class="st"> </span>function(x, n) {
      x^n
  }

  <span class="kw">myPowerFn</span>(<span class="dv">2</span>, <span class="dv">5</span>)
  <span class="kw">do.call</span>(<span class="dt">what=</span>myPowerFn, <span class="kw">list</span>(<span class="dv">2</span>, <span class="dv">5</span>))</code></pre>
<p>The usefulness of <code>do.call()</code> stems from the fact that the second argument is a <code>list</code>, which can be a <code>list</code> that you’ve computed or read in. You don’t have to know the details in advance.</p>
<p>Here’s a common scenario: you’ve got a bunch of data frames, all with identical structure (but different values), and you’d like to “stack” them all into one big data frame. How could you do that?</p>
<p>We’ve seen above that the <code>rbind</code> function will do just that. Here’s a reminder:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="dt">num=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">book=</span><span class="kw">c</span>(<span class="st">&quot;hitchhiker&quot;</span>, <span class="st">&quot;guide&quot;</span>)))
  df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="dt">num=</span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="dt">book=</span><span class="kw">c</span>(<span class="st">&quot;don&#39;t&quot;</span>, <span class="st">&quot;panic&quot;</span>)))
  df1
  df2
  bigDF &lt;-<span class="st"> </span><span class="kw">rbind</span>(df1, df2)
  bigDF</code></pre>
<p>This is all fine, but what if you had, say, 1000 individual data frames? You could type them all in to one very large <code>rbind</code> statement, but that would be tedious and error-prone. But what if you had a <code>list</code> of data frames? Then you could use <code>do.call</code> to process them:</p>
<pre class="sourceCode r"><code class="sourceCode r">

  df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="dt">num=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">book=</span><span class="kw">c</span>(<span class="st">&quot;hitchhiker&quot;</span>, <span class="st">&quot;guide&quot;</span>)))
  df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="dt">num=</span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="dt">book=</span><span class="kw">c</span>(<span class="st">&quot;don&#39;t&quot;</span>, <span class="st">&quot;panic&quot;</span>)))

  dfList &lt;-<span class="st"> </span><span class="kw">list</span>(df1, df2)
  bigDF  &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, dfList)
  bigDF</code></pre>
<p>This doesn’t seem to have bought us anything: in fact, there’s slightly <em>more</em> typing involved in the <code>do.call</code> approach. But suppose that there were some way to generate a list of data frames programmatically. Then we could use our program to generate lists that were arbitrarily long and still bind them together using exactly the same, simple call to <code>do.call</code> as in the example above.</p>
<p>But we’ve already seen something that generates a list: the <code>lapply</code> function. Consider the following example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  xVals &lt;-<span class="st"> </span><span class="kw">seq</span>(-pi, pi, <span class="dt">by=</span><span class="fl">0.2</span>)

  trigTable &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind,
                           <span class="kw">lapply</span>(xVals, function(x) {
                               <span class="kw">data.frame</span>(
                                   <span class="dt">sinx=</span><span class="kw">sin</span>(x),
                                   <span class="dt">cosx=</span><span class="kw">cos</span>(x),
                                   <span class="dt">tanx=</span><span class="kw">tan</span>(x)
                               )
                           })
                      )
  trigTable</code></pre>
<p>If you run the code above, you’ll see that you get a nicely-formatted table of selected values of the trig functions, and by <em>naming</em> the elements of the data frame, you get a nice header for the table as well. This formatting is actually the motivation for introducing the <code>do.call</code> function at the point.</p>
<p>Note, by the way, that if, for instance, you decided you needed to have a finer granularity in your result, you could change <code>by=0.2</code> to <code>by=0.1</code> (for example) in the code above, then run the code, and get a larger, but still nicely-formatted, table as a result, with <em>no other change in the code</em>.</p>
<h1 id="string-manipulation"><a href="#string-manipulation"><span class="header-section-number">34</span> String manipulation</a></h1>
<p>R has a number of functions that are useful for manipulating strings, including, in particular, pattern matching with so-called <em>regular expressions</em>. We’ll touch on these only briefly here and revisit them later, as necessary.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="co">#      paste(..., sep = &quot; &quot;, collapse = NULL)</span>
  <span class="kw">paste</span>(<span class="st">&quot;abra&quot;</span>, <span class="st">&quot;cadabra&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;!!!&quot;</span>)

  <span class="co">#      substr(x, start, stop)</span>
  <span class="kw">substr</span>(<span class="st">&quot;Popsicle&quot;</span>, <span class="dt">start=</span><span class="dv">4</span>, <span class="dt">stop=</span><span class="dv">7</span>)

  <span class="co">#      substring(text, first, last = 1000000)</span>
  <span class="kw">substring</span>(<span class="st">&quot;Popsicle&quot;</span>, <span class="dt">first=</span><span class="dv">4</span>, <span class="dt">last=</span><span class="dv">7</span>)    ## older version of substr

  <span class="co">#      substr(x, start, stop) &lt;- value</span>
  oldSong &lt;-<span class="st"> &quot;MagicalMysteryTour&quot;</span>
  <span class="kw">substr</span>(oldSong, <span class="dv">1</span>, <span class="dv">7</span>) &lt;-<span class="st"> &quot;Musical&quot;</span>
  <span class="kw">print</span>(oldSong)

  <span class="co">#      substring(text, first, last = 1000000) &lt;- value</span>
  <span class="kw">substring</span>(oldSong, <span class="dt">first=</span><span class="dv">1</span>, <span class="dt">last=</span><span class="dv">7</span>) &lt;-<span class="st"> &quot;Magical&quot;</span>
  <span class="kw">print</span>(oldSong)

  <span class="co">#      strsplit(x, split, fixed = FALSE, perl = FALSE, useBytes = FALSE)</span>
  stringsTrebleClef &lt;-<span class="st"> &quot;Every Good Boy Does Fine&quot;</span>
  stringsTrebleClef
  <span class="kw">strsplit</span>(stringsTrebleClef, <span class="dt">split=</span><span class="st">&quot; &quot;</span>)
  <span class="kw">strsplit</span>(stringsTrebleClef, <span class="dt">split=</span><span class="st">&quot;o&quot;</span>)

  <span class="co">#      nchar(x, type = &quot;chars&quot;, allowNA = FALSE) # string length</span>
  <span class="kw">nchar</span>(<span class="st">&quot;this string has thirty-nine characters &quot;</span>)

  <span class="co">#      tolower(x)</span>
  <span class="kw">tolower</span>(<span class="st">&quot;BIG NOISE!&quot;</span>)

  <span class="co">#      toupper(x)</span>
  <span class="kw">toupper</span>(<span class="st">&quot;ucd&quot;</span>)

  <span class="co">#      match(x, table, nomatch = NA_integer_, incomparables = NULL)</span>
  <span class="kw">match</span>(<span class="dv">4</span>, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">5</span>))
  <span class="kw">match</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">5</span>))

  <span class="co">#      x %in% table</span>
  <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>) %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">13</span>)

  <span class="co">#      pmatch(x, table, nomatch = NA_integer_, duplicates.ok = FALSE)</span>
  <span class="kw">pmatch</span>(<span class="st">&quot;med&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;mode&quot;</span>)) <span class="co"># returns 2</span>

  <span class="co">#     grep(pattern, x, ignore.case = FALSE, perl = FALSE, value = FALSE,</span>
  <span class="co">#          fixed = FALSE, useBytes = FALSE, invert = FALSE)</span>
  someText &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Let&quot;</span>, <span class="st">&quot;There&quot;</span>, <span class="st">&quot;Be&quot;</span>, <span class="st">&quot;Light&quot;</span>)
  <span class="kw">grep</span>(<span class="st">&quot;e&quot;</span>, someText)  ## all but the last entry
  <span class="kw">grep</span>(<span class="st">&quot;e&quot;</span>, someText, <span class="dt">value=</span><span class="ot">TRUE</span>)
  <span class="kw">grep</span>(<span class="st">&quot;Le&quot;</span>, someText)
  <span class="kw">grep</span>(<span class="st">&quot;l&quot;</span>, someText)  ## not found -- now lower-case &#39;l&#39;
  <span class="kw">grep</span>(<span class="st">&quot;l&quot;</span>, someText, <span class="dt">ignore.case=</span><span class="ot">TRUE</span>) ## look for &#39;l&#39; or &#39;L&#39; 
  <span class="kw">grep</span>(<span class="st">&quot;[tT]&quot;</span>, someText)  ## look for either &#39;t&#39; or &#39;T&#39;
  <span class="kw">grep</span>(<span class="st">&quot;^[tT]&quot;</span>, someText)  ## look for either &#39;t&#39; or &#39;T&#39; at the START (^)
  <span class="kw">grep</span>(<span class="st">&quot;e$&quot;</span>, someText, <span class="dt">value=</span><span class="ot">TRUE</span>)  ## &#39;e&#39; at the END ($)

  <span class="co">#     sub(pattern, replacement, x, ignore.case = FALSE, perl = FALSE,</span>
  <span class="co">#         fixed = FALSE, useBytes = FALSE)</span>
  <span class="kw">sub</span>(<span class="st">&quot;ere&quot;</span>, <span class="st">&quot;at&quot;</span>, someText)
  <span class="kw">sub</span>(<span class="st">&quot;hate&quot;</span>, <span class="st">&quot;love&quot;</span>, <span class="st">&quot;I hate R&quot;</span>)

  <span class="co">#     gsub(pattern, replacement, x, ignore.case = FALSE, perl = FALSE,</span>
  <span class="co">#          fixed = FALSE, useBytes = FALSE)</span>
  moreText &lt;-<span class="st"> &quot;The address is 640 Oak Street, Apt. 2&quot;</span>
  <span class="kw">sub</span> (<span class="st">&quot;</span><span class="ch">\\</span><span class="st">d+&quot;</span>, <span class="st">&quot;NNN&quot;</span>, moreText)  ## look for digits -- match the first
  <span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">d+&quot;</span>, <span class="st">&quot;NNN&quot;</span>, moreText)  ## look for digits -- match all of them

  <span class="co">#     regexpr(pattern, text, ignore.case = FALSE, perl = FALSE,</span>
  <span class="co">#             fixed = FALSE, useBytes = FALSE)</span>
  <span class="kw">regexpr</span> (<span class="st">&quot;</span><span class="ch">\\</span><span class="st">d+&quot;</span>, moreText) ## find locations, length of 1st digit substr
  <span class="kw">gregexpr</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">d+&quot;</span>, moreText) ## find locations, length of all digit substr


  </code></pre>
<h1 id="pseudo-random-numbers"><a href="#pseudo-random-numbers"><span class="header-section-number">35</span> Pseudo-random numbers</a></h1>
<h2 id="background-and-motivation"><a href="#background-and-motivation"><span class="header-section-number">35.1</span> Background and motivation</a></h2>
<p>Much of the work in this course will involve generating “random samples” of data. Most of this work will be done on a computer, although it’s possible to use some physical process, such as flipping a coin, to get random samples. As you can see, it would be tedious to obtain, say, a million random things by flipping a coin a million times. Computers can do the same task in practically no time, and with more or less no work on your part.</p>
<h2 id="generation-of-random-numbers"><a href="#generation-of-random-numbers"><span class="header-section-number">35.2</span> Generation of random numbers</a></h2>
<p>The concept of “randomness” is somewhat slippery. In particular, the methods used to generate random numbers on a computer rely on computer programs to generate the random numbers. But if you tell (program) a computer to run through some given series of operations, the results by definition can’t be truly random. Any time you run the same program, with the same initial conditions, you get exactly the same output.</p>
<p>This topic is discussed in detail at:</p>
<pre><code>http://en.wikipedia.org/wiki/Random_number_generation</code></pre>
<p>The thing that makes computer generation of “random” numbers useful, despite the obvious non-randomness, is that it’s possible to program a computer to generate sequences of numbers that, when subjected to various mathematical tests, exhibit the properties expected of a truly random sequence of numbers.</p>
<p>This topic is discussed in detail at:</p>
<pre><code>http://en.wikipedia.org/wiki/Statistical_randomness</code></pre>
<h2 id="random-numbers-in-r"><a href="#random-numbers-in-r"><span class="header-section-number">35.3</span> Random numbers in R</a></h2>
<p>R has many functions that explicitly or implicitly involve the use of its random-number generator. We’ve looked briefly at several examples of such functions (<code>sample</code>, <code>runif</code>, <code>rnorm</code>). Every such function will use and modify the so-called <code>seed</code>, which represents the state of the random-number generator.</p>
<p>It might be helpful to visual the output of the random-number generator as a long, closed loop of string, with pieces of paper attached to the loop at various points, and each piece of paper containing two numbers: the first number is just a sequence number, identifying the piece of paper (1, 2, 3, …); the second number is one of the sequence of random numbers. (The random numbers will always eventually loop back and start repeating themselves.)</p>
<p>In this model, the <code>seed</code> is just the first number on the next piece of paper to be read. If the <code>seed</code> is 1, the next random number you’ll get from <code>sample</code>, etc., is the second number on the first piece of paper in the loop. If the <code>seed</code> is 31415, the next random number you get will be the second number on the piece of paper whose first number is 31415.</p>
<p>The following table represents schematically the first ten pairs of numbers in our imaginary loop:</p>
<pre><code>seed | random.number
-----|--------------
1    |    5567940
2    |    2047711
3    |    8085826
4    |     403246
5    |     954011
6    |    7003668
7    |     697330
8    |    7949082
9    |    8542808
10   |    6045173</code></pre>
<p>Thus, if the <code>seed</code> is 7, the next random number you’ll get is 697330, etc. (The numbers are for purposes of illustration only: don’t take them literally.)</p>
<p>Note: the actual structure used by R to store the state of the random-number generator is called <code>.Random.seed</code>, and it’s much more complicated than just a single integer, but we’ll see that the single-integer model is sufficient for our purposes.</p>
<p>Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">set.seed</span>(<span class="dv">42</span>)  ## more or less arbitrary place to begin our calculations
  .Random.seed.save &lt;-<span class="st"> </span>.Random.seed  ## save the full RNG state
  <span class="kw">runif</span>(<span class="dv">1</span>)  ## generate one random number (uniform distribution)
  <span class="kw">all.equal</span>(.Random.seed, .Random.seed.save) ## things have changed
  <span class="kw">runif</span>(<span class="dv">1</span>)  ## generate another one; different value this time
  <span class="kw">runif</span>(<span class="dv">1</span>)  ## ditto
  <span class="kw">set.seed</span>(<span class="dv">42</span>)  ## back to our starting point
  <span class="kw">all.equal</span>(.Random.seed, .Random.seed.save) ## really the same?  Yep.
  <span class="kw">runif</span>(<span class="dv">1</span>)  ## same as the first value we got</code></pre>
<p>The idea here is that you first pick a number and feed it to <code>set.seed</code>. The actual number isn’t important: it’s important that you <em>know</em> what the seed is. Then your collaborators (or instructor or …) can get your code <strong>with</strong> the seed and produce exactly your same results. If you send a collaborator only your code and not the seed, he or she will almost certainly get numerical results that are <em>different</em> from yours, and, hence, have no way to evaluate the results.</p>
<h1 id="plotting"><a href="#plotting"><span class="header-section-number">36</span> Plotting</a></h1>
<h2 id="background-2"><a href="#background-2"><span class="header-section-number">36.1</span> Background</a></h2>
<p>R has extensive facilities for making plots, graphs, charts, etc., on a wide variety of graphic devices, including the standard displays on linux, Macintosh, and Windows, as well as PDF, PNG, JPEG, etc.</p>
<p>R currently has many packages devoted to graphics, including, for example, <code>lattice</code>, <code>grid</code>, <code>ggplot2</code>, etc. We’ll restrict our attention to the so-called “base graphics”, the set of graphics tools that comes with R by default.</p>
<p>You can type:</p>
<pre><code>
  demo(graphics)
</code></pre>
<p>in the R console (i.e., at the <code>&gt;</code> prompt) to get a quick overview of R’s graphics capabilities.</p>
<p>The following web site has some very clear demonstrations of R’s base graphics:</p>
<pre><code>http://www.harding.edu/fmccown/r/</code></pre>
<p>We’ll have more to say about the base graphics system below.</p>
<h2 id="the-murrell-book"><a href="#the-murrell-book"><span class="header-section-number">36.2</span> The Murrell book</a></h2>
<p>The “bible” on R graphics is this book by Paul Murrell:</p>
<pre><code>http://www.amazon.com/Graphics-Second-Edition-Chapman-Series/dp/1439831769</code></pre>
<p>This book contains a good deal of material that, while useful, is beyond the scope of the graphics we’ll use in this course. Nevertheless, the book is an excellent reference, and you should be aware of it if you plan to make serious use of R graphics.</p>
<p>The following discussion is optional. Feel free to jump ahead to the next section, where we begin our discussion of R graphics functions.</p>
<p>You can browse the figures in the book at:</p>
<pre><code>https://www.stat.auckland.ac.nz/~paul/RG2e/</code></pre>
<p>At that site you can view the figures and the associated R code for the figures, although this is a little tedious.</p>
<p>Fortunately for the R community, Paul has made much of the material in his book available as an R package, and it’s worthwhile to study the material in the package.</p>
<p>To study the package, you first have to install it, which you can do in a couple of ways:</p>
<ol style="list-style-type: decimal">
<li><p>At the “&gt;” prompt in the R console (the pane on the lower left in RStudio) type: install.packages(“RGraphics”)</p></li>
<li><p>Select the <code>Packages</code> tab in the pane on the lower right in RStudio, then select “Install Packages”. Type: RGraphics into the “Packages” box in the window that pops up and click <code>Install</code></p></li>
</ol>
<p>Once you have the package installed, go to the R console and type:</p>
<pre><code>
  library(RGraphics)
  ls(&quot;package:RGraphics&quot;)
</code></pre>
<p>You should see a listing of the stuff in the package. Here are the first few lines:</p>
<pre><code>
  &gt; ls(&quot;package:RGraphics&quot;)
    [1] &quot;faceA&quot;          &quot;faceB&quot;          &quot;faceC&quot;          &quot;faceD&quot;         
    [5] &quot;faceE&quot;          &quot;figure1.1&quot;      &quot;figure1.10&quot;     &quot;figure1.11&quot;    
    [9] &quot;figure1.12&quot;     &quot;figure1.13&quot;     &quot;figure1.14&quot;     &quot;figure1.2&quot;     
   [13] &quot;figure1.3&quot;      &quot;figure1.4&quot;      &quot;figure1.5&quot;      &quot;figure1.6&quot;
   .
   .
   .
</code></pre>
<p>You use the items in the package as follows. Suppose, for instance, that you see Figure 1.3 either in the book or at Murrell’s web site and decide it would be worth investigating.</p>
<p>At the prompt in the R console type:</p>
<pre><code>
  figure1.3()  ## to run the R code and draw the picture
  figure1.3    ## to see the R code used to draw the picture
</code></pre>
<p>The same technique works for all the figures in the book/package.</p>
<h2 id="plot-and-related-functions"><a href="#plot-and-related-functions"><span class="header-section-number">36.3</span> <code>plot</code> and related functions</a></h2>
<p>We’ll now begin our actual study of R’s base graphics.</p>
<p>The most-important function to use for plotting is, surprisingly, <code>plot</code>. The basic syntax is as follows:</p>
<pre><code>  plot(x, y) ## plot the object &quot;y&quot; as a function of the object &quot;x&quot;
  plot(y ~ x)  ## the same, expressed in &quot;formula notation&quot;
</code></pre>
<p>Note that <code>x</code> and <code>y</code> have to be of the same length.</p>
<p>Here are some actual examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## generate some (arbitrary) data and make a simple plot
  xVals &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span>(-<span class="dv">2</span>*pi), <span class="dt">to=</span>(<span class="dv">2</span>*pi), <span class="dt">by=</span><span class="fl">0.2</span>)
  <span class="kw">plot</span>(xVals, <span class="kw">sin</span>(xVals))

    ## generate some dependent (on xVals) data and make a simple plot
  yVals &lt;-<span class="st"> </span>xVals +<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(xVals), <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">1.0</span>)
  <span class="kw">plot</span>(xVals, yVals)

    ## add some color to the plot
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)

    ## change the color and use a different plotting character
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">pch=</span><span class="dv">17</span>)

    ## ditto, but also compute the limits for the x axis
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">col=</span><span class="st">&quot;magenta&quot;</span>, <span class="dt">pch=</span><span class="dv">3</span>,
                     <span class="dt">xlim=</span><span class="kw">c</span>(<span class="kw">min</span>(xVals)-<span class="fl">0.5</span>, <span class="kw">max</span>(xVals) +<span class="st"> </span><span class="fl">0.5</span>))

    ## compute limits for both axes
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>,
                     <span class="dt">xlim=</span><span class="kw">c</span>(<span class="kw">min</span>(xVals)-<span class="fl">0.5</span>, <span class="kw">max</span>(xVals)+<span class="fl">0.5</span>),
                     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">min</span>(yVals)-<span class="fl">0.5</span>, <span class="kw">max</span>(yVals)+<span class="fl">0.5</span>))

    ## ditto, but also put labels on the x and y axes
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>,
                     <span class="dt">xlim=</span><span class="kw">c</span>(<span class="kw">min</span>(xVals)-<span class="fl">0.5</span>, <span class="kw">max</span>(xVals)+<span class="fl">0.5</span>),
                     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">min</span>(yVals)-<span class="fl">0.5</span>, <span class="kw">max</span>(yVals)+<span class="fl">0.5</span>),
                     <span class="dt">xlab=</span><span class="st">&quot;Fortnights&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Furlongs&quot;</span>)

    ## add a main title for the plot
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>,
                     <span class="dt">xlim=</span><span class="kw">c</span>(<span class="kw">min</span>(xVals)-<span class="fl">0.5</span>, <span class="kw">max</span>(xVals)+<span class="fl">0.5</span>),
                     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">min</span>(yVals)-<span class="fl">0.5</span>, <span class="kw">max</span>(yVals)+<span class="fl">0.5</span>),
                     <span class="dt">xlab=</span><span class="st">&quot;Fortnights&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Furlongs&quot;</span>,
                     <span class="dt">main=</span><span class="st">&quot;Plot of Furlongs per Fortnight&quot;</span>)

    ## add some color to the main title (and go back to default axes)
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>,
                     <span class="dt">xlab=</span><span class="st">&quot;Fortnights&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Furlongs&quot;</span>,
                     <span class="dt">col.lab=</span><span class="st">&quot;forestgreen&quot;</span>,
                     <span class="dt">main=</span><span class="st">&quot;Plot of Furlongs per Fortnight&quot;</span>,
                     <span class="dt">col.main=</span><span class="st">&quot;red&quot;</span>)

    ## change label colors; magnify labels (cex.lab) and title (cex.main)
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>,
                     <span class="dt">xlab=</span><span class="st">&quot;Fortnights&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Furlongs&quot;</span>,
                     <span class="dt">col.lab=</span><span class="st">&quot;forestgreen&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>,
                     <span class="dt">main=</span><span class="st">&quot;Plot of Furlongs per Fortnight&quot;</span>,
                     <span class="dt">col.main=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex.main=</span><span class="dv">2</span>)

    ## same, but squeeze labels a little closer to axes (mgp)
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>,
                     <span class="dt">xlab=</span><span class="st">&quot;Fortnights&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Furlongs&quot;</span>,
                     <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),
                     <span class="dt">col.lab=</span><span class="st">&quot;forestgreen&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>,
                     <span class="dt">main=</span><span class="st">&quot;Plot of Furlongs per Fortnight&quot;</span>,
                     <span class="dt">col.main=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex.main=</span><span class="dv">2</span>)

    ## some &quot;decorations&quot; for the last plot
    ## &quot;pos=4&quot; puts text to the right of the (x, y) point
  <span class="kw">text</span>(<span class="dt">x=</span><span class="dv">2</span>, <span class="dt">y=</span>-<span class="dv">4</span>, <span class="dt">labels=</span><span class="st">&quot;Some added text&quot;</span>, <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>, <span class="dt">pos=</span><span class="dv">4</span>)

    ## another decoration: rotated text (srt)
  <span class="kw">text</span>(<span class="dt">x=</span><span class="dv">2</span>, <span class="dt">y=</span>-<span class="dv">3</span>, <span class="dt">labels=</span><span class="st">&quot;Some rotated text&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">srt=</span><span class="dv">30</span>, <span class="dt">pos=</span><span class="dv">4</span>)

    ## decoration: math stuff.  How geek-cool is that?
  <span class="kw">text</span>(<span class="dt">x=</span><span class="dv">0</span>, <span class="dt">y=</span>-<span class="dv">5</span>, <span class="dt">labels=</span><span class="kw">expression</span>(<span class="kw">integral</span>(<span class="kw">f</span>(x) *<span class="st"> </span>dx, <span class="dv">0</span>, pi)))

    ## more decoration: add a line to the plot
    ## details of the &quot;zzz&quot; stuff are unimportant.  We&#39;re just trying
    ## to get some intercept and slope so we can draw a line
  zzz &lt;-<span class="st"> </span><span class="kw">lm</span>(yVals ~<span class="st"> </span>xVals)
  zzz.intercept &lt;-<span class="st"> </span>zzz$coefficients[<span class="st">&quot;(Intercept)&quot;</span>]
  zzz.slope &lt;-<span class="st"> </span>zzz$coefficients[<span class="st">&quot;xVals&quot;</span>]
    ## here&#39;s the important part: drawing a line
  <span class="kw">abline</span>(<span class="dt">a=</span>zzz.intercept, <span class="dt">b=</span>zzz.slope, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)

    ## we have two things plotted.  Add a legend to show which is which
  <span class="kw">legend</span>(<span class="dt">x=</span>-<span class="dv">6</span>, <span class="dt">y=</span><span class="dv">5</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Original data&quot;</span>, <span class="st">&quot;Fitted line&quot;</span>),
         <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">32</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre>
<h2 id="graphics-parameters.-the-par-function"><a href="#graphics-parameters.-the-par-function"><span class="header-section-number">36.4</span> Graphics parameters. The <code>par()</code> function</a></h2>
<p>R has an intimidating array of graphical parameters, some of which we’ve used in the examples above. You can view the help page for the <code>par</code> function to see the details:</p>
<pre><code>
  ?par
</code></pre>
<p>You can view and set graphical parameters using the <code>par</code> function. In many cases, the default values for the parameters work just fine. But you might, for instance, need to make a series of plots and decide that you need to have thicker lines and bigger characters in <em>all</em> those plots. Instead of specifying the associated parameters in every call to <code>plot</code>, etc., you can set them once with <code>par</code>. Here’s an example. Note that you <em>might</em> have to resize the graphics pane in RStudio to see the first plot. (You’ll get complaints about the margin and no picture if there isn’t enough room.)</p>
<pre class="sourceCode r"><code class="sourceCode r">
  pars.save &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">lwd=</span><span class="fl">3.5</span>, <span class="dt">cex=</span><span class="dv">2</span>)  ## save old params, set new ones
  <span class="kw">plot</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)

    ## make the rest of your plots with the modified parameters
    ## after that, bring back the original settings
  <span class="kw">par</span>(pars.save)  ## restore the saved parameters
  <span class="kw">plot</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)  ## back to thinner lines, smaller characters</code></pre>
<p>Here’s a list of some commonly-used graphics parameters:</p>
<h3 id="colors"><a href="#colors"><span class="header-section-number">36.4.1</span> Colors</a></h3>
<table>
<thead>
<tr class="header">
<th align="left">Param</th>
<th align="left">Description [default value]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">col</td>
<td align="left">The default plotting color</td>
</tr>
<tr class="even">
<td align="left">col.axis</td>
<td align="left">The color to be used for axis annotation [black]</td>
</tr>
<tr class="odd">
<td align="left">col.lab</td>
<td align="left">The color to be used for x and y labels [black]</td>
</tr>
<tr class="even">
<td align="left">col.main</td>
<td align="left">The color to be used for plot main titles [black]</td>
</tr>
<tr class="odd">
<td align="left">col.sub</td>
<td align="left">The color to be used for plot sub-titles [black]</td>
</tr>
<tr class="even">
<td align="left">fg</td>
<td align="left">The color to be used for the foreground of plots</td>
</tr>
<tr class="odd">
<td align="left">bg</td>
<td align="left">The color to be used for the background of device region</td>
</tr>
</tbody>
</table>
<h3 id="font"><a href="#font"><span class="header-section-number">36.4.2</span> Font</a></h3>
<table>
<thead>
<tr class="header">
<th align="left">Param</th>
<th align="left">Description [default value]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">font</td>
<td align="left">An integer which specifies the font to use for text</td>
</tr>
<tr class="even">
<td align="left">font.axis</td>
<td align="left">The font to be used for axis annotation</td>
</tr>
<tr class="odd">
<td align="left">font.lab</td>
<td align="left">The font to be used for x and y labels</td>
</tr>
<tr class="even">
<td align="left">font.main</td>
<td align="left">The font to be used for plot main titles</td>
</tr>
<tr class="odd">
<td align="left">font.sub</td>
<td align="left">The font to be used for plot sub-titles</td>
</tr>
</tbody>
</table>
<h3 id="character-expansion"><a href="#character-expansion"><span class="header-section-number">36.4.3</span> Character expansion</a></h3>
<table>
<thead>
<tr class="header">
<th align="left">Param</th>
<th align="left">Description [default value]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">cex</td>
<td align="left">A numerical giving the magnification for text and symbols</td>
</tr>
<tr class="even">
<td align="left">cex.axis</td>
<td align="left">The magnification to be used for axis annotation</td>
</tr>
<tr class="odd">
<td align="left">cex.lab</td>
<td align="left">The magnification to be used for x and y labels</td>
</tr>
<tr class="even">
<td align="left">cex.main</td>
<td align="left">The magnification to be used for plot main titles</td>
</tr>
<tr class="odd">
<td align="left">cex.sub</td>
<td align="left">The magnification to be used for plot sub-titles</td>
</tr>
</tbody>
</table>
<h3 id="plotting-characters-and-lines"><a href="#plotting-characters-and-lines"><span class="header-section-number">36.4.4</span> Plotting characters and lines</a></h3>
<table>
<thead>
<tr class="header">
<th align="left">Param</th>
<th align="left">Description [default value]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pch</td>
<td align="left">An integer or a single character to be used to plot points</td>
</tr>
<tr class="even">
<td align="left">lty</td>
<td align="left">The line type (0=blank, 1=solid, 2=dashed, etc.)</td>
</tr>
<tr class="odd">
<td align="left">lwd</td>
<td align="left">The line width, a <em>positive</em> number [1]</td>
</tr>
</tbody>
</table>
<h3 id="margins"><a href="#margins"><span class="header-section-number">36.4.5</span> Margins</a></h3>
<p>See:</p>
<pre><code>http://research.stowers-institute.org/efg/R/Graphics/Basics/mar-oma/index.htm</code></pre>
<p>for an informative discussion of margins in R plots.</p>
<table>
<thead>
<tr class="header">
<th align="left">Param</th>
<th align="left">Description [default value]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mar</td>
<td align="left">A numerical vector of the form <code>c(bottom, left, top, right)</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">which gives the number of lines of margin to be specified on</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">the four sides of the plot. [<code>c(5, 4, 4, 2) + 0.1</code>]</td>
</tr>
<tr class="even">
<td align="left">mai</td>
<td align="left">The same, but in inches, not lines</td>
</tr>
<tr class="odd">
<td align="left">oma</td>
<td align="left">A vector of the form <code>c(bottom, left, top, right)</code> giving</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">the size of the outer margins in lines of text.</td>
</tr>
</tbody>
</table>
<h3 id="layout"><a href="#layout"><span class="header-section-number">36.4.6</span> Layout</a></h3>
<table>
<thead>
<tr class="header">
<th align="left">Param</th>
<th align="left">Description [default value]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mfrow</td>
<td align="left">A vector of the form <code>c(nr, nc)</code>. The next nr*nc figures</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">will be drawn (by rows) in an <code>nr</code>-by-<code>nc</code> array.</td>
</tr>
<tr class="odd">
<td align="left">mfcol</td>
<td align="left">The same, but drawn by columns, not by rows</td>
</tr>
</tbody>
</table>
<p>We’ll see an example of the use of <code>mfrow</code> below.</p>
<h2 id="more-decorations"><a href="#more-decorations"><span class="header-section-number">36.5</span> More decorations</a></h2>
<p>In the plotting examples above, we plotted some points (<code>yVals</code> vs. <code>xVals</code>) and then “decorated” the plot with a line (and various text items). It’s also possible to do this in reverse order: plot a line and decorate with points. Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  xVals &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">1</span>, <span class="dt">to=</span><span class="dv">10</span>, <span class="dt">by=</span><span class="fl">0.1</span>)
  yVals &lt;-<span class="st"> </span>xVals^<span class="dv">2</span>
  <span class="kw">plot</span>(xVals, yVals, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)

  noise &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(xVals), <span class="dt">mean=</span><span class="dv">2</span>, <span class="dt">sd=</span><span class="dv">5</span>)
  zVals &lt;-<span class="st"> </span>yVals +<span class="st"> </span>noise
  <span class="kw">points</span>(xVals, zVals, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</code></pre>
<h2 id="multiple-plots-on-one-display"><a href="#multiple-plots-on-one-display"><span class="header-section-number">36.6</span> Multiple plots on one display</a></h2>
<p>There are several ways in traditional R graphics to put multiple plots onto a single display. The most-common way is to set the graphics parameter <code>mfrow</code> (or the essentially equivalent <code>mfcol</code>).</p>
<p>The following example uses the built-in <code>iris</code> data set to generate three different data subsets and then makes a plot of Petal Length versus Petal Width for each of the three subsets. The plots all appear in one graphics pane. You can type the command:</p>
<pre><code>
  iris
</code></pre>
<p>in the R console to see the full data set.</p>
<p>The details of splitting the <code>iris</code> data set into three data frames are not important at the moment. All that matters is that we do have a list of data frames and that we can set graphics parameters so as to plot them all in one graphics pane.</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## some R voodoo to split the iris data set
  differentSpecies &lt;-<span class="st"> </span><span class="kw">by</span>(iris, iris$Species, <span class="st">`</span><span class="dt">[</span><span class="st">`</span>)
  needRows &lt;-<span class="st"> </span><span class="kw">length</span>(differentSpecies)  ## count the number of subsets

    ## set `mfrow` so that ALL plots will appear in one pane.
    ## tweak the margins (by trial and error) to get the spacing right
  par.save &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(needRows,<span class="dv">1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">4</span>, <span class="fl">3.5</span>, <span class="dv">2</span>))

    ## iterate over the different species, generating one plot for each
  <span class="kw">lapply</span>(differentSpecies, function(nextSpecies) {

      <span class="kw">plot</span>(nextSpecies$Petal.Length, nextSpecies$Petal.Width,
           <span class="dt">xlab=</span><span class="st">&quot;Petal Length&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Petal Width&quot;</span>,
           <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>,
           <span class="dt">col.lab=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>,
           <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),
           <span class="dt">main=</span>nextSpecies$Species[<span class="dv">1</span>],
           <span class="dt">col.main=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex.main=</span><span class="fl">2.0</span>)
    }
  )

    ## restore the previous graphics parameters
  <span class="kw">par</span>(par.save)</code></pre>
<h2 id="multiple-plots-on-multiple-displays"><a href="#multiple-plots-on-multiple-displays"><span class="header-section-number">36.7</span> Multiple plots on multiple displays</a></h2>
<p>In the example above we managed to squeeze all three of our <code>iris</code> plots into one display. To make things look reasonable we had to fiddle with the margins. But suppose there were, say, ten species of iris, and that we wanted to have a look at some plots for all ten. It’s likely that no amount of fiddling with the margins, etc., would let us squeeze all ten into the same display.</p>
<p>One way around this problem is to open multiple displays. Unfortunately, the function used to open a new display depends on the system you’re using (linux, Macintosh, Windows). Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">plot</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>))  ## generate some points and plot them
  <span class="kw">X11</span>()            ## open a NEW display on linux
  <span class="kw">plot</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>)) ## plot some more points.  Should see BOTH plots now.</code></pre>
<p>Here are the commands to open a new display on various systems:</p>
<pre><code>
  X11()      ## linux
  quartz()   ## Macintosh
  windows()  ## Microsoft Windows
</code></pre>
<p>Note that if you’re using RStudio, the commands above will open a graphics display <em>outside</em> the boundaries of the RStudio window.</p>
<h2 id="saving-a-plot-to-a-file"><a href="#saving-a-plot-to-a-file"><span class="header-section-number">36.8</span> Saving a plot to a file</a></h2>
<p>If you create a plot interactively (i.e., so that it shows up in the graphics pane in RStudio) and decide you’d like to keep that plot, you have a couple of options for doing so. You can print the contents of the current graphics device to a printer or a file, using <code>dev.print()</code>. In RStudio you can go to the <code>Plots</code> tab in the pane on the lower right and select <code>Export</code> to do essentially the same thing. You would typically do this while you’re doing some exploration of some data. After you’ve done all the exploring you need to do, you can rerun your plotting code (in what you might call “production mode”) and specify in your code that you want the plot output to go to files. Here are some examples.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">plot</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="kw">rnorm</span>(<span class="dv">10</span>)) ## exploring -- generate some data and plot it
  <span class="kw">dev.print</span>(<span class="dt">device=</span>pdf, <span class="dt">file=</span><span class="st">&quot;firstPlot.pdf&quot;</span>)  ## looks good: save to file

    ## Now we know we want plots to go to files
  <span class="kw">pdf</span>(<span class="dt">file=</span><span class="st">&quot;secondPlot.pdf&quot;</span>, <span class="dt">width=</span><span class="dv">7</span>, <span class="dt">height=</span><span class="dv">6</span>) ## file name and geometry
  <span class="kw">plot</span>(<span class="dv">1</span>:<span class="dv">20</span>, <span class="kw">rnorm</span>(<span class="dv">20</span>))
  <span class="kw">dev.off</span>()  ## we won&#39;t see the file until we close the device</code></pre>
<p>There are potentially many graphics devices available, depending on your operating system and on the options used to compile R for that system. Besides PDF, PNG is commonly used these days. (Note that PDF uses so-called “vector graphics”, and PNG uses “bitmap graphics”, meaning that the parameters may be a little different for the two functions. Look for these terms on, say, Wikipedia for some background information.) Type:</p>
<pre><code>
  ?Devices
</code></pre>
<p>to see a list of the graphics devices available on your system.</p>
<h2 id="plots-for-exploratory-data-analysis"><a href="#plots-for-exploratory-data-analysis"><span class="header-section-number">36.9</span> Plots for exploratory data analysis</a></h2>
<p>There are some graphics functions in R that are commonly used to explore sets of data, including <code>histogram()</code> and <code>boxplot)</code>. Here are some details.</p>
<h3 id="histogram"><a href="#histogram"><span class="header-section-number">36.9.1</span> Histogram</a></h3>
<p>A histogram is a graphical tool that lets us examine the variability of a set of data. A very common use of histograms in an academic setting is to determine the grades of students in a class: count all the students with final scores between, say, 90 and 100 and give them a grade of <code>A</code>, then count all the students with final scores between, say, 80 and 90 and give them a grade of <code>B</code>, etc.</p>
<p>Here’s an example. The details of generating the numbers are not important. There’s more discussion below.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">set.seed</span>(<span class="dv">42</span>)  ## just to get repeatable results
  zzz &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">100</span>, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>))  ## generate some data: details don&#39;t matter
  <span class="kw">hist</span>(zzz)  ## draw a histogram of the generated data

    ## sort out the data so we can compare the numbers to the picture
  <span class="kw">sort</span>(zzz)
  rz &lt;-<span class="st"> </span><span class="kw">rle</span>(<span class="kw">sort</span>(zzz))  ## rle counts how many numbers in a row
  <span class="kw">data.frame</span>(rz$values, rz$lengths)  ## display the numbers</code></pre>
<p>You should see (from the data frame) that there are 19 (6 + 6 + 7) values less than or equal to 2. This is the height of the leftmost bar in the histogram.</p>
<p>Then there are 22 (9 + 13) values between 2 and 4. This is the height of the bar in the histogram that is second to the left.</p>
<p>Then there are 29 (15 + 14) values between 4 and 6. This is the height of the third bar in the histogram. Etc.</p>
<p>There are <em>numerous</em> options that you can supply to modify the appearance of a histogram. Type:</p>
<pre><code>
  ?hist
</code></pre>
<p>for details.</p>
<p>Here’s a more-realistic example that also uses some of the additional options. This example uses a data set that can be installed in R and that contains a ton of data about major-league baseball in the United States. (You don’t have to be a baseball fan for this. The goal is the same as above: generate some numbers and draw a picture.)</p>
<p>To follow the discussion you <em>do</em> have to install the “Lahman” package in R. Type:</p>
<pre><code>
  install.packages(&quot;Lahman&quot;)
</code></pre>
<p>in the R console (or do the equivalent thing via the <code>Packages</code> tab in RStudio).</p>
<p>You can get a sense of the what’s in the Lahman package by typing:</p>
<pre><code>
  library(help=Lahman)
</code></pre>
<p>Here’s the (somewhat lengthy) example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## Load the package with the baseball data
  <span class="kw">library</span>(Lahman)
    ## Get an overview of the &quot;batting&quot; portion
  <span class="kw">names</span>(Batting)</code></pre>
<pre><code>##  [1] &quot;playerID&quot;  &quot;yearID&quot;    &quot;stint&quot;     &quot;teamID&quot;    &quot;lgID&quot;     
##  [6] &quot;G&quot;         &quot;G_batting&quot; &quot;AB&quot;        &quot;R&quot;         &quot;H&quot;        
## [11] &quot;X2B&quot;       &quot;X3B&quot;       &quot;HR&quot;        &quot;RBI&quot;       &quot;SB&quot;       
## [16] &quot;CS&quot;        &quot;BB&quot;        &quot;SO&quot;        &quot;IBB&quot;       &quot;HBP&quot;      
## [21] &quot;SH&quot;        &quot;SF&quot;        &quot;GIDP&quot;      &quot;G_old&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  
    ## Look at data only back to 1990
  batRecentYears &lt;-<span class="st"> </span>Batting[Batting$yearID &gt;=<span class="st"> </span><span class="dv">1990</span>, ]
  <span class="kw">summary</span>(batRecentYears$yearID)  ## some useful attributes of the data</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1990    2000    2000    2000    2010    2010</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  
    ## Discard the columns that we don&#39;t need in this calculation
  batRecentYears &lt;-<span class="st"> </span>batRecentYears[ , <span class="kw">c</span>(<span class="st">&quot;G_batting&quot;</span>, <span class="st">&quot;AB&quot;</span>, <span class="st">&quot;H&quot;</span>)]
                                   
    ## remove lines with missing data (NA) and select only &quot;starters&quot;,
    ## meaning anybody that&#39;s played about half the games
  starters &lt;-<span class="st"> </span>batRecentYears[(!<span class="kw">is.na</span>(batRecentYears$G_batting)) &amp;
<span class="st">                             </span>(batRecentYears$G_batting &gt;=<span class="st"> </span><span class="dv">82</span>), ]
  <span class="kw">summary</span>(starters)</code></pre>
<pre><code>##    G_batting         AB            H      
##  Min.   : 82   Min.   :  0   Min.   :  0  
##  1st Qu.:103   1st Qu.:317   1st Qu.: 82  
##  Median :126   Median :425   Median :114  
##  Mean   :125   Mean   :418   Mean   :115  
##  3rd Qu.:146   3rd Qu.:534   3rd Qu.:148  
##  Max.   :163   Max.   :716   Max.   :262</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  
    ## require that the player have some minimum number of hits, so as to
    ## avoid skewing the data (e.g., 3 at bats, 2 hits in a single year)
  hitters &lt;-<span class="st"> </span>starters[starters$H &gt;<span class="st"> </span><span class="dv">50</span>, ]
  
    ## clean up the data a little further.  Remove entries for which
    ## the &quot;at bats&quot; or &quot;hits&quot; is missing (i.e., the value is NA).
  hitters &lt;-<span class="st"> </span>hitters[!(<span class="kw">is.na</span>(hitters$AB)), ]
  hitters &lt;-<span class="st"> </span>hitters[!(<span class="kw">is.na</span>(hitters$H)), ]
  
  <span class="kw">summary</span>(hitters)</code></pre>
<pre><code>##    G_batting         AB            H      
##  Min.   : 82   Min.   :169   Min.   : 51  
##  1st Qu.:107   1st Qu.:337   1st Qu.: 88  
##  Median :130   Median :441   Median :119  
##  Mean   :127   Mean   :437   Mean   :120  
##  3rd Qu.:148   3rd Qu.:540   3rd Qu.:151  
##  Max.   :163   Max.   :716   Max.   :262</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">head</span>(hitters)</code></pre>
<pre><code>##     G_batting  AB   H
## 97         89 244  68
## 113       101 345  86
## 114       120 420 107
## 115       109 320  81
## 116        94 252  69
## 119        96 286  78</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  
    ## compute batting average as hits/at-bats.  Force conversion from
    ## integer to double-precision (technically not necessary)
  battingAverages &lt;-<span class="st"> </span>(<span class="kw">as.numeric</span>(hitters$H) /<span class="st"> </span><span class="kw">as.numeric</span>(hitters$AB)) *<span class="st"> </span><span class="dv">1000</span>
  
  <span class="kw">head</span>(battingAverages)     ## look at the first few</code></pre>
<pre><code>## [1] 278.7 249.3 254.8 253.1 273.8 272.7</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">summary</span>(battingAverages)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     159     252     272     273     292     394</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">length</span>(battingAverages)   ## how many data points do we have?</code></pre>
<pre><code>## [1] 5997</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  
    ## calculate the mean and standard deviation of the final data
  meanBA &lt;-<span class="st"> </span><span class="kw">mean</span>(battingAverages)  ## sum them up, divide by no. of points
  meanBA</code></pre>
<pre><code>## [1] 272.6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  
  sdBA &lt;-<span class="st"> </span><span class="kw">sd</span>(battingAverages)  ## measure the spread of the data
  sdBA</code></pre>
<pre><code>## [1] 29.1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  
    ## draw a histogram of the data
    ##    prob=TRUE scales the y axis to [0, 1]
    ##    breaks tells how many bars to put in the histogram
  <span class="kw">hist</span>(battingAverages, <span class="dt">prob=</span><span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>)
  
    ## this could be a &quot;normal&quot; distribution.  Overlay the curve for
    ## the corresponding normal and check visually.  Note that by using
    ## &quot;add=TRUE&quot; we&#39;re using &quot;curve&quot; to decorate the previous plot
  <span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean=</span>meanBA, <span class="dt">sd=</span>sdBA), <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre>
<div class="figure">
<img src="figure/battingAverages.png" />
</div>
<pre class="sourceCode r"><code class="sourceCode r">  </code></pre>
<p>Our preliminary conclusion, based on our visual inspection, is that our batting averages follow a normal distribution.</p>
<p>It’s important to note that visual appearance of a histogram depends on the number of bins (breaks) used in the histogram. Here’s an example in which histograms of the same data set look different with different breaks.</p>
<pre class="sourceCode r"><code class="sourceCode r">
par.save &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))

<span class="kw">hist</span>(mtcars$hp)
<span class="kw">hist</span>(mtcars$hp, <span class="dt">breaks =</span> <span class="dv">30</span>)

<span class="kw">par</span>(par.save)</code></pre>
<p>In the second histogram of <code>mtcars$hp</code> there seem to be “holes” in the distribution, and the peak seems to be shifted to the right, all with the same underlying data.</p>
<p>Similarly, it’s often important to set the range of the axes in order to make meaningful comparisons. If you run the code in the following chunk and examine the resulting three histograms, you might erroneously conclude the the <code>virginica</code> species typically has the shortest petals, while, in fact, the opposite is true.</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## some R voodoo to split the iris data set
  differentSpecies &lt;-<span class="st"> </span><span class="kw">by</span>(iris, iris$Species, <span class="st">`</span><span class="dt">[</span><span class="st">`</span>)

    ## set `mfrow` so that ALL plots will appear in one pane.
    ## tweak the margins (by trial and error) to get the spacing right
  par.save &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">4</span>, <span class="fl">3.0</span>, <span class="dv">2</span>))

    ## iterate over the different species, generating one histogram for each
  <span class="kw">lapply</span>(differentSpecies, function(nextSpecies) {

      <span class="kw">hist</span>(nextSpecies$Petal.Length,
           <span class="dt">main=</span>nextSpecies$Species[<span class="dv">1</span>],
           <span class="dt">col.main=</span><span class="st">&quot;red&quot;</span>,
           <span class="dt">xlab=</span><span class="st">&quot;Petal Length&quot;</span>,
           <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))

    }
  )

    ## restore the previous graphics parameters
  <span class="kw">par</span>(par.save)</code></pre>
<p>In the following code chunk we generate the same three, petal-length histograms, but this time we set y axis to be a probability (thereby giving the same maximum vertical range to all three histograms), and we explicitly set the range of the x axis to be the same for all three histograms.</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## some R voodoo to split the iris data set
  differentSpecies &lt;-<span class="st"> </span><span class="kw">by</span>(iris, iris$Species, <span class="st">`</span><span class="dt">[</span><span class="st">`</span>)

    ## set `mfrow` so that ALL plots will appear in one pane.
    ## tweak the margins (by trial and error) to get the spacing right
  par.save &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">4</span>, <span class="fl">3.0</span>, <span class="dv">2</span>))

    ## compute the &quot;global&quot; minimum and maximum of the petal length for
    ## the iris data set

    lengthMin &lt;-<span class="st"> </span><span class="kw">min</span>(iris$Petal.Length)
    lengthMax &lt;-<span class="st"> </span><span class="kw">max</span>(iris$Petal.Length)

    ## iterate over the different species, generating one histogram for each
  <span class="kw">lapply</span>(differentSpecies, function(nextSpecies) {

      <span class="kw">hist</span>(nextSpecies$Petal.Length,
           <span class="dt">prob=</span><span class="ot">TRUE</span>,
           <span class="dt">xlim=</span><span class="kw">c</span>(lengthMin -<span class="st"> </span><span class="fl">0.5</span>, lengthMax +<span class="st"> </span><span class="fl">0.5</span>),
           <span class="dt">main=</span>nextSpecies$Species[<span class="dv">1</span>],
           <span class="dt">col.main=</span><span class="st">&quot;red&quot;</span>,
           <span class="dt">xlab=</span><span class="st">&quot;Petal Length&quot;</span>,
           <span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))

    }
  )

    ## restore the previous graphics parameters
  <span class="kw">par</span>(par.save)</code></pre>
<h3 id="box-plot"><a href="#box-plot"><span class="header-section-number">36.9.2</span> Box plot</a></h3>
<p>In the example above where we were “sanitizing” the baseball data, we made repeated (and otherwise unexplained) use of the <code>summary</code> function to track our progress through the data-cleanup process.</p>
<p>The <code>summary</code> function will accept an arbitrary object as its argument, but we use it primarily to give us summaries of numerical objects, and in those cases the <code>summary</code> function tells us:</p>
<ul>
<li>the minimum value of the items contained in the object</li>
<li>the 1st quartile (25% of the values are less than this)</li>
<li>the 2nd quartile, or median (50% of the values are less than this)</li>
<li>the mean, or average, value of the items contained in the object</li>
<li>the 3rd quartile (75% of the values are less than this)</li>
<li>the maximum value of the items contained in the object</li>
</ul>
<p>Here’s a very simple example that illustrates the idea:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">summary</span>(<span class="dv">1</span>:<span class="dv">200</span>)</code></pre>
<p>(Note that the mean is not always equal to the median. Send this:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">summary</span>(<span class="dv">1</span>/(<span class="dv">1</span>:<span class="dv">10</span>))</code></pre>
<p>to R to see an example of that.)</p>
<p>The <code>boxplot</code> is essentially a graphical representation of the <code>summary</code>. Here’s a simple example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">set.seed</span>(<span class="dv">42</span>)
  <span class="kw">boxplot</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">2</span>))</code></pre>
<p>The example above generates 100 values from a normal distribution and then creates a boxplot of the data. The rectangle shows where the middle 50% of the values lie. The “whiskers”, the short, horizontal lines near the top and bottom of the plot, indicate a range of values where <em>most</em> of the values lie. The circles near the bottom are “outliers”, indicating values that are far from the central value.</p>
<p>You can run the following, messy-looking code chunk to get a detailed picture of the components of a <code>boxplot</code>. The idea here is just to run the code and study the resulting picture, rather than to focus on the details of producing the picture. Note that in RStudio the picture is best viewed with a maximized graphics pane. <code>IQR</code> stands for “inter-quartile range”.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  zNum &lt;-<span class="st"> </span><span class="dv">250</span>
  zMean &lt;-<span class="st"> </span><span class="dv">10</span>
  zSD &lt;-<span class="st"> </span><span class="dv">2</span>
  <span class="kw">set.seed</span>(<span class="dv">1</span>)
  
  zzz &lt;-<span class="st"> </span><span class="kw">rnorm</span>(zNum, zMean, zSD)
  <span class="kw">boxplot</span>(zzz)
  zSumm &lt;-<span class="st"> </span><span class="kw">summary</span>(zzz)
  
  zIQR &lt;-<span class="st"> </span>zSumm[<span class="st">&quot;3rd Qu.&quot;</span>] -<span class="st"> </span>zSumm[<span class="st">&quot;1st Qu.&quot;</span>]
  zIQR
  
  zAdjUpper &lt;-<span class="st"> </span>zSumm[<span class="st">&quot;3rd Qu.&quot;</span>] +<span class="st"> </span><span class="fl">1.5</span> *<span class="st"> </span>zIQR
  zAdjUpper
  
  zAdjLower &lt;-<span class="st"> </span>zSumm[<span class="st">&quot;1st Qu.&quot;</span>] -<span class="st"> </span><span class="fl">1.5</span> *<span class="st"> </span>zIQR
  zAdjLower
  
  <span class="kw">points</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="fl">1.5</span>, <span class="dv">6</span>), <span class="dt">y=</span>zSumm, <span class="dt">col=</span><span class="st">&quot;darkorange&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">1.45</span>, <span class="dt">y=</span>zSumm[<span class="st">&quot;1st Qu.&quot;</span>],
       <span class="dt">label=</span><span class="st">&quot;Results from summary&quot;</span>,
       <span class="dt">pos=</span><span class="dv">4</span>,
       <span class="dt">col=</span><span class="st">&quot;darkorange&quot;</span>,
       <span class="dt">cex=</span><span class="fl">1.2</span>,
       <span class="dt">srt=</span><span class="dv">90</span>)
  
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">1.25</span>, <span class="dt">y=</span>zAdjLower<span class="fl">+0.20</span>,      <span class="dt">label=</span><span class="st">&quot;1st data pt above Low Adj.&quot;</span>, <span class="dt">pos=</span><span class="dv">3</span>)
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">1.25</span>, <span class="dt">y=</span>zSumm[<span class="st">&quot;1st Qu.&quot;</span>],    <span class="dt">label=</span><span class="st">&quot;1st Qu.&quot;</span>, <span class="dt">pos=</span><span class="dv">1</span>)
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">1.20</span>, <span class="dt">y=</span>zSumm[<span class="st">&quot;Median&quot;</span>]-<span class="fl">0.15</span>,<span class="dt">label=</span><span class="st">&quot;Median&quot;</span>,  <span class="dt">pos=</span><span class="dv">4</span>)
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">1.20</span>, <span class="dt">y=</span>zSumm[<span class="st">&quot;Mean&quot;</span>]+<span class="fl">0.15</span>,  <span class="dt">label=</span><span class="st">&quot;Mean&quot;</span>,    <span class="dt">pos=</span><span class="dv">4</span>)
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">1.25</span>, <span class="dt">y=</span>zSumm[<span class="st">&quot;3rd Qu.&quot;</span>],    <span class="dt">label=</span><span class="st">&quot;3rd Qu.&quot;</span>, <span class="dt">pos=</span><span class="dv">3</span>)
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">1.25</span>, <span class="dt">y=</span>zAdjUpper,           <span class="dt">label=</span><span class="st">&quot;Last data pt below Upper Adj.&quot;</span>, <span class="dt">pos=</span><span class="dv">1</span>)
  
  <span class="kw">abline</span>(<span class="dt">h=</span>zAdjUpper, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">0.5</span>, <span class="dt">y=</span>zAdjUpper<span class="fl">-0.5</span>, <span class="dt">label=</span><span class="st">&quot;Upper adjacency&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">pos=</span><span class="dv">4</span>)
  <span class="kw">abline</span>(<span class="dt">h=</span>zAdjLower, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">0.5</span>, <span class="dt">y=</span>zAdjLower<span class="fl">+0.5</span>, <span class="dt">label=</span><span class="st">&quot;Lower adjacency&quot;</span>, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pos=</span><span class="dv">4</span>)
  
  <span class="kw">arrows</span>(<span class="dt">x0=</span><span class="fl">0.75</span>, <span class="dt">y0=</span>zSumm[<span class="st">&quot;1st Qu.&quot;</span>],
         <span class="dt">x1=</span><span class="fl">0.75</span>, <span class="dt">y1=</span>zSumm[<span class="st">&quot;3rd Qu.&quot;</span>],
         <span class="dt">code=</span><span class="dv">3</span>,
         <span class="dt">col=</span><span class="st">&quot;red&quot;</span>
         )
  
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">0.70</span>, <span class="dt">y=</span>zSumm[<span class="st">&quot;Median&quot;</span>]+<span class="fl">0.1</span>, <span class="dt">label=</span><span class="st">&quot;IQR&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">srt=</span><span class="dv">90</span>)
  
  <span class="kw">arrows</span>(<span class="dt">x0=</span><span class="fl">0.85</span>, <span class="dt">y0=</span>zSumm[<span class="st">&quot;3rd Qu.&quot;</span>],
         <span class="dt">x1=</span><span class="fl">0.85</span>, <span class="dt">y1=</span>zAdjUpper,
         <span class="dt">code=</span><span class="dv">3</span>,
         <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>
         )
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">0.82</span>, <span class="dt">y=</span>zSumm[<span class="st">&quot;3rd Qu.&quot;</span>]+<span class="fl">2.0</span>, <span class="dt">label=</span><span class="st">&quot;(1.5 * IQR)&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">srt=</span><span class="dv">90</span>)
  
  <span class="kw">arrows</span>(<span class="dt">x0=</span><span class="fl">0.85</span>, <span class="dt">y0=</span>zAdjLower,
         <span class="dt">x1=</span><span class="fl">0.85</span>, zSumm[<span class="st">&quot;1st Qu.&quot;</span>],
         <span class="dt">code=</span><span class="dv">3</span>,
         <span class="dt">col=</span><span class="st">&quot;green&quot;</span>
         )
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">0.82</span>, <span class="dt">y=</span>zSumm[<span class="st">&quot;1st Qu.&quot;</span>]-<span class="fl">2.0</span>, <span class="dt">label=</span><span class="st">&quot;(1.5 * IQR)&quot;</span>, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">srt=</span><span class="dv">90</span>)
  
  <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">1.1</span>, <span class="dt">y=</span>zSumm[<span class="st">&quot;Min.&quot;</span>], <span class="dt">label=</span><span class="st">&quot;Outlier&quot;</span>, <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>, <span class="dt">cex=</span><span class="fl">1.2</span>)
  </code></pre>
<p>Note that boxplots <em>are</em> plots and can be “decorated” in all the usual ways (see the code chunk above for numerous examples of that).</p>
<p>Here’s a convenient feature of boxplots: if you boxplot a list with labels on the entries of the list, <code>boxplot</code> will use the labels as labels for the plot:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">set.seed</span>(<span class="dv">42</span>)
  <span class="kw">boxplot</span>(<span class="kw">list</span>(<span class="dt">baby=</span><span class="kw">rnorm</span>(<span class="dv">10</span>),
               <span class="dt">mama=</span><span class="kw">rnorm</span>(<span class="dv">100</span>),
               <span class="dt">papa=</span><span class="kw">rnorm</span>(<span class="dv">1000</span>)))</code></pre>
<p>And a somewhat more-realistic example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))
    ## Pick off just the petal length from the three species of iris
  stuffToPlot &lt;-<span class="st"> </span><span class="kw">lapply</span>(differentSpecies, function(nextSpecies) {
                            nextSpecies$Petal.Length
                          })
  <span class="kw">boxplot</span>(stuffToPlot)</code></pre>
<p>Even though it’s convenient to send a list to <code>boxplot</code>, it’s sometimes convenient to view multiple, individual boxplots in the same display, just as we did for histograms above. (This allows more control over the colors, spacing, etc., for instance.)</p>
<p>As with histograms, you have to have a consistent set of axes in order to compare multiple boxplots. Here’s our histogram example, modified to show boxplots:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  differentSpecies &lt;-<span class="st"> </span><span class="kw">by</span>(iris, iris$Species, <span class="st">`</span><span class="dt">[</span><span class="st">`</span>)

    ## compute the &quot;global&quot; minimum and maximum of the petal length for
    ## the iris data set
  lengthMin &lt;-<span class="st"> </span><span class="kw">min</span>(iris$Petal.Length)
  lengthMax &lt;-<span class="st"> </span><span class="kw">max</span>(iris$Petal.Length)

  par.save &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))

    ## the &quot;invisible&quot; is to suppress output from lapply
    ## we just want to see the plots, not the values returned by lapply
  <span class="kw">invisible</span>(<span class="kw">lapply</span>(differentSpecies, function(nextSpecies) {
                   <span class="kw">boxplot</span>(nextSpecies$Petal.Length,
                     <span class="dt">horizontal=</span><span class="ot">TRUE</span>,
                     <span class="dt">xlab=</span><span class="st">&quot;Petal Length&quot;</span>,
                     <span class="dt">ylim=</span><span class="kw">c</span>(lengthMin -<span class="st"> </span><span class="fl">0.5</span>, lengthMax +<span class="st"> </span><span class="fl">0.5</span>),
                     <span class="dt">boxwex=</span><span class="fl">1.5</span>,
                     <span class="dt">col.lab=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>,
                     <span class="dt">main=</span>nextSpecies$Species[<span class="dv">1</span>],
                     <span class="dt">col.main=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex.main=</span><span class="fl">2.0</span>)
    }))

  <span class="kw">par</span>(par.save)</code></pre>
<p>Some points worth mentioning about the example above:</p>
<ul>
<li>We flipped the box plots on their sides (“horizontal=TRUE”)</li>
<li>To set the scale of the rotated boxplots, we used <em>ylim</em></li>
<li>But to label the axes (“Petal Length”) we used <em>xlab</em></li>
</ul>
<h1 id="querying-r-objects"><a href="#querying-r-objects"><span class="header-section-number">37</span> Querying R objects</a></h1>
<p>Everything we use in R, including vectors, lists, and even functions, is an object. What does that mean? For our purposes we can think of an object as a thing consisting of:</p>
<ul>
<li>a location in the computer’s memory</li>
<li>a name that’s assigned to that location</li>
<li>a value that’s associated with that location</li>
<li>some attributes associated with that location</li>
</ul>
<p>It’s often useful to be able to find out information about a given object. In the simplest case, we may be debugging our own programs and have forgotten whether we made the variable (“object”) <code>zzz</code> a vector or a list.</p>
<p>Or we might write a function that will accept different kinds of objects, and we need to determine programmatically whether the thing our function just got is a matrix or a data frame and dispatch to different sections of our code, depending on the answer.</p>
<p>Here are some functions in R that will give us information about R objects:</p>
<ul>
<li><code>class</code></li>
<li><code>mode</code></li>
<li><code>storage.mode</code></li>
<li><code>typeof</code></li>
<li><code>attributes</code></li>
</ul>
<p>For <em>practical</em> purposes, the <code>str</code> function is probably all you’ll ever need to get basic information about a given object, but here are some simple examples of “introspection” in R:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">class</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>))
  <span class="kw">str</span>  (<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>))

  <span class="kw">class</span>(iris)
  <span class="kw">str</span>  (iris)

  <span class="kw">mode</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>))
  <span class="kw">str</span> (<span class="kw">rnorm</span>(<span class="dv">10</span>))

  <span class="kw">storage.mode</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>))
  <span class="kw">storage.mode</span>(<span class="dv">1</span>:<span class="dv">5</span>)  ## note: integer
  <span class="kw">storage.mode</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))  ## &quot;the same&quot; numbers, but double-precision

  zzz &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>),
                      <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>)
                     ),
                <span class="dt">nrow=</span><span class="dv">2</span>)
  <span class="kw">class</span>(zzz)
  <span class="kw">mode</span> (zzz)
  <span class="kw">typeof</span>(zzz)
  <span class="kw">str</span>  (zzz)
  <span class="kw">storage.mode</span>(zzz)
  <span class="kw">attributes</span>(zzz)  ## number of rows, columns stored as attributes
  
  <span class="kw">class</span>(letters)
  <span class="kw">mode</span> (letters)
  <span class="kw">str</span>  (letters)
  <span class="kw">typeof</span>(letters)
  <span class="kw">storage.mode</span>(letters)

  <span class="kw">class</span>(<span class="ot">TRUE</span>)
  <span class="kw">storage.mode</span>(<span class="ot">TRUE</span>)</code></pre>
<p>As you can see from the above, in most cases the <code>str</code> function gives us <em>at least</em> as much information as the other functions. (<code>str</code> doesn’t report the storage mode, but that’s seldom of concern to us.)</p>
<p>We now turn to the other scenario mentioned above, in which you need to make decisions about data types <em>in your program</em>. Basically, the technique used here is almost always to call a function with a name like:</p>
<pre><code>
  is.&lt;something-or-other&gt;()
</code></pre>
<p>of which there are <em>numerous</em> instances in R. Here are some examples of queries about the basic data types:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">is.numeric</span>(<span class="dv">1</span>:<span class="dv">10</span>)
  <span class="kw">is.numeric</span>(<span class="kw">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>))

  <span class="kw">is.character</span>(letters)
  <span class="kw">is.character</span>(<span class="fl">3.14159</span>)

  <span class="kw">is.logical</span>(<span class="ot">FALSE</span>)
  <span class="kw">is.logical</span>(<span class="dv">1</span>)

  <span class="kw">is.na</span>(<span class="ot">NA</span>)  <span class="co"># !!!!!!!!!!! use for removal of NAs:</span>
  <span class="kw">set.seed</span>(<span class="dv">42</span>)
  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)  ## generate some data
  x
  x[x &gt;<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>  ## mark the outlying values as unavailable
  x
  <span class="kw">is.na</span>(x)  ## TRUE for the ones we tossed out
  x[!<span class="kw">is.na</span>(x)]  ## look at the ones we kept

  <span class="kw">is.infinite</span>(-<span class="ot">Inf</span>)
  <span class="kw">is.infinite</span>(<span class="dv">42</span>)

  <span class="kw">is.null</span>(<span class="ot">NULL</span>)
  <span class="kw">is.null</span>(<span class="st">&quot;Mary Poppins&quot;</span>)</code></pre>
<p>It’s also possible to make queries about composite data types:</p>
<pre class="sourceCode r"><code class="sourceCode r"> 
  <span class="kw">is.vector</span>(letters[<span class="dv">1</span>:<span class="dv">3</span>])
  zzz &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>)
  <span class="kw">is.vector</span>(zzz)  ## R &quot;knows&quot; that all elements are of same type
  <span class="kw">is.list</span>(zzz)

  <span class="kw">is.array</span>(<span class="kw">array</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)))
  <span class="kw">is.matrix</span>(iris)  ## not all elements are of same type
  <span class="kw">is.data.frame</span>(iris)
  <span class="kw">is.list</span>(iris)  ## note that a data frame is a type of list
  <span class="kw">is.function</span>(mean)
  <span class="kw">is.function</span>(<span class="st">&#39;c&#39;</span>) ## distinguish between the string &#39;c&#39; and ...
  <span class="kw">is.function</span>(c)   ## ... the function of that name
  <span class="kw">is.function</span>(<span class="kw">get</span>(<span class="st">&#39;c&#39;</span>))  ## but &quot;get&quot; will map string to fn, if possible</code></pre>
<p>As mentioned above, all of the query functions start with “is”. You can use the <code>apropos</code> function with a “regular expression” to list them:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">apropos</span>(<span class="st">&quot;is&quot;</span>)  ## ack! way too much stuff
  <span class="kw">apropos</span>(<span class="st">&quot;^is&quot;</span>) ## &#39;^&#39; means STARTS WITH.  Still too much stuff
  <span class="kw">apropos</span>(<span class="st">&quot;^is.&quot;</span>) ## no change!  &#39;.&#39; means match ANY character
  <span class="kw">apropos</span>(<span class="st">&quot;^is</span><span class="ch">\\</span><span class="st">.&quot;</span>)  ## the backslashes &quot;escape&quot; the meaning of &#39;.&#39;
  <span class="kw">apropos</span>(<span class="st">&quot;^is[.]&quot;</span>)  ## the same.  both treat &#39;.&#39; as regular text</code></pre>
<p>It’s also possible to find out (and assign) the names of the components of lists and the columns of data frames (each column is in fact a list):</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">names</span>(mtcars)
  <span class="kw">colnames</span>(mtcars)
  <span class="kw">rownames</span>(mtcars)

  myList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">year=</span><span class="dv">2013</span>, <span class="dt">team=</span><span class="st">&quot;Giants&quot;</span>, <span class="dt">status=</span><span class="st">&quot;bad&quot;</span>)
  myList
  <span class="kw">names</span>(myList)

  newList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">2013</span>, <span class="st">&quot;A&#39;s&quot;</span>, <span class="st">&quot;good&quot;</span>)
  newList
  <span class="kw">names</span>(newList) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;team&quot;</span>, <span class="st">&quot;status&quot;</span>)
  newList
  <span class="kw">names</span>(newList)</code></pre>
<h1 id="the-working-directory"><a href="#the-working-directory"><span class="header-section-number">38</span> The working directory</a></h1>
<p>R has the concept of <em>working directory</em>, that is, the place in your file system where it currently looks to find files.</p>
<p>You can examine and set the current working directory (CWD) from the R console:</p>
<pre class="sourceCode r"><code class="sourceCode r">
save.wd &lt;-<span class="st"> </span><span class="kw">getwd</span>()  ## gets (and saves) the current working directory
<span class="kw">setwd</span>(<span class="st">&quot;..&quot;</span>)  ## sets the new CWD to the parent of the current CWD

<span class="kw">list.files</span>()  ## shows all files in the CWD
<span class="kw">setwd</span>(save.wd)  ## go back to the original place</code></pre>
<p>Note that R uses the “dot” notation for directory shortcuts (this is common in many operating systems and on the web):</p>
<ul>
<li>a single period, ‘.’, refers to the current directory</li>
<li>two consecutive periods, ‘..’, refers to the parent of the current directory</li>
</ul>
<p>Here’s a fairly common scenario. During a lengthy session in RStudio you load a file that contains a line similar to:</p>
<pre><code>
  zTable &lt;- read.csv(&quot;../data/foo.csv&quot;)
</code></pre>
<p>and you get a complicated error message that contains:</p>
<pre><code>
  cannot open file &#39;../data/foo.csv&#39;: No such file or directory
</code></pre>
<p>But you <em>know</em> that the file <code>foo.csv</code> <em>is</em> there, as you copied it to your computer before you started your current session. The resolution to the paradox is usually that the file <em>is</em> there, but it’s not in the specified location, <strong>relative to your current working directory</strong>.</p>
<p>The <code>read.csv()</code> above is telling R to:</p>
<ul>
<li>go to the parent directory of the current working directory</li>
<li>find a subdirectory named <code>data</code> in that parent directory</li>
<li>go down into the <code>data</code> subdirectory and read the file <code>foo.csv</code></li>
</ul>
<p>If you start out in the wrong place, you won’t find the <code>data</code> subdirectory. Just change your working directory so that the file specification is consistent and all should be well. (Note that this is a good place to use the <code>list.files()</code> command.)</p>
<p>Note that besides setting the working directory with <code>setdwd()</code> in the R console, you can also set it in a couple of different ways in RStudio:</p>
<ul>
<li>go to the <code>Session</code> menu at the top and select <code>Set Working Directory</code></li>
<li>go to the <code>Files</code> tab in the pane in the lower right of the RStudio display, then select the <code>More</code> icon, then <code>Set As Working Directory</code></li>
</ul>
<p>One advantage of using <code>setwd()</code> is that it works in <em>all</em> R environments, not just in RStudio.</p>
<h1 id="regular-expressions"><a href="#regular-expressions"><span class="header-section-number">39</span> Regular expressions</a></h1>
<h2 id="general-discussion"><a href="#general-discussion"><span class="header-section-number">39.1</span> General discussion</a></h2>
<p>A “regular expression” (or “regex” or “regexp”) is a sequence of characters used to make a pattern for search and/or replace operations on strings (at least that’s how we’ll use regular expressions).</p>
<p>If you’ve ever used the command line in Windows, Mac OS, or linux, you’ve probably used some form of regular expression. For instance:</p>
<pre><code>
  dir *.exe    ## Microsoft Windows: show names of all files ending in .exe
  ls foo*.txt  ## Mac OS or linux: all files starting w/ foo &amp; ending in .txt
</code></pre>
<p>We usually think of the <code>*</code> in the above examples as a “wildcard”, but it’s a simple form of regular expression.</p>
<p>We saw a couple of other, simple examples of regular expressions in the discussion of the <code>apropos()</code> function above:</p>
<pre><code>
  ^    ## forces that pattern to match at the beginning of a string
  $    ## forces that pattern to match at the end of a string
</code></pre>
<h2 id="some-basic-syntax"><a href="#some-basic-syntax"><span class="header-section-number">39.2</span> Some basic syntax</a></h2>
<p>While the syntax of regular expressions is simpler than that of a full-blown computer language (C++, for instance), it still takes some getting used to. Here’s a nice summary online:</p>
<pre><code>http://www.regular-expressions.info/reference.html</code></pre>
<p>There is, as usual, a lot of useful discussion in the R help pages. See, for instance:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  ?regexpr</code></pre>
<p>Generally speaking, each of the characters:</p>
<pre><code>
  [\^$.|?*+()
</code></pre>
<p>has a special meaning in regular expressions. All other characters just match themselves.</p>
<h3 id="escape-sequences"><a href="#escape-sequences"><span class="header-section-number">39.2.1</span> Escape sequences</a></h3>
<p>What happens if you <em>have</em> to search for a dollar sign or a left parenthesis, or any of the other special characters mentioned above? That is, you want to treat the special characters as ordinary characters, devoid of special significance.</p>
<p>You <em>can</em> do that, of course, and the way you do it is to put a backslash in front of the special character, as, for example:</p>
<pre><code>
  \$  ## a plain, old dollar sign, not the end of the string
</code></pre>
<p>We’ll see an example of this below, after we discuss some of the functions in R that <em>use</em> regular expressions.</p>
<p>There are also situations in which the backslash does more or less the reverse: it can turn a plain, old character into something different. For instance:</p>
<pre><code>
  \t  ## means to look for a tab character (ASCII 0x09)
  \n  ## means to look for a newline character (ASCII 0x0A)
  \r  ## means to look for a carriage return (ASCII 0x0D)
</code></pre>
<p>(“ASCII” refers to a set of numerical values that are used to represent characters in a computer. See, for instance:</p>
<pre><code> http://en.wikipedia.org/wiki/ASCII</code></pre>
<p>for some discussion.)</p>
<h2 id="commonly-used-pattern-matching-functions"><a href="#commonly-used-pattern-matching-functions"><span class="header-section-number">39.3</span> Commonly-used pattern-matching functions</a></h2>
<h3 id="grep"><a href="#grep"><span class="header-section-number">39.3.1</span> grep</a></h3>
<p>The <code>grep()</code> function is the workhorse tool for regular expressions. Have a look at:</p>
<pre><code>http://en.wikipedia.org/wiki/Grep</code></pre>
<p>for some background and details.</p>
<p>Here’s the template for <code>grep</code>:</p>
<pre><code>
  grep(pattern, x, ignore.case = FALSE, perl = FALSE, value = FALSE,
       fixed = FALSE, useBytes = FALSE, invert = FALSE)
</code></pre>
<p>And here’s a simple example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">grep</span>(<span class="st">&quot;end&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;blend&quot;</span>, <span class="st">&quot;nunca&quot;</span>, <span class="st">&quot;splendor&quot;</span>, <span class="st">&quot;jamas&quot;</span>, <span class="st">&quot;Endothermic&quot;</span>))
  <span class="kw">grep</span>(<span class="st">&quot;end&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;blend&quot;</span>, <span class="st">&quot;nunca&quot;</span>, <span class="st">&quot;splendor&quot;</span>, <span class="st">&quot;jamas&quot;</span>, <span class="st">&quot;Endothermic&quot;</span>),
        <span class="dt">value=</span><span class="ot">TRUE</span>)
  <span class="kw">grep</span>(<span class="st">&quot;end&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;blend&quot;</span>, <span class="st">&quot;nunca&quot;</span>, <span class="st">&quot;splendor&quot;</span>, <span class="st">&quot;jamas&quot;</span>, <span class="st">&quot;Endothermic&quot;</span>),
        <span class="dt">value=</span><span class="ot">TRUE</span>, <span class="dt">ignore.case=</span><span class="ot">TRUE</span>)</code></pre>
<p>The <code>perl</code> option enables/disables the use of Perl-compatible regular expressions. See:</p>
<pre><code>http://www.perl.org/</code></pre>
<p>The Perl-compatible, regular-expression “engine” is more flexible than the standard one in R, and many people prefer to use it by default.</p>
<h3 id="regexpr-and-gregexpr"><a href="#regexpr-and-gregexpr"><span class="header-section-number">39.3.2</span> regexpr and gregexpr</a></h3>
<p>The functions <code>regexpr()</code> and <code>gregexpr()</code> are also used to find patterns in strings, but they report the results in a different way, compared to <code>grep</code>.</p>
<p>Here are the templates for <code>regexpr</code> and <code>gregexpr</code>:</p>
<pre><code>
  regexpr(pattern, text, ignore.case = FALSE, perl = FALSE,
          fixed = FALSE, useBytes = FALSE)

  gregexpr(pattern, text, ignore.case = FALSE, perl = FALSE,
           fixed = FALSE, useBytes = FALSE)</code></pre>
<p>And here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  textToSearch &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;blend&quot;</span>, <span class="st">&quot;nunca&quot;</span>, <span class="st">&quot;splendor&quot;</span>, <span class="st">&quot;jamas&quot;</span>, <span class="st">&quot;Endothermic&quot;</span>)
  <span class="kw">regexpr</span>(<span class="st">&quot;end&quot;</span>, textToSearch)</code></pre>
<p>And here’s an example that illustrates the difference between the two:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## finds match at posn. 2, length 3
  <span class="kw">regexpr</span> (<span class="st">&quot;iss&quot;</span>, <span class="st">&quot;Mississippi&quot;</span>)
    ## finds match at posns. 2, 5, both of length 3
  <span class="kw">gregexpr</span>(<span class="st">&quot;iss&quot;</span>, <span class="st">&quot;Mississippi&quot;</span>)</code></pre>
<h3 id="sub-and-gsub"><a href="#sub-and-gsub"><span class="header-section-number">39.3.3</span> sub and gsub</a></h3>
<p>You might think of <code>sub()</code> and <code>gsub()</code> as “find-and-replace” functions.</p>
<p>Here are the templates for <code>sub</code> and <code>gsub</code>:</p>
<pre><code>
  sub(pattern, replacement, x, ignore.case = FALSE, perl = FALSE,
      fixed = FALSE, useBytes = FALSE)
  
  gsub(pattern, replacement, x, ignore.case = FALSE, perl = FALSE,
       fixed = FALSE, useBytes = FALSE)
</code></pre>
<p>Here are some simple examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## replace the first occurrence of iss with -Ole_Miss-
  <span class="kw">sub</span> (<span class="st">&quot;iss&quot;</span>, <span class="st">&quot;-Ole_Miss-&quot;</span>, <span class="st">&quot;Mississippi&quot;</span>)
    ## replace all occurrences of iss...
  <span class="kw">gsub</span>(<span class="st">&quot;iss&quot;</span>, <span class="st">&quot;-Ole_Miss-&quot;</span>, <span class="st">&quot;Mississippi&quot;</span>)</code></pre>
<h3 id="strsplit"><a href="#strsplit"><span class="header-section-number">39.3.4</span> strsplit</a></h3>
<p>We’ve seen examples of the use of <code>strsplit()</code> above. It’s used, as the name implies, to split strings into pieces, chopping the string at the places specified by the <code>split</code> argument. Here’s the template:</p>
<pre><code>
  strsplit(x, split, fixed = FALSE, perl = FALSE, useBytes = FALSE)
</code></pre>
<p>Here are some typical examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## pick off each word; separator is a blank
  <span class="kw">strsplit</span>(<span class="st">&quot;These are some words in a sentence.&quot;</span>, <span class="st">&quot; &quot;</span>)
    ## pick off each character; separator is empty string
  <span class="kw">strsplit</span>(<span class="st">&quot;These are some words in a sentence.&quot;</span>, <span class="st">&quot;&quot;</span>)</code></pre>
<h2 id="more-complicated-examples"><a href="#more-complicated-examples"><span class="header-section-number">39.4</span> More-complicated examples</a></h2>
<p>What was it that was so “simple” about the examples above? Answer: in every case, the pattern was a “literal”, a bunch of characters for which we were seeking an exact match (“iss” matched “iss”, for instance). We didn’t use any “wildcards”, i.e., any of the special characters mentioned above, and we didn’t really demonstrate the power of regular expressions. The point was just to get familiar with some commonly-used functions.</p>
<p>Now we can proceed to <em>use</em> those functions to exhibit some of the more-interesting properties of regular expressions. Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## the &quot;.&quot; matches *any* character, so we get back the whole string
    ## note the &quot;greedy&quot; nature of this: one char would do for a match,
    ## but we get ALL of them!
  <span class="kw">grep</span>(<span class="st">&quot;.&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;This is a string&quot;</span>, <span class="st">&quot;and another&quot;</span>), <span class="dt">value=</span><span class="ot">TRUE</span>)

    ## the &quot;*&quot; matches the preceding character zero or more times
  <span class="kw">grep</span>(<span class="st">&quot;colou*r&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;color&quot;</span>, <span class="st">&quot;colour&quot;</span>, <span class="st">&quot;kolor&quot;</span>))

    ## combine the previous two: match zero or more of *any* character
  stringToMatch &lt;-<span class="st"> &quot;This is another string&quot;</span>
  <span class="kw">nchar</span>(stringToMatch)
    ## match starts at posn 1, carries on to length of string
  <span class="kw">regexpr</span>(<span class="st">&quot;.*&quot;</span>, stringToMatch)

    ## the &quot;+&quot; matches the preceding character *one* or more times
  <span class="kw">grep</span>(<span class="st">&quot;colou+r&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;color&quot;</span>, <span class="st">&quot;colour&quot;</span>, <span class="st">&quot;kolor&quot;</span>))

    ## beware of greedy matching: we want to replace &lt;P&gt;, but...
  <span class="kw">gsub</span>(<span class="st">&quot;&lt;.*&gt;&quot;</span>, <span class="st">&quot;the paragraph token&quot;</span>,
       <span class="st">&quot;In HTML both &lt;P&gt; and &lt;BR&gt; generate new lines&quot;</span>)

    ## the &#39;^&#39; anchors the match to the beginning of the string
  <span class="kw">grep</span>(<span class="st">&quot;^ear&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;I&quot;</span>, <span class="st">&quot;woke&quot;</span>, <span class="st">&quot;up&quot;</span>, <span class="st">&quot;early&quot;</span>, <span class="st">&quot;and&quot;</span>, <span class="st">&quot;what&quot;</span>, <span class="st">&quot;did&quot;</span>, <span class="st">&quot;I&quot;</span>,
                 <span class="st">&quot;hear&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;BEAR&quot;</span>, <span class="st">&quot;!&quot;</span>),
       <span class="dt">value=</span><span class="ot">TRUE</span>, <span class="dt">ignore.case=</span><span class="ot">TRUE</span>)

    ## and &#39;$&#39; anchors to the end of the string
  <span class="kw">grep</span>(<span class="st">&quot;ear$&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;I&quot;</span>, <span class="st">&quot;woke&quot;</span>, <span class="st">&quot;up&quot;</span>, <span class="st">&quot;early&quot;</span>, <span class="st">&quot;and&quot;</span>, <span class="st">&quot;what&quot;</span>, <span class="st">&quot;did&quot;</span>, <span class="st">&quot;I&quot;</span>,
                 <span class="st">&quot;hear&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;BEAR&quot;</span>, <span class="st">&quot;!&quot;</span>),
       <span class="dt">value=</span><span class="ot">TRUE</span>, <span class="dt">ignore.case=</span><span class="ot">TRUE</span>)

    ## what if we need to look for the literal version of a special
    ## character?  Here we look for a &#39;?&#39;
  <span class="kw">grep</span>(<span class="st">&quot;?&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;I&quot;</span>, <span class="st">&quot;woke&quot;</span>, <span class="st">&quot;up&quot;</span>, <span class="st">&quot;early&quot;</span>, <span class="st">&quot;and&quot;</span>, <span class="st">&quot;what&quot;</span>, <span class="st">&quot;did&quot;</span>, <span class="st">&quot;I&quot;</span>,
                 <span class="st">&quot;hear&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;BEAR&quot;</span>, <span class="st">&quot;!&quot;</span>),
       <span class="dt">value=</span><span class="ot">TRUE</span>, <span class="dt">ignore.case=</span><span class="ot">TRUE</span>)

    ## that wasn&#39;t what we wanted!  Need to &quot;escape&quot; the special character &#39;?&#39;
  <span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">?&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;I&quot;</span>, <span class="st">&quot;woke&quot;</span>, <span class="st">&quot;up&quot;</span>, <span class="st">&quot;early&quot;</span>, <span class="st">&quot;and&quot;</span>, <span class="st">&quot;what&quot;</span>, <span class="st">&quot;did&quot;</span>, <span class="st">&quot;I&quot;</span>,
                <span class="st">&quot;hear&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;BEAR&quot;</span>, <span class="st">&quot;!&quot;</span>),
       <span class="dt">value=</span><span class="ot">TRUE</span>)</code></pre>
<p>Note that in the last example we had to “escape” the special character <code>?</code> so that <code>grep</code> would interpret it as a plain, old question-mark character, and <em>not</em> as one of the special characters used in regular expressions. And we had to use <em>two</em> backslashes to do that, because the R interpreter will read and “consume” one of them prior to passing the pattern to the <code>grep</code> function.</p>
<h2 id="regular-expressions-with-character-classes"><a href="#regular-expressions-with-character-classes"><span class="header-section-number">39.5</span> Regular expressions with character classes</a></h2>
<p>Up to this point we’ve been concerned with:</p>
<pre><code>
  - matching literal strings (&quot;xyz&quot;, &quot;1and2&quot;)
  - matching bunches of otherwise undefined characters (&quot;*&quot;, &quot;+&quot;)
  - matching either of the above at the beginning or end of a string (&quot;^&quot;,
    &quot;$&quot;)
</code></pre>
<p>We now want to sharpen our focus and look for bunches of specific characters or classes of characters. You can find a lot of discussion of this on the help page for <code>regexp</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  ?regexp</code></pre>
<p>We’ll look at some examples of character classes. Quoting from the <code>regexp</code> help page:</p>
<pre><code>A character class is a list of characters enclosed between [ and ]
which matches any single character in that list; unless the first
character of the list is the caret ^, when it matches any character
not in the list.</code></pre>
<p>Here are some examples:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## look for either &#39;b&#39; or &#39;r&#39; at the start of a string
  <span class="kw">grep</span>(<span class="st">&quot;^[br]at&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;bat&quot;</span>, <span class="st">&quot;cat&quot;</span>, <span class="st">&quot;rat&quot;</span>), <span class="dt">value=</span><span class="ot">TRUE</span>)

    ## look for things *not* starting with &#39;b&#39; or &#39;r&#39;
    ## note that &#39;^&#39; has two different meanings here!
  <span class="kw">grep</span>(<span class="st">&quot;^[^br]at&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;bat&quot;</span>, <span class="st">&quot;cat&quot;</span>, <span class="st">&quot;rat&quot;</span>), <span class="dt">value=</span><span class="ot">TRUE</span>)

    ## a hyphen indicates a range of characters. here, anything
    ## from &#39;m&#39; to &#39;t&#39;, inclusive
  <span class="kw">grep</span>(<span class="st">&quot;[m-t]ap&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;capitulate&quot;</span>, <span class="st">&quot;mapper&quot;</span>, <span class="st">&quot;nap&quot;</span>, <span class="st">&quot;tapdance&quot;</span>, <span class="st">&quot;zap&quot;</span>),
       <span class="dt">value=</span><span class="ot">TRUE</span>)

    ## can combine ranges.  Look for hexadecimal numbers, only 0-9,
    ## a-f, or A-F, from start (^) to finish ($).  Note that &quot;turkey&quot;
    ## has an &#39;e&#39;, but it has non-hex characters as well
  <span class="kw">grep</span>(<span class="st">&quot;^[0-9a-fA-F]+$&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;123&quot;</span>, <span class="st">&quot;FF&quot;</span>, <span class="st">&quot;ab&quot;</span>, <span class="st">&quot;turkey&quot;</span>, <span class="st">&quot;trot&quot;</span>),
       <span class="dt">value=</span><span class="ot">TRUE</span>)</code></pre>
<h3 id="predefined-character-classes"><a href="#predefined-character-classes"><span class="header-section-number">39.5.1</span> Predefined character classes</a></h3>
<p>There are some classes of characters that are used so frequently in dealing with regular expressions that the classes have been “built in” to some versions of the regular-expression language. Here are a few of them:</p>
<pre><code>
  [:alnum:]
  Alphanumeric characters: [:alpha:] and [:digit:].
  
  [:alpha:]
  Alphabetic characters: [:lower:] and [:upper:].
  
  [:digit:]    (aka \d and \D is a non-digit)
  Digits: 0 1 2 3 4 5 6 7 8 9.
  
  [:space:]    (aka \s and \S is a non-space)
  Space characters: tab, newline, vertical tab, form feed, carriage return,
  space and possibly other locale-dependent characters.

</code></pre>
<p>See the help page for <code>regexp</code> for a full discussion. Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## look for at least one [0-9], zero or more space, at least one letter
  <span class="kw">grep</span>(<span class="st">&quot;[[:digit:]]+[[:space:]]*[[:alpha:]]+&quot;</span>,
       <span class="kw">c</span>(<span class="st">&quot;42 alpha&quot;</span>, <span class="st">&quot;314x beta&quot;</span>, <span class="st">&quot;gamma 137&quot;</span>),
       <span class="dt">value=</span><span class="ot">TRUE</span>)</code></pre>
<h3 id="repetition-quantifiers"><a href="#repetition-quantifiers"><span class="header-section-number">39.5.2</span> Repetition quantifiers</a></h3>
<p>We can get even more specific about the match by requiring a character, or character class, to be repeated a given number of times, or a given range of times:</p>
<pre><code>
  {n}    ## preceding object must be repeated n times
  {n, m} ## repeated at least n times but not more than m times
  {n, }  ## repeated n or more times
</code></pre>
<p>Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
    ## is your SSN on this list?  (Actual rules for SSN are complicated!)
  <span class="kw">grep</span>(<span class="st">&quot;^</span><span class="ch">\\</span><span class="st">d{3}-</span><span class="ch">\\</span><span class="st">d{2}-</span><span class="ch">\\</span><span class="st">d{4}$&quot;</span>,
       <span class="kw">c</span>(<span class="st">&quot;512-44-6251&quot;</span>,
         <span class="st">&quot;978,53,7567&quot;</span>,
         <span class="st">&quot;123-45-67898&quot;</span>,
         <span class="st">&quot;314-15-9265pi&quot;</span>),
       <span class="dt">value=</span><span class="ot">TRUE</span>
      )</code></pre>
<h3 id="reusing-the-matched-text"><a href="#reusing-the-matched-text"><span class="header-section-number">39.5.3</span> Reusing the matched text</a></h3>
<p>You can tell R to “remember” portions of a matched string and reuse those matched portions. To do this you put parentheses “(…)” in the pattern surrounding the things you want to remember. Here’s an example that came originally from research done by a graduate student at UCD. The task was to extract numerical information from a URL (a “web address”).</p>
<pre class="sourceCode r"><code class="sourceCode r">
  nextURL &lt;-<span class="st"> &quot;http://purl.org/phylo/treebase/tree/Tr3212&quot;</span>
  nextNum &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">gsub</span>(<span class="st">&quot;^.*/Tr(</span><span class="ch">\\</span><span class="st">d+)$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>, nextURL))
  nextNum</code></pre>
<p>Here’s a narrative description of the matching process above:</p>
<pre><code>
  - start at the beginning of the string (^)
  - match any number of characters (.*) until you get to...
  - the literal string &quot;/Tr&quot;, followed by...
  - at least one decimal digit (\\d+), which we&#39;re going to remember
    (signaled by the parentheses), followed by ...
  - the end of the string ($) (R will return the unmatched portion
    of the string, so here you want to get EVERYTHING out of the way,
    except the piece you&#39;re looking for.)
</code></pre>
<p>The return value from gsub is:</p>
<pre><code>
  \\1  the first (and, in this case, only) thing you remembered
         from the pattern
</code></pre>
<p>We convert the return value from gsub (“3212”) into a numeric object for use in later calculations.</p>
<h3 id="logical-or"><a href="#logical-or"><span class="header-section-number">39.5.4</span> Logical OR</a></h3>
<p>You can search for any of several alternatives by separating the alternatives by a vertical bar, “|”, in the pattern. Here’s an example:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  lookStooge &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;[Ll]arry|[Mm]oe|[Cc]urly&quot;</span>,
                     <span class="kw">c</span>(<span class="st">&quot;Fred&quot;</span>, <span class="st">&quot;Ethel&quot;</span>, <span class="st">&quot;Curly&quot;</span>, <span class="st">&quot;Rainman&quot;</span>, <span class="st">&quot;moe&quot;</span>),
                     <span class="dt">value=</span><span class="ot">TRUE</span>)
  lookStooge</code></pre>
<h1 id="a-quick-review-control-panels-for-r"><a href="#a-quick-review-control-panels-for-r"><span class="header-section-number">40</span> A quick review: “control panels” for R</a></h1>
<p>You can think of R as a sort of machine with a number of “control panels”.</p>
<h2 id="the-interpreter-the-main-control-panel"><a href="#the-interpreter-the-main-control-panel"><span class="header-section-number">40.1</span> The interpreter: the main control panel</a></h2>
<p>The part of R that reads commands and executes the corresponding functions is the <em>interpreter</em>.</p>
<h3 id="the-settings-on-the-interpreter-control-panel"><a href="#the-settings-on-the-interpreter-control-panel"><span class="header-section-number">40.1.1</span> The settings on the interpreter control panel</a></h3>
<p>The settings for this control panel are:</p>
<ul>
<li>the variables that are defined at any one moment</li>
<li>the values of those variables</li>
</ul>
<h3 id="reading-out-the-settings-on-the-interpreter-control-panel"><a href="#reading-out-the-settings-on-the-interpreter-control-panel"><span class="header-section-number">40.1.2</span> Reading out the settings on the interpreter control panel</a></h3>
<p>You can examine the state of the interpreter in various ways:</p>
<ul>
<li>ls()</li>
<li>print()</li>
</ul>
<h3 id="changing-the-settings-on-the-interpreter-control-panel"><a href="#changing-the-settings-on-the-interpreter-control-panel"><span class="header-section-number">40.1.3</span> Changing the settings on the interpreter control panel</a></h3>
<p>You change the settings of the interpreter by using an assignment statement:</p>
<ul>
<li><code>zzz &lt;- 42</code></li>
</ul>
<h2 id="the-options-control-panel"><a href="#the-options-control-panel"><span class="header-section-number">40.2</span> The <code>options</code> control panel</a></h2>
<p>The <code>options()</code> function controls what you might call R’s general settings. You can type:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">options</span>()  ## to see the values of all options currently set
  ?options   ## to see a discussion of the many options
  <span class="kw">options</span>(<span class="dt">digits=</span><span class="dv">18</span>)  ## to set to 18 the number of digits displayed in output
  <span class="kw">options</span>(<span class="dt">width=</span><span class="dv">120</span>)  ## to make R use more of your screen real estate</code></pre>
<h2 id="the-par-control-panel"><a href="#the-par-control-panel"><span class="header-section-number">40.3</span> The <code>par</code> control panel</a></h2>
<p>The <code>par()</code> function can be used to set or query <em>graphical</em> parameters.</p>
<p>You can type:</p>
<pre class="sourceCode r"><code class="sourceCode r">
  <span class="kw">par</span>() ## to see the current values of graphical parameters
  ?par  ## to see a discussion a discussion of the graphics parameters
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)) ## to put the next six plots into a 3-row, 2-col array</code></pre>
<p>There are many examples above of other uses of <code>par</code>.</p>
<h2 id="the-random-number-control-panel"><a href="#the-random-number-control-panel"><span class="header-section-number">40.4</span> The random-number control panel</a></h2>
<p>The random-number “machinery” in R is activated by the <code>set.seed()</code> function or by the use of any function in R that relates to random numbers (<code>rnorm</code>, <code>dnorm</code>, <code>sample</code>, etc.), and it is <em>changed</em> by <strong>any</strong> subsequent use of those functions.</p>
<pre class="sourceCode r"><code class="sourceCode r">
  .Random.seed  ## produces an error if no previous use of random numbers
  <span class="kw">set.seed</span>(<span class="dv">42</span>)  ## pick a starting point in the list of random numbers
  .Random.seed  ## LONG list of numbers used by R to keep track
  saved.seed &lt;-<span class="st"> </span>.Random.seed  ## remember the current values
  zzz &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)  ## make one use of the random-number generator
  <span class="kw">all.equal</span>(saved.seed, .Random.seed)  ## will show we now have a new seed</code></pre>
</body>
</html>
